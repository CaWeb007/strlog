function setCookie(e,t,o){var i=(o=o||{}).expires;if("number"==typeof i&&i){var n=new Date;n.setTime(n.getTime()+1e3*i),i=o.expires=n}i&&i.toUTCString&&(o.expires=i.toUTCString());var r=e+"="+(t=encodeURIComponent(t));for(var s in o){r+="; "+s;var a=o[s];!0!==a&&(r+="="+a)}document.cookie=r}function deleteCookie(e){setCookie(e,"",{expires:-1})}function getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}BX.saleOrderAjax={BXCallAllowed:!1,options:{},indexCache:{},controls:{},modes:{},properties:{},init:function(e){var t=this;this.options=e,window.submitFormProxy=BX.proxy(function(){t.submitFormProxy.apply(t,arguments)},this),BX(function(){t.initDeferredControl()}),BX(function(){t.BXCallAllowed=!0}),this.controls.scope=BX("order_form_div"),BX.bindDelegate(this.controls.scope,"click",{className:"-bx-popup-set-mode-add-loc"},function(){var e=BX.create("input",{attrs:{type:"hidden",name:"PERMANENT_MODE_STEPS",value:"1"}});BX.prepend(e,BX("ORDER_FORM")),t.BXCallAllowed=!1,submitForm()})},cleanUp:function(){for(var e in this.properties)this.properties.hasOwnProperty(e)&&(void 0!==this.properties[e].input&&(BX.unbindAll(this.properties[e].input),this.properties[e].input=null),void 0!==this.properties[e].control&&BX.unbindAll(this.properties[e].control));this.properties={}},addPropertyDesc:function(e){this.properties[e.id]=e.attributes,this.properties[e.id].id=e.id},initDeferredControl:function(){var e,t,o,i,n,r,s,a,p,l=this;if(void 0!==window.BX.locationsDeferred)for(e in this.BXCallAllowed=!1,window.BX.locationsDeferred)window.BX.locationsDeferred[e].call(this),window.BX.locationsDeferred[e]=null,delete window.BX.locationsDeferred[e],this.properties[e].control=window.BX.locationSelectors[e],delete window.BX.locationSelectors[e];for(e in this.properties){if(this.properties[e].isZip&&(t=this.controls.scope.querySelector('[data-property-id-row="'+e+'"]'),BX.type.isElementNode(t)&&(o=t.querySelector('input[type="text"]'),BX.type.isElementNode(o)))){for(n in this.properties[e].input=o,i=!1,this.properties)if("LOCATION"==this.properties[n].type){i=n;break}!1!==i&&BX.bindDebouncedChange(o,function(e){t=o=null,BX.type.isNotEmptyString(e)&&/^\s*\d+\s*$/.test(e)&&3<e.length&&l.getLocationByZip(e,function(e){l.properties[i].control.setValueByLocationId(e)},function(){try{l.properties[i].control.clearSelected(locationId)}catch(e){}})})}"LOCATION"==this.properties[e].type&&void 0!==this.properties[e].control&&(s=(r=this.properties[e].control).getSysCode(),void 0!==this.properties[e].altLocationPropId&&("sls"==s&&r.replaceTemplate("nothing-found",this.options.messages.notFoundPrompt),"slst"==s&&function(e,i){i.setOption("pseudoValues",["other"]),i.bindEvent("control-before-display-page",function(e){i=null;var t=e.getParentValue();if(t!=this.getOption("rootNodeValue")&&this.checkCanSelectItem(t)){var o=e.getControl();void 0===o.vars.cache.nodes.other&&o.fillCache([{CODE:"other",DISPLAY:l.options.messages.otherLocation,IS_PARENT:!1,VALUE:"other"}],{modifyOrigin:!0,modifyOriginPosition:"prepend"})}}),a=BX("LOCATION_ALT_PROP_DISPLAY_MANUAL["+parseInt(e)+"]"),i.bindEvent("after-select-real-value",function(){BX.type.isDomNode(a)&&(a.value="0")}),i.bindEvent("after-select-pseudo-value",function(){BX.type.isDomNode(a)&&(a.value="1")}),i.bindEvent("before-set-value",function(){BX.type.isDomNode(a)&&(a.value="0")}),BX.type.isDomNode(a)&&"1"==a.value&&null!=(p=i.getAdapterAtPosition(i.getStackSize()-1))&&p.setValuePair("other",l.options.messages.otherLocation)}(e,r)))}this.BXCallAllowed=!0},checkMode:function(e,t){if("altLocationChoosen"==t&&this.checkAbility(e,"canHaveAltLocation")){var o=this.getInputByPropId(this.properties[e].altLocationPropId),i=this.properties[e].altLocationPropId;if(!1!==o&&0<o.value.length&&!o.disabled&&"default"!=this.properties[i].valueSource)return!0}return!1},checkAbility:function(e,t){if(void 0===this.properties[e]&&(this.properties[e]={}),void 0===this.properties[e].abilities&&(this.properties[e].abilities={}),void 0!==this.properties[e].abilities&&this.properties[e].abilities[t])return!0;if("canHaveAltLocation"==t&&"LOCATION"==this.properties[e].type&&void 0!==this.properties[e].altLocationPropId&&(this.properties[this.properties[e].altLocationPropId],1)){var o=this.properties[e].altLocationPropId;if(void 0!==this.properties[e].control&&"slst"==this.properties[e].control.getSysCode()&&!1!==this.getInputByPropId(o))return this.properties[e].abilities[t]=!0}return!1},getInputByPropId:function(e){if(void 0!==this.properties[e].input)return this.properties[e].input;var t=this.getRowByPropId(e);if(BX.type.isElementNode(t)){var o=t.querySelector('input[type="text"]');if(BX.type.isElementNode(o))return this.properties[e].input=o}return!1},getRowByPropId:function(e){if(void 0!==this.properties[e].row)return this.properties[e].row;var t=this.controls.scope.querySelector('[data-property-id-row="'+e+'"]');return!!BX.type.isElementNode(t)&&(this.properties[e].row=t)},getAltLocPropByRealLocProp:function(e){return void 0!==this.properties[e].altLocationPropId&&this.properties[this.properties[e].altLocationPropId]},toggleProperty:function(e,t,o){var i=this.properties[e];void 0===i.row&&(i.row=this.getRowByPropId(e)),void 0===i.input&&(i.input=this.getInputByPropId(e)),t?(o||BX.show(i.row),i.input.disabled=!1):(o||BX.hide(i.row),i.input.disabled=!0)},submitFormProxy:function(e,t){for(var o in this.properties)if(void 0!==this.properties[o].control&&this.properties[o].control==t){o;break}"other"!=e&&this.BXCallAllowed&&(this.BXCallAllowed=!1,submitForm())},getPreviousAdapterSelectedNode:function(e,t){var o=t.getIndex(),i=e.getAdapterAtPosition(o-1);if(void 0!==i&&null!=i){var n=i.getControl().getValue();if(void 0!==n){var r=e.getNodeByValue(n);return void 0!==r&&r}}return!1},getLocationByZip:function(t,o,i){if(void 0===this.indexCache[t]){ShowWaitWindow();var n=this;BX.ajax({url:this.options.source,method:"post",dataType:"json",async:!0,processData:!0,emulateOnload:!0,start:!0,data:{ACT:"GET_LOC_BY_ZIP",ZIP:t},onsuccess:function(e){CloseWaitWindow(),e.result?(n.indexCache[t]=e.data.ID,o.apply(n,[e.data.ID])):i.call(n)},onfailure:function(e,t){CloseWaitWindow()}})}else o.apply(this,[this.indexCache[t]])}},$(document).ready(function(){"Y"==getCookie("CONFIRM_PHONE")&&deleteCookie("CONFIRM_PHONE"),$('form[name="ORDER_FORM"] input[name="ORDER_PROP_3"]').on("keyup",function(e){if(""!=$(this).data("tel")){var t=$(this).val();$(this).data("tel");t!=t?($('form[name="ORDER_FORM"] .btn-confirm').removeClass("inactive"),$('form[name="ORDER_FORM"] .confirm-tel').addClass("inactive"),$('form[name="ORDER_FORM"] #CONFIRM_PHONE_SUCCESS').val("N"),$('form[name="ORDER_FORM"] #ORDER_PROP_9').prop("checked",!1)):($('form[name="ORDER_FORM"] .btn-confirm').addClass("inactive"),$('form[name="ORDER_FORM"] .confirm-tel').removeClass("inactive"),$('form[name="ORDER_FORM"] #CONFIRM_PHONE_SUCCESS').val("Y"),$('form[name="ORDER_FORM"] #ORDER_PROP_9').prop("checked",!0))}}),function(){for(var e=new Date,r=["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],s={0:{name:"Январь",number:"01",countday:31,id:1},1:{name:"Февраль",number:"02",countday:28,id:2},2:{name:"Март",number:"03",countday:31,id:3},3:{name:"Апрель",number:"04",countday:30,id:4},4:{name:"Май",number:"05",countday:31,id:5},5:{name:"Июнь",number:"06",countday:30,id:6},6:{name:"Июль",number:"07",countday:31,id:7},7:{name:"Август",number:"08",countday:31,id:8},8:{name:"Сентябрь",number:"09",countday:30,id:9},9:{name:"Октябрь",number:"10",countday:31,id:10},10:{name:"Ноябрь",number:"11",countday:30,id:11},11:{name:"Декабрь",number:"12",countday:31,id:12}},t={min_year:1930,max_year:e.getFullYear()},o='<option value="no" selected="selected">-</option>',i=0;i<31;i++)o+='<option value="'+r[i]+'">'+r[i]+"</option>";var n='<option value="no" selected="selected">-</option>';for(var a in s)n+='<option value="'+s[a].number+'" data-monthid="'+s[a].id+'">'+s[a].name+"</option>";for(var p='<option value="no" selected="selected">-</option>',i=t.max_year;1930<=i;i--)p+='<option value="'+i+'">'+i+"</option>";$('#ORDER_FORM select[name="REGISTER[PERSONAL_DAY]"]').append(o),$('#ORDER_FORM select[name="REGISTER[PERSONAL_MONTH]"]').append(n),$('#ORDER_FORM select[name="REGISTER[PERSONAL_YEAR]"]').append(p),$('#ORDER_FORM select[name="REGISTER[PERSONAL_MONTH]"]').on("change",{month:s,days:r},function(e){if("no"==$(this).val())return!1;var t=$(this).children("option:selected").data("monthid");if(console.log(s[t-1].countday),"no"!=$(this).siblings('#ORDER_FORM select[name="REGISTER[PERSONAL_DAY]"]').val())var o=$(this).siblings('#ORDER_FORM select[name="REGISTER[PERSONAL_DAY]"]').val();$(this).siblings('#ORDER_FORM select[name="REGISTER[PERSONAL_DAY]"]').empty();for(var i='<option value="no">-</option>',n=0;n<s[t-1].countday;n++)if(o){if(o==r[n]){i+='<option selected="selected" value="'+r[n]+'">'+r[n]+"</option>";continue}i+='<option value="'+r[n]+'">'+r[n]+"</option>"}else i+='<option value="'+r[n]+'">'+r[n]+"</option>";$(this).siblings('#ORDER_FORM select[name="REGISTER[PERSONAL_DAY]"]').append(i)})}()});