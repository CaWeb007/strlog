(function(){var a=window.BX;if(a.CommentAux){return}a.CommentAux={postEventTypeList:["BLOG_POST","FORUM_TOPIC","TASK","TIMEMAN_ENTRY","TIMEMAN_REPORT","LOG_ENTRY","PHOTO_ALBUM","PHOTO_PHOTO","WIKI","LISTS_NEW_ELEMENT","CALENDAR_EVENT","INTRANET_NEW_USER","BITRIX24_NEW_USER"],commentEventTypeList:["BLOG_COMMENT","FORUM_POST","LOG_COMMENT"]};a.onCustomEvent("BX.CommentAux.initialize",[]);a.CommentAux.init=function(b){a.RenderParts.init(b)};a.CommentAux.isSourcePost=function(b){return a.util.in_array(b,this.postEventTypeList)};a.CommentAux.isSourceComment=function(b){return a.util.in_array(b,this.commentEventTypeList)};a.CommentAux.getLiveText=function(e,g){var b="";if(e=="share"){if(typeof g=="object"&&g.length>0){b=a.message(g.length==1?"SONET_COMMENTAUX_JS_SHARE_TEXT":"SONET_COMMENTAUX_JS_SHARE_TEXT_1");b=b.replace("#SHARE_LIST#",this.getShareList(g))}}else{if(e=="createtask"){if(a.type.isNotEmptyObject(g)&&typeof g.taskId!="undefined"&&parseInt(g.taskId)>0&&a.type.isNotEmptyString(g.taskName)&&a.type.isNotEmptyString(g.sourceEntityType)&&typeof g.sourceEntityId!="undefined"&&parseInt(g.sourceEntityId)>0){var c=this.renderEntity({ENTITY_TYPE:"task",NAME:g.taskName,LINK:(a.type.isNotEmptyString(g.taskUrl)?g.taskUrl:""),VISIBILITY:{userId:(typeof g.taskResponsibleId!="undefined"&&parseInt(g.taskResponsibleId)>0?parseInt(g.taskResponsibleId):0)}});if(this.isSourcePost(g.sourceEntityType)){b=a.message("SONET_COMMENTAUX_JS_CREATETASK_POST_"+(a.type.isNotEmptyString(g.sourceEntityType)?g.sourceEntityType:"BLOG_POST")+(a.type.isNotEmptyString(g.suffix)?"_"+g.suffix:"")).replace("#TASK_NAME#",c).replace("#A_BEGIN#",(!a.RenderParts.mobile?'<a target="_blank" href="'+(a.type.isNotEmptyString(g.sourceEntityLink)?g.sourceEntityLink:"")+'">':"")).replace("#A_END#",(!a.RenderParts.mobile?"</a>":""))}else{if(this.isSourceComment(g.sourceEntityType)){b=a.message("SONET_COMMENTAUX_JS_CREATETASK_COMMENT_"+(a.type.isNotEmptyString(g.sourceEntityType)?g.sourceEntityType+(a.type.isNotEmptyString(g.suffix)?"_"+g.suffix:""):"BLOG_COMMENT")).replace("#TASK_NAME#",c).replace("#A_BEGIN#",(!a.RenderParts.mobile?'<a target="_blank" href="'+(a.type.isNotEmptyString(g.sourceEntityLink)?g.sourceEntityLink:"")+'">':"")).replace("#A_END#",(!a.RenderParts.mobile?"</a>":""))}}}}else{if(e=="fileversion"){var d=(typeof g=="object"&&typeof g.isEnabledKeepVersion!="undefined"&&g.isEnabledKeepVersion?"SONET_COMMENTAUX_JS_FILEVERSION_TEXT":"SONET_COMMENTAUX_JS_HEAD_FILEVERSION_TEXT");var f=(typeof g=="object"&&typeof g.userGender!="undefined"?g.userGender:"");b=a.message(d+(f.length>0?"_"+f:""))}}}return b};a.CommentAux.getShareList=function(e){var b="";var c=[];if(typeof e=="object"&&e.length>0){var d;for(d=0;d<e.length;d++){if(e.hasOwnProperty(d)){c.push(this.renderEntity(e[d]))}}b=c.join(", ")}return b};a.CommentAux.renderEntity=function(c){var b="";if(typeof c=="object"&&c.ENTITY_TYPE!="undefined"){switch(c.ENTITY_TYPE){case"U":b=a.RenderParts.getNodeU(c);break;case"UA":b=a.RenderParts.getNodeUA();break;case"SG":b=a.RenderParts.getNodeSG(c);break;case"DR":b=a.RenderParts.getNodeDR(c);break;case"task":b=a.RenderParts.getNodeTask(c);break;default:}var d=a.create("div",{children:[b]});b=d.innerHTML;a.cleanNode(d,true)}return b}})();