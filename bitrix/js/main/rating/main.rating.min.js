(function(){var a=window.BX;a.namespace("BXRL");if(typeof BXRL.render!="undefined"){return}a.namespace("BXRL.render");a.namespace("BXRL.manager");BXRL.render={reactionsList:["like","kiss","laugh","wonder","cry","angry"],popupCurrentReaction:false,popupPagesList:[],popupSizeInitialized:false,blockShowPopup:false,blockShowPopupTimeout:false,afterClickBlockShowPopup:false,touchStartPosition:null,touchCurrentPosition:{x:null,y:null},currentReactionNodeHover:null,touchMoveDeltaY:null,touchScrollTop:0,hasMobileTouchMoved:null,mobileOverlay:null,getTopUsersText:function(c){var h=(typeof c.you!="undefined"?!!c.you:false);var b=(typeof c.top!="undefined"&&a.type.isArray(c.top)?c.top:[]);var j=(typeof c.more!="undefined"?parseInt(c.more):0);var k="";if(b.length<=0&&!h&&(BXRL.manager.mobile||j<=0)){return k}if(BXRL.manager.mobile){if(h){b.push({ID:parseInt(a.message("USER_ID")),NAME_FORMATTED:a.message("RATING_LIKE_TOP_TEXT3_YOU"),WEIGHT:1})}k=a.message("RATING_LIKE_TOP_TEXT3_"+(b.length>1?"2":"1")).replace("#OVERFLOW_START#",BXRL.manager.mobile?'<span class="feed-post-emoji-text-item-overflow">':"").replace("#OVERFLOW_END#",BXRL.manager.mobile?"</span>":"")}else{k=a.message("RATING_LIKE_TOP_TEXT2_"+(h?"YOU_":"")+(b.length)+(j>0?"_MORE":"")).replace("#OVERFLOW_START#",BXRL.manager.mobile?'<span class="feed-post-emoji-text-item-overflow">':"").replace("#OVERFLOW_END#",BXRL.manager.mobile?"</span>":"").replace("#MORE_START#",BXRL.manager.mobile?'<span class="feed-post-emoji-text-item-more">':"&nbsp;").replace("#MORE_END#",BXRL.manager.mobile?"</span>":"")}if(BXRL.manager.mobile){b.sort(function(l,i){if(parseFloat(l.ID)===parseInt(a.message("USER_ID"))){return -1}if(parseInt(i.ID)===parseInt(a.message("USER_ID"))){return 1}if(parseFloat(l.WEIGHT)===parseFloat(i.WEIGHT)){return 0}return(parseFloat(l.WEIGHT)>parseFloat(i.WEIGHT)?-1:1)});var g=b.map(function(i){return i.NAME_FORMATTED});var f="",e="";if(g.length===1){f=g.pop();e=""}else{f=g.slice(0,g.length-1).join(a.message("RATING_LIKE_TOP_TEXT3_USERLIST_SEPARATOR").replace(/#USERNAME#/g,""));e=g[g.length-1]}k=k.replace("#USER_LIST_BEGIN#",f).replace("#USER_LIST_END#",e)}else{for(var d in b){if(!b.hasOwnProperty(d)){continue}k=k.replace("#USER_"+(parseInt(d)+1)+"#",'<span class="feed-post-emoji-text-item">'+b[d].NAME_FORMATTED+"</span>")}k=k.replace("#USERS_MORE#",'<span class="feed-post-emoji-text-item">'+j+"</span>")}return k},getUserReaction:function(d){var b="";var c=(a(d.userReactionNode)?a(d.userReactionNode):false);if(c){b=c.getAttribute("data-value")}return b},setReaction:function(z){if(typeof z.rating=="undefined"||!a.type.isNotEmptyString(z.likeId)){return}var r=z.likeId,m=z.rating,s=(a.type.isNotEmptyString(z.action)?z.action:"add"),k=(a.type.isNotEmptyString(z.userReaction)?z.userReaction:a.message("RATING_LIKE_REACTION_DEFAULT")),o=(a.type.isNotEmptyString(z.userReactionOld)?z.userReactionOld:a.message("RATING_LIKE_REACTION_DEFAULT")),w=(typeof z.totalCount!="undefined"?parseInt(z.totalCount):null),e=(typeof z.userId!="undefined"?parseInt(z.userId):parseInt(a.message("USER_ID")));if(!a.util.in_array(s,["add","cancel","change"])){return}if(s=="change"&&k==o){return}var A=(a(m.userReactionNode)?a(m.userReactionNode):false);var t=(a(m.reactionsNode)?a(m.reactionsNode):false);var g=(a(m.topPanel)?a(m.topPanel):false);var d=(a(m.topPanelContainer)?a(m.topPanelContainer):false);var b=(a(m.topUsersText)?a(m.topUsersText):false);var x=(a(m.countText)?a(m.countText):false);var c=(a(m.buttonText)?a(m.buttonText):false);if(e==a.message("USER_ID")&&A){A.setAttribute("data-value",(a.util.in_array(s,["add","change"])?k:""))}var u=0,q=false,j=false,v=false,l=false;if(w!==null&&g&&b&&t){if(w>0){d.classList.add("feed-post-emoji-top-panel-container-active");if(!g.classList.contains("feed-post-emoji-container-toggle")){g.classList.add("feed-post-emoji-container-toggle");b.classList.add("feed-post-emoji-move-to-right");t.classList.add("feed-post-emoji-icon-box-show")}}else{if(w<=0){d.classList.remove("feed-post-emoji-top-panel-container-active");if(g.classList.contains("feed-post-emoji-container-toggle")){g.classList.remove("feed-post-emoji-container-toggle");b.classList.remove("feed-post-emoji-move-to-right");t.classList.remove("feed-post-emoji-icon-box-show")}}}}if(w!==null&&x){if(w<=0&&!x.classList.contains("feed-post-emoji-text-counter-invisible")){x.classList.add("feed-post-emoji-text-counter-invisible")}else{if(w>0&&x.classList.contains("feed-post-emoji-text-counter-invisible")){x.classList.remove("feed-post-emoji-text-counter-invisible")}}}if(t){var f=t.querySelector(".feed-post-emoji-icon-container");q=t.querySelectorAll(".feed-post-emoji-icon-item");j=[];if(f){var p=false,n=false;for(u=0;u<q.length;u++){v=q[u].getAttribute("data-reaction");l=parseInt(q[u].getAttribute("data-value"));if(v==k){p=true;if(s=="cancel"){n=(l>0?l-1:0)}else{if(a.util.in_array(s,["add","change"])){n=l+1}}if(n>0){j.push({reaction:v,count:n,animate:false})}}else{if(s=="change"&&v==o){n=(l>0?l-1:0);if(n>0){j.push({reaction:v,count:n,animate:false})}}else{j.push({reaction:v,count:l,animate:false})}}}if(a.util.in_array(s,["add","change"])&&!p){j.push({reaction:k,count:1,animate:true})}a.cleanNode(f);if(g){if(j.length>0){g.classList.add("feed-post-emoji-container-nonempty")}else{g.classList.remove("feed-post-emoji-container-nonempty")}if(BXRL.manager.mobile){var y=a.findParent(g,{className:"post-comment-block"});if(y){if(j.length>0){y.classList.add("comment-block-rating-nonempty")}else{y.classList.remove("comment-block-rating-nonempty")}}}}var h=(BXRL.manager.mobile?{}:{click:BXRL.render.resultReactionClick,mouseenter:BXRL.render.resultReactionMouseEnter,mouseleave:BXRL.render.resultReactionMouseLeave});for(u=0;u<j.length;u++){if(u>=1){f.appendChild(a.create("span",{props:{id:"bx-ilike-result-reaction-"+j[u].reaction+"-"+r,className:"feed-post-emoji-icon-item "+(j[u].animate?"feed-post-emoji-icon-animate":"")+" feed-post-emoji-icon-"+j[u].reaction+" feed-post-emoji-icon-item-"+(u+1)},attrs:{"data-reaction":j[u].reaction,"data-value":j[u].count,"data-like-id":r,title:a.message("RATING_LIKE_EMOTION_"+j[u].reaction.toUpperCase()+"_CALC")},events:h}))}else{f.appendChild(a.create("span",{props:{id:"bx-ilike-result-reaction-"+j[u].reaction+"-"+r,className:"feed-post-emoji-icon-item "+(j.length==1&&j[u].animate?"feed-post-emoji-animation-pop":"")+" feed-post-emoji-icon-"+j[u].reaction+" feed-post-emoji-icon-item-"+(u+1)},attrs:{"data-reaction":j[u].reaction,"data-value":j[u].count,"data-like-id":r,title:a.message("RATING_LIKE_EMOTION_"+j[u].reaction.toUpperCase()+"_CALC")},events:h}))}}}}if(e==a.message("USER_ID")&&a(c)){if(a.util.in_array(s,["add","change"])){a(c).innerHTML=a.message("RATING_LIKE_EMOTION_"+k.toUpperCase()+"_CALC");if(BXRL.manager.mobile){c.parentElement.className="bx-ilike-left-wrap bx-you-like-button bx-you-like-button-"+k.toLowerCase()}}else{a(c).innerHTML=a.message("RATING_LIKE_EMOTION_LIKE_CALC");if(BXRL.manager.mobile){c.parentElement.className="bx-ilike-left-wrap"}}}},reactionsPopup:null,reactionsPopupAnimation:null,reactionsPopupAnimation2:null,reactionsPopupLikeId:null,reactionsPopupMouseOutHandler:null,reactionsPopupOpacityState:0,reactionsPopupTouchStartIn:null,reactionsPopupPositionY:null,blockTouchEndByScroll:false,showReactionsPopup:function(f){var k=(a(f.bindElement)?a(f.bindElement):false),b=(a.type.isNotEmptyString(f.likeId)?f.likeId:false);if(!k||!b){return false}BXRL.render.reactionsPopupLikeId=b;if(BXRL.render.reactionsPopup==null){var c=[];for(var g in BXRL.render.reactionsList){var j=BXRL.render.reactionsList[g];c.push(a.create("div",{props:{className:"feed-post-emoji-icon-item feed-post-emoji-icon-"+j},attrs:{"data-reaction":j,title:a.message("RATING_LIKE_EMOTION_"+j.toUpperCase()+"_CALC")}}))}BXRL.render.reactionsPopup=a.create("div",{props:{className:"feed-post-emoji-popup-container"+(BXRL.manager.mobile?" feed-post-emoji-popup-container-mobile":"")},children:[a.create("div",{props:{className:"feed-post-emoji-icon-inner"},children:c})]});a.bind(BXRL.render.reactionsPopup,(BXRL.manager.mobile?"touchend":"click"),function(l){var i=false;if(l.target.classList.contains("feed-post-emoji-icon-item")){i=l.target}else{i=a.findParent(l.target,{className:"feed-post-emoji-icon-item"},BXRL.render.reactionsPopup)}if(i){RatingLike.ClickVote(BXRL.render.reactionsPopupLikeId,i.getAttribute("data-reaction"),true)}l.preventDefault()});a.append(BXRL.render.reactionsPopup,document.body)}else{if(BXRL.render.reactionsPopup.classList.contains("feed-post-emoji-popup-invisible")){BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-invisible")}else{if(BXRL.manager.mobile&&BXRL.render.reactionsPopup.classList.contains("feed-post-emoji-popup-invisible-final-mobile")){BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-invisible-final-mobile")}else{return}}}BXRL.render.reactionsPopupMouseOutHandler=a.proxy(function(l){var m=BXRL.render.reactionsPopup.getBoundingClientRect();var i=BXRL.render.reactionsPopup.classList.contains("feed-post-emoji-popup-inverted");if(l.clientX>=m.left&&l.clientX<=m.right&&l.clientY>=m.top-(i?25:0)&&l.clientY<=(m.bottom+(i?0:25))){return}BXRL.render.blockReactionsPopup();BXRL.render.hideReactionsPopup({likeId:this.likeId});a.unbind(document,"mousemove",BXRL.render.reactionsPopupMouseOutHandler);BXRL.render.reactionsPopupMouseOutHandler=null},{likeId:b});var h=a.pos(k);if(a.findParent(k,{className:"feed-com-informers-bottom"})&&(a.findParent(k,{className:"iframe-comments-cont"})||a.findParent(k,{className:"task-iframe-popup"}))){h.left+=100}var d=((h.top-a.GetWindowSize().scrollTop)<80);if(d){BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-inverted")}else{BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-inverted")}var e=(d?15:-50);if(BXRL.manager.mobile){BXRL.render.touchMoveDeltaY=(d?60:-50);a.adjust(BXRL.render.reactionsPopup,{style:{left:"12px",top:((d?(h.top-23):(h.top-28))+e)+"px",width:"320px",borderRadius:"68px"}});BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-invisible-final");BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active-final");BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active-final-item");BXRL[b].box.classList.add("feed-post-emoji-control-active");BXRL.render.reactionsPopupMobileDisableScroll()}else{BXRL.render.reactionsPopupAnimation=new a.easing({duration:300,start:{width:100,left:(h.left+(h.width/2)-50),top:((d?h.top-30:h.top+30)+e),borderRadius:0,opacity:0},finish:{width:271,left:(h.left+(h.width/2)-133),top:(h.top+e),borderRadius:50,opacity:100},transition:a.easing.makeEaseInOut(a.easing.transitions.cubic),step:function(i){BXRL.render.reactionsPopup.style.width=i.width+"px";BXRL.render.reactionsPopup.style.left=i.left+"px";BXRL.render.reactionsPopup.style.top=i.top+"px";BXRL.render.reactionsPopup.style.borderRadius=i.borderRadius+"px";BXRL.render.reactionsPopup.style.opacity=i.opacity/100;BXRL.render.reactionsPopupOpacityState=i.opacity},complete:function(){BXRL.render.reactionsPopup.style.opacity="";BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active-final");BXRL[b].box.classList.add("feed-post-emoji-control-active")}});BXRL.render.reactionsPopupAnimation.animate();setTimeout(function(){var i=BXRL.render.reactionsPopup.querySelectorAll(".feed-post-emoji-icon-item");BXRL.render.reactionsPopupAnimation2=new a.easing({duration:140,start:{opacity:0},finish:{opacity:100},transition:a.easing.transitions.cubic,step:function(l){i[0].style.opacity=l.opacity/100;i[1].style.opacity=l.opacity/100;i[2].style.opacity=l.opacity/100;i[3].style.opacity=l.opacity/100;i[4].style.opacity=l.opacity/100;i[5].style.opacity=l.opacity/100},complete:function(){BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active-final-item");i[0].style.opacity="";i[1].style.opacity="";i[2].style.opacity="";i[3].style.opacity="";i[4].style.opacity="";i[5].style.opacity=""}});BXRL.render.reactionsPopupAnimation2.animate()},100)}if(!BXRL.render.reactionsPopup.classList.contains("feed-post-emoji-popup-active")){BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-active")}if(!BXRL.manager.mobile){a.bind(document,"mousemove",BXRL.render.reactionsPopupMouseOutHandler)}else{BXRL.render.touchScrollTop=a.GetWindowSize().scrollTop;BXRL.render.hasMobileTouchMoved=null;window.addEventListener("touchend",BXRL.render.reactionsPopupMobileTouchEndHandler);window.addEventListener("touchmove",BXRL.render.reactionsPopupMobileTouchMoveHandler)}},reactionsPopupMobileTouchEndHandler:function(d){var b={x:d.changedTouches[0].pageX,y:d.changedTouches[0].pageY};if(BXRL.render.hasMobileTouchMoved===true){var f=null,c=BXRL.render.reactionsPopupMobileGetHoverNode(b.x,b.y);if(c&&(f=c.getAttribute("data-reaction"))){RatingLike.ClickVote(BXRL.render.reactionsPopupLikeId,f,true)}BXRL.render.reactionsPopupMobileHide()}else{window.addEventListener("touchend",BXRL.render.reactionsPopupMobileHide)}window.removeEventListener("touchend",BXRL.render.reactionsPopupMobileTouchEndHandler);window.removeEventListener("touchmove",BXRL.render.reactionsPopupMobileTouchMoveHandler);BXRL.render.touchStartPosition=null;d.preventDefault()},reactionsPopupMobileHide:function(b){window.removeEventListener("touchend",BXRL.render.reactionsPopupMobileHide);if(BXRL.render.reactionsPopupLikeId){BXRL.render.hideReactionsPopup({likeId:BXRL.render.reactionsPopupLikeId});if(b){b.preventDefault()}}},reactionsPopupMobileCheckTouchMove:function(){if(BXRL.render.touchStartPosition===null){return true}else{if(Math.abs(BXRL.render.touchCurrentPosition.x-BXRL.render.touchStartPosition.x)>5||Math.abs(BXRL.render.touchCurrentPosition.y-BXRL.render.touchStartPosition.y)>5){return false}}return true},reactionsPopupMobileTouchMoveHandler:function(d){var b={x:d.touches[0].pageX,y:d.touches[0].pageY};BXRL.render.touchCurrentPosition={x:b.x,y:b.y};if(BXRL.render.touchStartPosition===null){BXRL.render.touchStartPosition={x:b.x,y:b.y}}else{if(BXRL.render.hasMobileTouchMoved!==true){BXRL.render.hasMobileTouchMoved=!BXRL.render.reactionsPopupMobileCheckTouchMove()}}if(BXRL.render.hasMobileTouchMoved===true){var c=BXRL.render.reactionsPopupMobileGetHoverNode(b.x,b.y);if(c){if(BXRL.render.currentReactionNodeHover&&BXRL.render.currentReactionNodeHover!=c){BXRL.render.reactionsPopupMobileRemoveHover(BXRL.render.currentReactionNodeHover)}BXRL.render.reactionsPopupMobileAddHover(c);BXRL.render.currentReactionNodeHover=c}else{if(BXRL.render.currentReactionNodeHover){BXRL.render.reactionsPopupMobileRemoveHover(BXRL.render.currentReactionNodeHover)}}}else{if(BXRL.render.currentReactionNodeHover){BXRL.render.reactionsPopupMobileRemoveHover(BXRL.render.currentReactionNodeHover)}}},reactionsPopupMobileGetHoverNode:function(c,f){var d=null,e=null,b=null;if(((d=document.elementFromPoint(c,(f+BXRL.render.touchMoveDeltaY-BXRL.render.touchScrollTop)))&&(e=d.getAttribute("data-reaction"))&&a.type.isNotEmptyString(e))||((d=document.elementFromPoint(c,(f-BXRL.render.touchScrollTop)))&&(e=d.getAttribute("data-reaction"))&&a.type.isNotEmptyString(e))){b=d}return b},reactionsPopupMobileAddHover:function(b){if(b){b.classList.add("feed-post-emoji-icon-item-hover")}},reactionsPopupMobileRemoveHover:function(b){if(b){b.classList.remove("feed-post-emoji-icon-item-hover")}},reactionsPopupMobileDisableScroll:function(){document.addEventListener("touchmove",BXRL.render.touchMoveScrollListener,{passive:false});a.onCustomEvent("onPullDownDisable",{});if(BXRL.render.mobileOverlay===null){BXRL.render.mobileOverlay=a.create("DIV",{props:{className:"feed-post-emoji-popup-mobile-overlay"}});setTimeout(function(){if(BXRL.render.mobileOverlay!==null){a.append(BXRL.render.mobileOverlay,document.body)}},1000)}},reactionsPopupMobileEnableScroll:function(){document.removeEventListener("touchmove",BXRL.render.touchMoveScrollListener,{passive:false});a.onCustomEvent("onPullDownEnable",{});if(BXRL.render.mobileOverlay!==null){a.cleanNode(BXRL.render.mobileOverlay,true);BXRL.render.mobileOverlay=null}},touchMoveScrollListener:function(b){b.preventDefault()},hideReactionsPopup:function(c){var b=(a.type.isNotEmptyString(c.likeId)?c.likeId:false);if(BXRL.render.reactionsPopup){if(BXRL.manager.mobile){BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-invisible-final");BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-invisible-final-mobile");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active-final");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active-final-item");BXRL.render.reactionsPopupMobileEnableScroll()}else{if(BXRL.render.reactionsPopupAnimation){BXRL.render.reactionsPopupAnimation.stop()}if(BXRL.render.reactionsPopupAnimation2){BXRL.render.reactionsPopupAnimation2.stop()}BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-invisible");BXRL.render.reactionsPopupAnimation4=new a.easing({duration:500,start:{opacity:BXRL.render.reactionsPopupOpacityState},finish:{opacity:0},transition:a.easing.transitions.linear,step:function(d){BXRL.render.reactionsPopup.style.opacity=d.opacity/100;BXRL.render.reactionsPopupOpacityState=d.opacity},complete:function(){BXRL.render.reactionsPopup.style.opacity="";BXRL.render.reactionsPopup.classList.add("feed-post-emoji-popup-invisible-final");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active-final");BXRL.render.reactionsPopup.classList.remove("feed-post-emoji-popup-active-final-item")}});BXRL.render.reactionsPopupAnimation4.animate()}BXRL.render.reactionsPopupLikeId=null;if(b){BXRL[b].box.classList.remove("feed-post-emoji-control-active")}}BXRL.render.reactionsPopupMobileRemoveHover(BXRL.render.currentReactionNodeHover);if(b){BXRL.render.bindReactionsPopup({likeId:b})}},bindReactionsPopup:function(c){if(BXRL.manager.mobile){return false}var b=(a.type.isNotEmptyString(c.likeId)?c.likeId:false);if(!b||typeof BXRL[b]=="undefined"||!BXRL[b]){return false}BXRL[b].mouseOverHandler=a.debounce(function(){if(BXRL.render.afterClickBlockShowPopup){a.unbind(BXRL[this.likeId].box,"mouseenter",BXRL[this.likeId].mouseOverHandler);a.unbind(BXRL[this.likeId].box,"mouseleave",BXRL.render.blockReactionsPopup);return}if(!BXRL.render.blockShowPopup){if(BXRL.manager.mobile){app.exec("callVibration")}BXRL.render.showReactionsPopup({bindElement:BXRL[this.likeId].box,likeId:this.likeId});a.unbind(BXRL[this.likeId].box,"mouseenter",BXRL[this.likeId].mouseOverHandler);a.unbind(BXRL[this.likeId].box,"mouseleave",BXRL.render.blockReactionsPopup)}},500,{likeId:b});a.bind(BXRL[b].box,"mouseenter",BXRL[b].mouseOverHandler);a.bind(BXRL[b].box,"mouseleave",BXRL.render.blockReactionsPopup)},buildPopupContent:function(t){var q=(!!t.clear?t.clear:false),o=(a.type.isNotEmptyString(t.likeId)?t.likeId:false),k=t.rating,h=(a.type.isNotEmptyString(t.reaction)?t.reaction:""),e=(parseInt(t.page)>0?t.page:1),v=t.data,d=false;var u=[],j=0,s=null,r=null;if(q&&e==1){BXRL.render.clearPopupContent({likeId:o})}this.popupCurrentReaction=(a.type.isNotEmptyString(h)?h:"all");if(h.length<=0||h=="all"){BXRL.render.popupSizeInitialized=false;a("bx-ilike-popup-cont-"+o).style.height="auto";a("bx-ilike-popup-cont-"+o).style.minWidth="auto"}if(!a.type.isNotEmptyString(h)){this.popupPagesList={}}this.popupPagesList[(h==""?"all":h)]=(e+1);if(typeof v.reactions!="undefined"){for(d in v.reactions){if(!v.reactions.hasOwnProperty(d)||parseInt(v.reactions[d])<=0){continue}u.push({reaction:d,count:parseInt(v.reactions[d])});j++;s=d}}var m=a.create("span",{props:{className:"bx-ilike-popup-head"}});if(j>1){m.appendChild(a.create("span",{props:{className:"bx-ilike-popup-head-item"+(!a.type.isNotEmptyString(h)||h=="all"?" bx-ilike-popup-head-item-current":"")},children:[a.create("span",{props:{className:"bx-ilike-popup-head-icon feed-post-emoji-icon-all"}}),a.create("span",{props:{className:"bx-ilike-popup-head-text"},html:a.message("RATING_LIKE_POPUP_ALL").replace("#CNT#",parseInt(v.items_all))})],events:{click:a.proxy(function(i){BXRL.render.changePopupTab({likeId:this.likeId,rating:this.rating,reaction:"all"});i.preventDefault()},{likeId:o,rating:k})}}))}if(j==0){u.push({reaction:a.message("RATING_LIKE_REACTION_DEFAULT"),count:parseInt(v.items_all)})}u.sort(function(w,i){var x={like:0,kiss:1,laugh:2,wonder:3,cry:4,angry:5};if(x[w.reaction]<x[i.reaction]){return -1}if(x[w.reaction]>x[i.reaction]){return 1}return 0});for(var g=0;g<u.length;g++){m.appendChild(a.create("span",{props:{className:"bx-ilike-popup-head-item"+(h==u[g].reaction?" bx-ilike-popup-head-item-current":"")},attrs:{title:a.message("RATING_LIKE_EMOTION_"+u[g].reaction.toUpperCase()+"_CALC")},children:[a.create("span",{props:{className:"bx-ilike-popup-head-icon feed-post-emoji-icon-item feed-post-emoji-icon-"+u[g].reaction}}),a.create("span",{props:{className:"bx-ilike-popup-head-text"},html:u[g].count})],events:{click:a.proxy(function(x){var i=a("bx-ilike-popup-cont-"+this.likeId);var w=i.getBoundingClientRect();if(h.length<=0||h=="all"){BXRL.render.popupSizeInitialized=true;i.style.height=w.height+"px";i.style.minWidth=w.width+"px"}else{if(w.width>parseInt(i.style.minWidth)){i.style.minWidth=w.width+"px"}}BXRL.render.changePopupTab({likeId:this.likeId,rating:this.rating,reaction:this.reaction});x.preventDefault()},{likeId:o,rating:k,reaction:u[g].reaction})}}))}var n=k.popupContent.querySelector(".bx-ilike-popup-content-container");var f=false;if(!n){n=a.create("span",{props:{className:"bx-ilike-popup-content-container"}})}else{f=true}var p=n.querySelectorAll(".bx-ilike-popup-content");for(r=0;r<p.length;r++){p[r].classList.add("bx-ilike-popup-content-invisible")}var c=n.querySelector(".bx-ilike-popup-content-"+this.popupCurrentReaction);if(!c){c=a.create("span",{props:{className:"bx-ilike-popup-content bx-ilike-popup-content-"+this.popupCurrentReaction}});n.appendChild(c)}else{c.classList.remove("bx-ilike-popup-content-invisible")}for(r=0;r<v.items.length;r++){c.appendChild(a.create("a",{props:{className:"bx-ilike-popup-user-item"+(a.type.isNotEmptyString(v.items[r]["USER_TYPE"])?" bx-ilike-popup-user-item-"+v.items[r]["USER_TYPE"]:"")},attrs:{href:v.items[r]["URL"],target:"_blank"},children:[a.create("span",{props:{className:"bx-ilike-popup-user-icon"},style:(a.type.isNotEmptyString(v.items[r]["PHOTO_SRC"])?{"background-image":'url("'+v.items[r]["PHOTO_SRC"]+'")'}:{})}),a.create("span",{props:{className:"bx-ilike-popup-user-name"},html:v.items[r]["FULL_NAME"]}),a.create("SPAN",{props:{className:"bx-ilike-popup-user-status"}})]}))}var l=k.popupContent.querySelector(".bx-ilike-wait");if(l){a.cleanNode(l,true)}var b=k.popupContent.querySelector(".bx-ilike-popup-head");if(b){b.parentNode.insertBefore(m,b);b.parentNode.removeChild(b)}else{k.popupContent.appendChild(m)}if(!f){k.popupContent.appendChild(n)}},clearPopupContent:function(c){var b=(a.type.isNotEmptyString(c.likeId)?c.likeId:false);BXRL[b].popupContent.innerHTML="";a("bx-ilike-popup-cont-"+b).style.height="auto";a("bx-ilike-popup-cont-"+b).style.minWidth="auto";BXRL[b].popupContent.appendChild(a.create("span",{props:{className:"bx-ilike-wait"}}))},blockReactionsPopup:function(){if(BXRL.render.blockShowPopupTimeout){window.clearTimeout(BXRL.render.blockShowPopupTimeout)}BXRL.render.blockShowPopup=true;BXRL.render.blockShowPopupTimeout=setTimeout(function(){BXRL.render.blockShowPopup=false},500)},changePopupTab:function(c){var b=(a.type.isNotEmptyString(c.likeId)?c.likeId:false),d=c.rating,f=(a.type.isNotEmptyString(c.reaction)?c.reaction:""),e=false,g=false;var l=d.popupContent.querySelector(".bx-ilike-popup-content-container");if(!l){return false}var j=l.querySelector(".bx-ilike-popup-content-"+f);if(j){this.popupCurrentReaction=(a.type.isNotEmptyString(f)?f:"all");var h=d.popupContent.querySelectorAll(".bx-ilike-popup-head-item");for(e=0;e<h.length;e++){h[e].classList.remove("bx-ilike-popup-head-item-current");g=h[e].querySelector(".feed-post-emoji-icon-"+f);if(g){h[e].classList.add("bx-ilike-popup-head-item-current")}}var k=l.querySelectorAll(".bx-ilike-popup-content");for(e=0;e<k.length;e++){k[e].classList.add("bx-ilike-popup-content-invisible")}j.classList.remove("bx-ilike-popup-content-invisible")}else{RatingLike.List(b,1,f)}},afterClick:function(c){var b=(a.type.isNotEmptyString(c.likeId)?c.likeId:false);if(!b){return}BXRL.render.afterClickBlockShowPopup=true;BXRL.render.afterClickHandler=a.proxy(function(d){BXRL.render.afterClickBlockShowPopup=false;a.unbind(BXRL[this.likeId].box,"mouseleave",BXRL.render.afterClickHandler)},{likeId:b});a.bind(BXRL[b].box,"mouseleave",BXRL.render.afterClickHandler)},resultReactionClick:function(c){var d=c.currentTarget.getAttribute("data-like-id"),b=c.currentTarget.getAttribute("data-reaction");if(!a.type.isNotEmptyString(b)){b=""}RatingLike.onResultClick({likeId:d,event:c,reaction:b});c.stopPropagation()},resultReactionMouseEnter:function(c){var d=c.currentTarget.getAttribute("data-like-id"),b=c.currentTarget.getAttribute("data-reaction");RatingLike.onResultMouseEnter({likeId:d,event:c,reaction:b})},resultReactionMouseLeave:function(c){var d=c.currentTarget.getAttribute("data-like-id"),b=c.currentTarget.getAttribute("data-reaction");RatingLike.onResultMouseLeave({likeId:d,reaction:b})},openMobileReactionsPage:function(b){BXMobileApp.PageManager.loadPageBlank({url:a.message("SITE_DIR")+"mobile/like/result.php",title:a.message("RATING_LIKE_RESULTS"),backdrop:{mediumPositionPercent:65},cache:true,data:{entityTypeId:b.entityTypeId,entityId:b.entityId}})},onRatingLike:function(d){for(var c in BXRL){if(!BXRL.hasOwnProperty(c)){continue}if(BXRL[c].entityTypeId==d.entityTypeId&&BXRL[c].entityId==d.entityId){var b=(a.type.isNotEmptyString(d.voteAction)?d.voteAction.toUpperCase():"ADD");b=(b=="PLUS"?"ADD":b);if(d.userId==a.message("USER_ID")&&BXRL[c].button){if(b=="CANCEL"){a.removeClass(BXRL[c].button,"bx-you-like-button")}else{a.addClass(BXRL[c].button,"bx-you-like-button")}}RatingLike.Draw(c,{TYPE:b,USER_ID:d.userId,ENTITY_TYPE_ID:d.entityTypeId,ENTITY_ID:d.entityId,USER_DATA:d.userData,REACTION:d.voteReaction,REACTION_OLD:d.voteReactionOld,TOTAL_POSITIVE_VOTES:d.itemsAll})}}}};BXRL.manager={mobile:false,inited:false,displayHeight:0,startScrollTop:0,entityList:[],ratingNodeList:{},delayedList:{},init:function(b){if(typeof b=="undefined"){b={}}if(this.inited){return}this.mobile=(typeof b.mobile!="undefined"&&!!b.mobile);this.inited=true;this.setDisplayHeight();if(!this.mobile){window.addEventListener("scroll",a.throttle(function(){this.getInViewScope()},80,this),{passive:true});window.addEventListener("resize",a.delegate(this.setDisplayHeight,this))}a.addCustomEvent("onBeforeMobileLivefeedRefresh",BXRL.render.reactionsPopupMobileHide);if(this.mobile){BXMobileApp.addCustomEvent("onRatingLike",BXRL.render.onRatingLike)}},addEntity:function(b,c){if(!a.util.in_array(b,this.entityList)&&c.topPanelContainer){this.entityList.push(b);this.addNode(b,c.topPanelContainer)}},checkEntity:function(b){return a.util.in_array(b,this.entityList)},addNode:function(b,c){if(a(c)&&typeof this.ratingNodeList[b]!="undefined"){return}this.ratingNodeList[b]=c},getNode:function(c){var b=false;if(typeof this.ratingNodeList[c]!=undefined){b=this.ratingNodeList[c]}return b},setDisplayHeight:function(){this.displayHeight=document.documentElement.clientHeight},getInViewScope:function(){var b=null;for(var c in this.delayedList){if(!this.delayedList.hasOwnProperty(c)){continue}b=a(this.getNode(c));if(!b){continue}if(this.isNodeVisibleOnScreen(b)){this.fireAnimation(c,b,this.delayedList[c])}}},isNodeVisibleOnScreen:function(c){var e=c.getBoundingClientRect();var d=parseInt(this.displayHeight/10);var b=parseInt(this.displayHeight*9/10);return(((e.top>0&&e.top<b)||(e.bottom>d&&e.bottom<this.displayHeight))&&(this.mobile||!((e.top<d&&e.bottom<d)||(e.top>b&&e.bottom>b))))},live:function(d){if(typeof d.TYPE=="undefined"||d.TYPE!="ADD"||!a.type.isNotEmptyString(d.ENTITY_TYPE_ID)||typeof d.ENTITY_ID=="undefined"||parseInt(d.ENTITY_ID)<=0){return}var c=d.ENTITY_TYPE_ID+"_"+d.ENTITY_ID;if(!this.checkEntity(c)){return}var b=this.getNode(c);if(!b){return false}if(this.isNodeVisibleOnScreen(b)){this.fireAnimation(c,b,d)}else{this.addDelayed(d)}},addDelayed:function(b){if(!a.type.isNotEmptyString(b.ENTITY_TYPE_ID)||typeof b.ENTITY_ID=="undefined"||parseInt(b.ENTITY_ID)<=0){return}var c=b.ENTITY_TYPE_ID+"_"+b.ENTITY_ID;if(typeof this.delayedList[c]=="undefined"){this.delayedList[c]=[]}this.delayedList[c].push(b)},fireAnimation:function(b,c,d){if(typeof this.delayedList[b]!="undefined"){delete this.delayedList[b]}}}})();