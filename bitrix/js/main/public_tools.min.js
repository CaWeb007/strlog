function JCPopup(a){if(!a){a={}}this.suffix=a.suffix?"_"+a.suffix.toString().toLowerCase():"";this.div_id="bx_popup_form_div"+this.suffix;this.overlay_id="bx_popup_overlay"+this.suffix;this.form_name="bx-popup-form"+this.suffix;this.class_name="bx-popup-form";this.url="";this.zIndex=a.zIndex||1020;this.arParams=null;this.bDenyClose=false;this.bDenyEscKey=false;this.__arRuntimeResize={};this.bodyOverflow="";this.currentScroll=0;this.div=null;this.div_inner=null;this.x=0;this.y=0;this.error_dy=null;this.arAdditionalResize=[];this.onClose=[];var b=this;window["JCPopup_OnKeyPress"+this.suffix]=function(c){b.__OnKeyPress(c)};window["JCPopup_OverlayResize"+this.suffix]=function(c){b.OverlayResize(c)};window["JCPopup_AjaxAction"+this.suffix]=function(c){b.AjaxAction(c)};window["JCPopup_AjaxPostAction"+this.suffix]=function(c){b.__AjaxPostAction(c)};window["JCPopup_stopResize"+this.suffix]=function(c){b.stopResize(c)};window["JCPopup_startResize"+this.suffix]=function(c){b.startResize(c)};window["JCPopup_doResize"+this.suffix]=function(c){b.doResize(c)};jsExtLoader.jsPopup_name="jsPopup"+this.suffix}JCPopup.prototype.addOnClose=function(a){this.onClose[this.onClose.length]=a};JCPopup.prototype.addAdditionalResize=function(a){this.arAdditionalResize[this.arAdditionalResize.length]=document.getElementById(a)};JCPopup.prototype.clearAdditionalResize=function(){this.arAdditionalResize=[]};JCPopup.prototype.DenyClose=function(a){if(a!==false){a=true}this.bDenyClose=a;if(!this.obSaveButton){this.obSaveButton=document.getElementById("btn_popup_save"+this.suffix);this.obCloseButton=document.getElementById("btn_popup_close"+this.suffix);this.obCancelButton=document.getElementById("btn_popup_cancel"+this.suffix)}if(this.obSaveButton){this.obSaveButton.disabled=a}if(this.obCloseButton){this.obCloseButton.disabled=a}if(this.obCancelButton){this.obCancelButton.disabled=a}};JCPopup.prototype.AllowClose=function(){this.DenyClose(false)};JCPopup.prototype.__OnKeyPress=function(a){if(this.bDenyEscKey){return}if(!a){a=window.event}if(!a){return}if(this.bDenyClose){return}if(a.keyCode==27){jsUtils.removeEvent(document,"keypress",window["JCPopup_OnKeyPress"+this.suffix]);this.CloseDialog()}};JCPopup.prototype.AjaxAction=function(m){CloseWaitWindow();if(this.suffix){jsPopup.bDenyClose=true}var b=document.body.appendChild(document.createElement("DIV"));b.id=this.div_id;b.className=this.class_name;b.style.position="absolute";b.style.zIndex=this.zIndex;b.innerHTML=m;if(null!=this.arParams.height){b.style.height=this.arParams.height+"px"}if(null!=this.arParams.width){b.style.width=this.arParams.width+"px"}var k=jsUtils.GetWindowInnerSize();var l=jsUtils.GetWindowScrollPos();var c=parseInt(l.scrollLeft+k.innerWidth/2-b.offsetWidth/2);var j=parseInt(l.scrollTop+k.innerHeight/2-b.offsetHeight/2);jsFloatDiv.Show(b,c,j,5,true);jsUtils.addEvent(document,"keypress",window["JCPopup_OnKeyPress"+this.suffix]);this.div=b;this.div_inner=document.getElementById("bx_popup_content"+this.suffix);if(this.div_inner){if(this.div.style.width){this.div_inner.style.width=parseInt(parseInt(this.div.style.width)-12)+"px"}if(this.div.style.height){var d=["bx_popup_title","bx_popup_description_container","bx_popup_buttons"];var f=0;for(var e=0;e<d.length;e++){var a=document.getElementById(d[e]+this.suffix);if(a){f+=a.offsetHeight}}this.div_inner.style.height=parseInt(parseInt(this.div.style.height)-f-16)+"px"}}var g=this;setTimeout(function(){g.AdjustShadow()},10);if(this.arParams.resize&&null!=this.div&&null!=this.div_inner){this.createResizer()}return b};JCPopup.prototype.__AjaxPostAction=function(a){CloseWaitWindow();if(this.suffix){jsPopup.bDenyClose=true}this.div.innerHTML=a;this.div_inner=document.getElementById("bx_popup_content"+this.suffix);this.AdjustShadow();if(this.arParams.resize&&null!=this.div&&null!=this.div_inner){this.createResizer()}};JCPopup.prototype.ShowDialog=function(b,c){if(document.getElementById(this.div_id)){this.CloseDialog()}if(!c){c={}}if(null==c.resize){c.resize=true}if(!c.min_width){c.min_width=250}if(!c.min_height){c.min_height=200}var d=b.indexOf("?");if(d==-1){b+="?mode=public"}else{b=b.substring(0,d)+"?mode=public&"+b.substring(d+1)}this.check_url=d==-1?b:b.substring(0,d);if(c.resize&&null!=this.__arRuntimeResize[this.check_url]){c.width=this.__arRuntimeResize[this.check_url].width;c.height=this.__arRuntimeResize[this.check_url].height;var a=b.indexOf("bxpiheight");if(a==-1){b+=(d==-1?"?":"&")+"bxpiheight="+this.__arRuntimeResize[this.check_url].iheight}else{b=b.substring(0,a)+"bxpiheight="+this.__arRuntimeResize[this.check_url].iheight}}this.url=b;this.arParams=c;this.CreateOverlay();jsExtLoader.onajaxfinish=window["JCPopup_AjaxAction"+this.suffix];if(c.postData){jsExtLoader.startPost(b,c.postData)}else{jsExtLoader.start(b)}};JCPopup.prototype.RemoveOverlay=function(){if(this.overlay){this.overlay.parentNode.removeChild(this.overlay)}jsUtils.removeEvent(window,"resize",window["JCPopup_OverlayResize"+this.suffix])};JCPopup.prototype.OverlayResize=function(){if(!this.overlay){return}var a=jsUtils.GetWindowScrollSize();this.overlay.style.width=a.scrollWidth+"px"};JCPopup.prototype.CreateOverlay=function(){var b=new COpacity();if(!b.GetOpacityProperty()){return}this.overlay=document.body.appendChild(document.createElement("DIV"));this.overlay.className="bx-popup-overlay";this.overlay.id=this.overlay_id;this.overlay.style.zIndex=this.zIndex-5;var a=jsUtils.GetWindowScrollSize();this.overlay.style.width=a.scrollWidth+"px";this.overlay.style.height=a.scrollHeight+"px";jsUtils.addEvent(window,"resize",window["JCPopup_OverlayResize"+this.suffix])};JCPopup.prototype.CloseDialog=function(){jsUtils.onCustomEvent("OnBeforeCloseDialog",this.suffix);for(var a=0;a<this.onClose.length;a++){this.onClose[a]()}if(this.bDenyClose){return false}if(this.suffix){jsPopup.bDenyClose=false}jsUtils.removeEvent(document,"keypress",window["JCPopup_OnKeyPress"+this.suffix]);var b=document.getElementById(this.div_id);if(!b){return}jsFloatDiv.Close(b);b.parentNode.removeChild(b);this.clearAdditionalResize();this.RemoveOverlay();return true};JCPopup.prototype.GetParameters=function(h){if(null==h){var b=document.forms[this.form_name]}else{var b=document.forms[h]}if(!b){return""}var o,q="";var f=b.elements.length;var d="";for(o=0;o<f;o++){if(q!=""){d="&"}var e=b.elements[o];if(e.disabled){continue}switch(e.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==h&&e.name.substr(e.name.length-4)=="_alt"&&b.elements[e.name.substr(0,e.name.length-4)]){break}q+=d+e.name+"="+encodeURIComponent(e.value);break;case"radio":if(e.checked){q+=d+e.name+"="+encodeURIComponent(e.value)}break;case"checkbox":q+=d+e.name+"="+encodeURIComponent(e.checked?"Y":"N");break;case"select-one":var g="";if(null==h&&b.elements[e.name+"_alt"]&&e.selectedIndex==0){g=b.elements[e.name+"_alt"].value}else{g=e.value}q+=d+e.name+"="+encodeURIComponent(g);break;case"select-multiple":var m,p=false;var k=e.options.length;for(m=0;m<k;m++){if(e.options[m].selected){q+=d+e.name+"="+encodeURIComponent(e.options[m].value);p=true}}if(!p){q+=d+e.name+"="}break;default:break}}if(null!=this.arParams&&this.arParams.resize&&this.div_inner){var c=parseInt(this.div_inner.style.width);var a=parseInt(this.div_inner.style.height);if(c>0){q+="&bxpiwidth="+c}if(a>0){q+="&bxpiheight="+a}}return q};JCPopup.prototype.PostParameters=function(b){var c=this;jsExtLoader.onajaxfinish=window["JCPopup_AjaxPostAction"+this.suffix];ShowWaitWindow();var a=this.url;if(null!=b){index=a.indexOf("?");if(index==-1){a+="?"+b}else{a=a.substring(0,index)+"?"+b+"&"+a.substring(index+1)}}jsExtLoader.startPost(a,this.GetParameters())};JCPopup.prototype.AdjustShadow=function(){if(this.div){jsFloatDiv.AdjustShadow(this.div)}};JCPopup.prototype.HideShadow=function(){if(this.div){jsFloatDiv.HideShadow(this.div)}};JCPopup.prototype.UnhideShadow=function(){if(this.div){jsFloatDiv.UnhideShadow(this.div)}};JCPopup.prototype.DragPanel=function(a,c){var b=jsUtils.FindParentObject(c,"div");b.style.left=b.offsetLeft+"px";b.style.top=b.offsetTop+"px";jsFloatDiv.StartDrag(a,b)};JCPopup.prototype.createResizer=function(){this.diff_x=null;this.diff_y=null;this.arPos=jsUtils.GetRealPos(this.div);var a=parseInt(jsUtils.GetStyleValue(this.div,jsUtils.IsIE()?"zIndex":"z-index"))+1;this.obResizer=document.createElement("DIV");this.obResizer.className="bxresizer";this.obResizer.style.position="absolute";this.obResizer.style.zIndex=a;this.obResizer.onmousedown=window["JCPopup_startResize"+this.suffix];this.div.appendChild(this.obResizer)};JCPopup.prototype.startResize=function(c){if(!c){c=window.event}this.wndSize=jsUtils.GetWindowScrollPos();this.wndSize.innerWidth=jsUtils.GetWindowInnerSize().innerWidth;this.x=c.clientX+this.wndSize.scrollLeft;this.y=c.clientY+this.wndSize.scrollTop;this.obDescr=document.getElementById("bx_popup_description_container"+this.suffix);if(jsUtils.IsIE()){this.arPos=this.div.getBoundingClientRect();this.arPos={left:this.arPos.left+this.wndSize.scrollLeft,top:this.arPos.top+this.wndSize.scrollTop,right:this.arPos.right+this.wndSize.scrollLeft,bottom:this.arPos.bottom+this.wndSize.scrollTop};this.arPosInner=this.div_inner.getBoundingClientRect();this.arPosInner={left:this.arPosInner.left+this.wndSize.scrollLeft,top:this.arPosInner.top+this.wndSize.scrollTop,right:this.arPosInner.right+this.wndSize.scrollLeft,bottom:this.arPosInner.bottom+this.wndSize.scrollTop}}else{this.arPos=jsUtils.GetRealPos(this.div);this.arPosInner=jsUtils.GetRealPos(this.div_inner)}document.onmouseup=window["JCPopup_stopResize"+this.suffix];jsUtils.addEvent(document,"mousemove",window["JCPopup_doResize"+this.suffix]);if(document.body.setCapture){document.body.setCapture()}var a=document.body;a.ondrag=jsUtils.False;a.onselectstart=jsUtils.False;a.style.MozUserSelect=this.div.style.MozUserSelect="none";a.style.cursor=this.obResizer.style.cursor;this.HideShadow()};JCPopup.prototype.doResize=function(b){if(!b){b=window.event}var a=b.clientX+this.wndSize.scrollLeft;var c=b.clientY+this.wndSize.scrollTop;if(this.x==a&&this.y==c||a>this.wndSize.innerWidth+this.wndSize.scrollLeft-10){return}this.Resize(a,c);this.x=a;this.y=c};JCPopup.prototype.Resize=function(h,f){if(null==this.diff_x){this.diff_x=this.div.offsetWidth-this.div_inner.offsetWidth;this.diff_y=this.div.offsetHeight-this.div_inner.offsetHeight;if(this.arAdditionalResize.length>0){for(var e=0,d=this.arAdditionalResize.length;e<d;e++){if(null!=this.arAdditionalResize[e]){var j=jsUtils.IsOpera()?0:parseInt(jsUtils.GetStyleValue(this.arAdditionalResize[e],jsUtils.IsIE()?"borderLeftWidth":"border-left-width"))+parseInt(jsUtils.GetStyleValue(this.arAdditionalResize[e],jsUtils.IsIE()?"borderRightWidth":"border-right-width"));var g=jsUtils.IsOpera()||jsUtils.IsIE()?0:parseInt(jsUtils.GetStyleValue(this.arAdditionalResize[e],"border-top-width"))+parseInt(jsUtils.GetStyleValue(this.arAdditionalResize[e],"border-bottom-width"));this.arAdditionalResize[e].diff_x=this.div.offsetWidth-this.arAdditionalResize[e].offsetWidth+j;this.arAdditionalResize[e].diff_y=this.div.offsetHeight-this.arAdditionalResize[e].offsetHeight+g}}}}var c=h-this.arPos.left;var a=f-this.arPos.top;var n=c-this.div.offsetWidth;if(null!=this.obDescr){var b=this.obDescr.offsetHeight}var m=false;if(c>this.arParams.min_width){m=true;this.div.style.width=c+"px";this.div_inner.style.width=(c-this.diff_x)+"px"}if(null!=this.obDescr){var l=this.obDescr.offsetHeight-b}else{var l=0}this.diff_y+=l;var k=false;if(a>this.arParams.min_height){k=true;this.div_inner.style.height=(a-this.diff_y)+"px";this.div.style.height=a+"px"}if(this.arAdditionalResize.length>0){for(var e=0,d=this.arAdditionalResize.length;e<d;e++){if(null!=this.arAdditionalResize[e]){if(k){this.arAdditionalResize[e].style.height=(a-this.arAdditionalResize[e].diff_y)+"px"}if(m){this.arAdditionalResize[e].style.width=(c-this.arAdditionalResize[e].diff_x)+"px"}}}}if(jsUtils.IsIE()){this.AdjustShadow()}};JCPopup.prototype.stopResize=function(){if(document.body.releaseCapture){document.body.releaseCapture()}jsUtils.removeEvent(document,"mousemove",window["JCPopup_doResize"+this.suffix]);document.onmouseup=null;var a=document.body;a.ondrag=null;a.onselectstart=null;a.style.MozUserSelect=this.div.style.MozUserSelect="";a.style.cursor="";this.UnhideShadow();this.AdjustShadow();this.SavePosition()};JCPopup.prototype.SavePosition=function(){var c={width:parseInt(this.div.style.width),height:parseInt(this.div.style.height),iheight:parseInt(this.div_inner.style.height)};if(null!=this.error_dy){c.iheight+=this.error_dy}jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,"width",c.width);jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,"height",c.height);jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,"iheight",c.iheight);for(var b=0,a=this.arAdditionalResize.length;b<a;b++){if(null!=this.arAdditionalResize[b]&&null!=this.arAdditionalResize[b].BXResizeCacheID){jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,this.arAdditionalResize[b].BXResizeCacheID+"_height",parseInt(this.arAdditionalResize[b].style.height));jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,this.arAdditionalResize[b].BXResizeCacheID+"_width",parseInt(this.arAdditionalResize[b].style.width))}}this.__arRuntimeResize[this.check_url]=c};JCPopup.prototype.IncludePrepare=function(){var c=window.frames.editor;if(null==c){return false}var b=c.document.forms.inner_form;var a=document.forms[this.form_name];if(null==b||null==a){return false}a.include_data.value=b.filesrc_pub.value;return true};JCPopup.prototype.ShowError=function(b){CloseWaitWindow();this.AllowClose();this.obDescr=document.getElementById("bx_popup_description_container"+this.suffix);if(null!=this.obDescr){var a=this.obDescr.offsetHeight;var c=document.getElementById("bx_popup_description_error"+this.suffix);if(!c){c=document.createElement("P");c.id="bx_popup_description_error"+this.suffix;this.obDescr.firstChild.appendChild(c)}c.innerHTML='<font class="errortext">'+b+"</font>";if(this.obDescr.offsetHeight!=a){this.error_dy=this.obDescr.offsetHeight-a;if(this.div_inner){this.div_inner.style.height=(parseInt(jsUtils.GetStyleValue(this.div_inner,"height"))-this.error_dy)+"px"}}}else{alert(b)}};function JCComponentUtils(){}JCComponentUtils.prototype.ClearCache=function(a){CHttpRequest.Action=function(b){window.location=window.location.href};ShowWaitWindow();CHttpRequest.Send("/bitrix/admin/clear_component_cache.php?"+a)};JCComponentUtils.prototype.EnableComponent=function(a){CHttpRequest.Action=function(b){window.location=window.location.href};ShowWaitWindow();CHttpRequest.Send("/bitrix/admin/enable_component.php?"+a)};function COpacity(a){this.element=a;this.opacityProperty=this.GetOpacityProperty();this.startOpacity=null;this.finishOpacity=null;this.delay=30;this.currentOpacity=null;this.fadingTimeoutID=null}COpacity.prototype.SetElementOpacity=function(b){if(!this.opacityProperty){return false}if(this.opacityProperty=="filter"){b=b*100;var a=this.element.filters["DXImageTransform.Microsoft.alpha"]||this.element.filters.alpha;if(a){a.opacity=b}else{this.element.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")"}}else{this.element.style[this.opacityProperty]=b}return true};COpacity.prototype.GetOpacityProperty=function(){var a;if(typeof document.body.style.opacity=="string"){return"opacity"}else{if(typeof document.body.style.MozOpacity=="string"){return"MozOpacity"}else{if(typeof document.body.style.KhtmlOpacity=="string"){return"KhtmlOpacity"}else{if(document.body.filters&&(a=navigator.appVersion.match(/MSIE ([\d.]+)/))&&a[1]>=5.5){return"filter"}}}}return false};COpacity.prototype.Fading=function(b,a,d){if(!this.opacityProperty){return}this.startOpacity=b;this.finishOpacity=a;this.currentOpacity=this.startOpacity;if(this.fadingTimeoutID){clearInterval(this.fadingTimeoutID)}var c=this;this.fadingTimeoutID=setInterval(function(){c.Run(d)},this.delay)};COpacity.prototype.Run=function(a){this.currentOpacity=Math.round((this.currentOpacity+0.1*(this.finishOpacity-this.startOpacity>0?1:-1))*10)/10;this.SetElementOpacity(this.currentOpacity);if(this.currentOpacity==this.startOpacity||this.currentOpacity==this.finishOpacity){clearInterval(this.fadingTimeoutID);if(typeof(a)=="function"){a(this)}}};COpacity.prototype.Undo=function(){};var jsExtLoader={obContainer:null,obContainerInner:null,jsPopup_name:"jsPopup",url:"",httpRequest:null,httpRequest2:null,obTemporary:null,onajaxfinish:null,obFrame:null,start:function(a){this.url=a;this.obContainer=null;ShowWaitWindow();this.httpRequest=this._CreateHttpObject();this.httpRequest.onreadystatechange=jsExtLoader.stepOne;this.httpRequest.open("GET",this.url,true);this.httpRequest.send("")},startPost:function(a,b){this.url=a;this.obContainer=null;ShowWaitWindow();this.httpRequest=this._CreateHttpObject();this.httpRequest.onreadystatechange=jsExtLoader.stepOne;this.httpRequest.open("POST",this.url,true);this.httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.httpRequest.send(b)},post:function(a){var b=document.forms[a];if(null==b){return}if(null==this.obFrame){if(jsUtils.IsIE()){this.obFrame=document.createElement('<iframe src="javascript:void(0)" name="frame_'+a+'">')}else{this.obFrame=document.createElement("IFRAME");this.obFrame.name="frame_"+a;this.obFrame.src="javascript:void(0)"}this.obFrame.style.display="none";document.body.appendChild(this.obFrame)}b.target=this.obFrame.name;if(b.action.length<=0){b.action=this.url}window[jsExtLoader.jsPopup_name].DenyClose();ShowWaitWindow();b.save.click();if(false===b.BXReturnValue){window[jsExtLoader.jsPopup_name].AllowClose();CloseWaitWindow()}b.BXReturnValue=true},urlencode:function(a){return escape(a).replace(new RegExp("\\+","g"),"%2B")},__prepareOnload:function(){this.obTemporary=window.onload;window.onload=null},__runOnload:function(){if(window.onload){window.onload()}window.onload=this.obTemporary;this.obTemporary=null},stepOne:function(){if(jsExtLoader.httpRequest.readyState==4){var h=jsExtLoader.httpRequest.responseText;var e=[];var j;var i=new RegExp("<script([^>]*)>","i");var g=new RegExp("src=[\"']([^\"']+)[\"']","i");while((j=h.match(i))!==null){var f=h.search("<\/script>","i");if(f==-1){break}var a=j[1].indexOf("bxrunfirst")!="-1";var b;if((b=j[1].match(g))!==null){e[e.length]={bRunFirst:a,isInternal:false,JS:b[1]}}else{var d=j.index+j[0].length;var c=h.substr(d,f-d);if(false&&e.length>0&&e[e.length-1].isInternal&&e[e.length-1].bRunFirst==a){e[e.length-1].JS+="\r\n\r\n"+c}else{e[e.length]={bRunFirst:a,isInternal:true,JS:c}}}h=h.substr(0,j.index)+h.substr(f+9)}jsExtLoader.__prepareOnload();jsExtLoader.processResult(h,e);CloseWaitWindow();jsExtLoader.__runOnload()}},EvalGlobal:function(script){if(window.execScript){window.execScript(script,"javascript")}else{if(jsUtils.IsSafari()){window.setTimeout(script,0)}else{window.eval(script)}}},arLoadedScripts:[],__isScriptLoaded:function(b){for(var a=0;a<jsExtLoader.arLoadedScripts.length;a++){if(jsExtLoader.arLoadedScripts[a]==b){return true}}return false},EvalExternal:function(c){if(/\/bitrix\/js\/main\/public_tools.js$/i.test(c)){return}if(jsExtLoader.__isScriptLoaded(c)){return}jsExtLoader.arLoadedScripts.push(c);if(c.substring(0,8)!="/bitrix/"){c="/bitrix/admin/"+c}if(jsUtils.IsOpera()){if(null==this.httpRequest2){this.httpRequest2=this._CreateHttpObject()}var a=this.httpRequest2}else{var a=this.httpRequest}a.onreadystatechange=function(e){};a.open("GET",c,false);a.send("");var b=a.responseText;a=null;try{this.EvalGlobal(b)}catch(d){}},processResult:function(a,b){jsExtLoader.processScripts(b,true);if(null==jsExtLoader.obContainer){jsExtLoader.obContainer=jsExtLoader.onajaxfinish(a)}else{jsExtLoader.obContainer.innerHTML=a}jsExtLoader.processScripts(b,false)},processScripts:function(d,c){for(var a=0,b=d.length;a<b;a++){if(d[a].bRunFirst!=c){continue}if(d[a].isInternal){d[a].JS=d[a].JS.replace("<!--","");jsExtLoader.EvalGlobal(d[a].JS)}else{jsExtLoader.EvalExternal(d[a].JS)}}},_CreateHttpObject:function(){var b=null;if(window.XMLHttpRequest){try{b=new XMLHttpRequest()}catch(a){}}else{if(window.ActiveXObject){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}if(!b){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}}}}return b}};var jsAdminStyle={arCSS:{},bInited:false,httpRequest:null,Init:function(){var b=document.getElementsByTagName("LINK");if(b.length>0){for(var c=0;c<b.length;c++){if(b[c].href){var a=b[c].href;var d=a.indexOf("://");if(d!=-1){a=a.substr(a.indexOf("/",d+3))}b[c].bxajaxflag=false;this.arCSS[a]=b[c]}}}this.bInited=true},Load:function(a){if(!this.bInited){this.Init()}if(null!=this.arCSS[a]){this.arCSS[a].disabled=false;return}var d=document.createElement("STYLE");d.type="text/css";var b=document.getElementsByTagName("HEAD")[0];b.insertBefore(d,b.firstChild);if(jsUtils.IsIE()){d.styleSheet.addImport(a)}else{try{if(null==this.httpRequest){this.httpRequest=jsExtLoader._CreateHttpObject()}this.httpRequest.onreadystatechange=null;this.httpRequest.open("GET",a,false);this.httpRequest.send("");var c=this.httpRequest.responseText;var h=a.lastIndexOf("/");if(h!=-1){var g=a.substring(0,h);c=c.replace(/url\(([^\/\\].*?)\)/gi,"url("+g+"/$1)")}d.appendChild(document.createTextNode(c))}catch(f){}}},Unload:function(a){if(!this.bInited){this.Init()}if(null!=this.arCSS[a]){this.arCSS[a].disabled=true}},UnloadAll:function(){if(!this.bInited){this.Init()}else{for(var a in this.arCSS){if(this.arCSS[a].bxajaxflag){this.Unload(a)}}}}};if(![].pop){Array.prototype.pop=function(){if(this.length<=0){return false}var a=this[this.length-1];delete this[this.length-1];this.length--;return a};Array.prototype.shift=function(){if(this.length<=0){return false}var b=this.reverse();var a=b.pop();this.prototype=b.reverse();return a};Array.prototype.push=function(a){this[this.length]=a}}function jsWizard(){this.currentStep=null;this.firstStep=null;this.arSteps={};this.nextButtonID="btn_popup_next";this.prevButtonID="btn_popup_prev";this.finishButtonID="btn_popup_finish";this.arButtons={}}jsWizard.prototype.AddStep=function(d,a){var c=document.getElementById(d);if(!c){return}if(typeof(a)!="object"){a={}}this.arSteps[d]={element:c};for(var b in a){this.arSteps[d][b]=a[b]}if(this.firstStep===null){this.firstStep=d}};jsWizard.prototype.SetCurrentStep=function(a){this.currentStep=a};jsWizard.prototype.SetFirstStep=function(a){this.firstStep=a};jsWizard.prototype.SetNextButtonID=function(a){this.nextButtonID=a};jsWizard.prototype.SetPrevButtonID=function(a){this.prevButtonID=a};jsWizard.prototype.SetFinishButtonID=function(a){this.finishButtonID=a};jsWizard.prototype.SetCancelButtonID=function(a){this.cancelButtonID=a};jsWizard.prototype.SetButtonDisabled=function(a,b){if(this.arButtons[a]){this.arButtons[a].disabled=b}};jsWizard.prototype.IsStepExists=function(a){if(this.arSteps[a]){return true}else{return false}};jsWizard.prototype.Display=function(){if(this.firstStep===null){return}this.currentStep=this.firstStep;var d=this;var a={next:this.nextButtonID,prev:this.prevButtonID,finish:this.finishButtonID};for(var b in a){var c=document.getElementById(a[b]);if(c&&c.tagName=="INPUT"){c.buttonID=b;c.onclick=function(){d._OnButtonClick(this.buttonID)};this.arButtons[b]=c}else{this.arButtons[b]=null}}this._OnStepShow()};jsWizard.prototype._OnButtonClick=function(a){if(this.arSteps[this.currentStep]){var b=this.arSteps[this.currentStep]["on"+a];if(b&&typeof(b)=="function"){if(b(this)===false){return}}}if(!this.arSteps[this.currentStep]){if(!this.arSteps[this.firstStep]){return}this.currentStep=this.firstStep}else{if(this.arSteps[this.currentStep][a]){this.currentStep=this.arSteps[this.currentStep][a]}}this._OnStepShow()};jsWizard.prototype._OnStepShow=function(){for(var b in this.arSteps){this.arSteps[b].element.style.display=(b==this.currentStep?"":"none")}for(var a in this.arButtons){if(this.arButtons[a]){var b=this.arSteps[this.currentStep][a];this.arButtons[a].disabled=(b&&this.arSteps[b]?false:true)}}if(this.arSteps[this.currentStep]){var c=this.arSteps[this.currentStep]["onshow"];if(c&&typeof(c)=="function"){c(this)}}};var jsPopup=new JCPopup();var jsComponentUtils=new JCComponentUtils();