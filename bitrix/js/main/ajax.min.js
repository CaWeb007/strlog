function CAjaxThread(a){this.TID=a;this.httpRequest=this._CreateHttpObject();this.arAction=[]}CAjaxThread.prototype._CreateHttpObject=function(){var b=null;if(window.XMLHttpRequest){try{b=new XMLHttpRequest()}catch(a){}}else{if(window.ActiveXObject){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}if(!b){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}}}}return b};CAjaxThread.prototype.addAction=function(a){this.arAction.push(a)};CAjaxThread.prototype.clearActions=function(){this.arAction=[]};CAjaxThread.prototype.nextAction=function(){return this.arAction.shift()};CAjaxThread.prototype.Clear=function(){this.arAction=null;this.httpRequest=null};function CAjax(){this.arThreads={};this.obTemporary=null}CAjax.prototype._PrepareData=function(e,d){var c="";if(null!=e){for(var b in e){if(c.length>0){c+="&"}var a=jsAjaxUtil.urlencode(b);if(d){a=d+"["+a+"]"}if(typeof e[b]=="object"){c+=this._PrepareData(e[b],a)}else{c+=a+"="+jsAjaxUtil.urlencode(e[b])}}}return c};CAjax.prototype.GetThread=function(a){return this.arThreads[a]};CAjax.prototype.InitThread=function(){while(true){var a="TID"+Math.floor(Math.random()*1000000);if(!this.arThreads[a]){break}}this.arThreads[a]=new CAjaxThread(a);return a};CAjax.prototype.AddAction=function(b,a){if(this.arThreads[b]){this.arThreads[b].addAction(a)}};CAjax.prototype._OnDataReady=function(b,a){if(!this.arThreads[b]){return}while(obHandler=this.arThreads[b].nextAction()){obHandler(a)}};CAjax.prototype._Close=function(a){if(!this.arThreads[a]){return}this.arThreads[a].Clear();this.arThreads[a]=null};CAjax.prototype._SetHandler=function(b){var d=this;function a(f){if(!f){f=window.event}if(!f){return}if(f.keyCode==27){d._Close(b);jsEvent.removeEvent(document,"keypress",this)}}function c(){if(d.bCancelled){return}if(!d.arThreads[b]){return}if(!d.arThreads[b].httpRequest){return}if(d.arThreads[b].httpRequest.readyState==4){var f=d.arThreads[b].httpRequest.getResponseHeader("X-Bitrix-Ajax-Status");var e=(f=="Redirect");var g=d.arThreads[b].httpRequest.responseText;jsAjaxParser.mode="implode";g=jsAjaxParser.process(g);if(!e){d._OnDataReady(b,g)}d.__prepareOnload();if(jsAjaxParser.code.length>0){jsAjaxUtil.EvalPack(jsAjaxParser.code)}d.__runOnload();d._Close(b)}}this.arThreads[b].httpRequest.onreadystatechange=c;jsEvent.addEvent(document,"keypress",a)};CAjax.prototype.__prepareOnload=function(){this.obTemporary=window.onload;window.onload=null};CAjax.prototype.__runOnload=function(){if(window.onload){window.onload()}window.onload=this.obTemporary;this.obTemporary=null};CAjax.prototype.Send=function(b,a,d){if(!this.arThreads[b]){return}if(null!=d){var c=this._PrepareData(d)}else{var c=""}if(c.length>0){if(a.indexOf("?")==-1){a+="?"+c}else{a+="&"+c}}if(this.arThreads[b].httpRequest){this.arThreads[b].httpRequest.open("GET",a,true);this._SetHandler(b);return this.arThreads[b].httpRequest.send("")}};CAjax.prototype.Post=function(b,a,d){var c="";if(null!=d){c=this._PrepareData(d)}if(this.arThreads[b].httpRequest){this.arThreads[b].httpRequest.open("POST",a,true);this._SetHandler(b);this.arThreads[b].httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");return this.arThreads[b].httpRequest.send(c)}};function CAjaxForm(c,a,b){this.obForm=c;this.obHandler=a;this.obFrame=null;this.isFormProcessed=false;if(null==b){this.bFirst=false}else{this.bFirst=b}this.__tmpFormTarget="";this.obAJAXIndicator=null;this.currentBrowserDetected="";if(window.opera){this.currentBrowserDetected="Opera"}else{if(navigator.userAgent){if(navigator.userAgent.indexOf("MSIE")!=-1){this.currentBrowserDetected="IE"}else{if(navigator.userAgent.indexOf("Firefox")!=-1){this.currentBrowserDetected="Firefox"}}}}this.IsIE9=!!document.documentMode&&document.documentMode>=9}CAjaxForm.prototype.setProcessedFlag=function(a){if(null==a){a=true}else{a=a?true:false}this.obForm.bxAjaxProcessed=a;this.isFormProcessed=a};CAjaxForm.isFormProcessed=function(a){if(a.bxAjaxProcessed){return a.bxAjaxProcessed}else{return false}};CAjaxForm.prototype.process=function(){var c=this;function b(){if(!c.obFrame.contentWindow.document||c.obFrame.contentWindow.document.body.innerHTML.length==0){return}if(null!=c.obHandler){c.obHandler(c.obFrame.contentWindow.document.body.innerHTML)}if(c.obFrame.contentWindow.AJAX_runExternal){c.obFrame.contentWindow.AJAX_runExternal()}if(c.obFrame.contentWindow.AJAX_runGlobal){c.obFrame.contentWindow.AJAX_runGlobal()}if(c.bFirst){try{c.obForm.target=c.__tmpFormTarget;c.obAJAXIndicator.parentNode.removeChild(c.obAJAXIndicator);c.obForm.bxAjaxProcessed=false}catch(f){c.obForm=null}c.obAJAXIndicator=null;if(this.currentBrowserDetected!="IE"){jsEvent.removeAllEvents(c.obFrame)}var d=setTimeout("document.body.removeChild(document.getElementById('"+c.obFrame.id+"'));",100);c.obFrame=null;if(window.onFormLoaded){window.onFormLoaded();window.onFormLoaded=null}}}if(this.obForm.target&&this.obForm.target.substring(0,5)=="AJAX_"){return}if(this.currentBrowserDetected=="IE"){if(this.IsIE9){this.obAJAXIndicator=document.createElement("input");this.obAJAXIndicator.setAttribute("name","AJAX_CALL");this.obAJAXIndicator.setAttribute("type","hidden")}else{this.obAJAXIndicator=document.createElement('<input name="AJAX_CALL" type="hidden" />')}}else{this.obAJAXIndicator=document.createElement("INPUT");this.obAJAXIndicator.type="hidden";this.obAJAXIndicator.name="AJAX_CALL"}this.obAJAXIndicator.value="Y";this.obForm.appendChild(this.obAJAXIndicator);var a="AJAX_"+Math.round(Math.random()*100000);if(this.currentBrowserDetected=="IE"){if(this.IsIE9){this.obFrame=document.createElement("iframe");this.obFrame.setAttribute("name",a)}else{this.obFrame=document.createElement('<iframe name="'+a+'"></iframe>')}}else{this.obFrame=document.createElement("IFRAME")}this.obFrame.style.display="none";this.obFrame.src="javascript:''";this.obFrame.id=a;this.obFrame.name=a;document.body.appendChild(this.obFrame);this.__tmpFormTarget=this.obForm.target;this.obForm.target=a;if(this.currentBrowserDetected=="IE"){this.obFrame.attachEvent("onload",b)}else{jsEvent.addEvent(this.obFrame,"load",b)}this.setProcessedFlag()};var jsAjaxParser={code:[],mode:"implode",regexp:null,regexp_src:null,process:function(e){this.code=[];if(null==this.regexp){this.regexp=/(<script([^>]*)>)([\S\s]*?)(<\/script>)/i}do{var f=e.match(this.regexp);if(null==f){break}var h=f.index;var a=f[0].length;if(h>0){this.code.push({TYPE:"STRING",DATA:e.substring(0,h)})}if(typeof f[1]=="undefined"||f[1].indexOf("src=")==-1){var b=f[3];b=b.replace("<!--","");this.code.push({TYPE:"SCRIPT",DATA:b})}else{if(null==this.regexp_src){this.regexp_src=/src="([^"]*)?"/i}var g=this.regexp_src.exec(f[1]);if(null!=g&&g[1]){this.code.push({TYPE:"SCRIPT_EXT",DATA:g[1]})}}e=e.substring(h+a)}while(true);if(e.length>0){this.code.push({TYPE:"STRING",DATA:e})}if(this.mode=="implode"){e="";for(var d=0,c=this.code.length;d<c;d++){if(this.code[d].TYPE=="STRING"){e+=this.code[d].DATA}}return e}else{return this.code}}};var jsAjaxUtil={RemoveAllChild:function(a){try{while(a.childNodes.length>0){jsEvent.clearObject(a.childNodes[0]);a.removeChild(a.childNodes[0])}}catch(b){}},EvalGlobal:function(script){if(window.execScript){window.execScript(script,"javascript")}else{if(jsAjaxUtil.IsSafari()){window.setTimeout(script,0)}else{window.eval(script)}}},arLoadedScripts:[],__isScriptLoaded:function(b){for(var a=0;a<jsAjaxUtil.arLoadedScripts.length;a++){if(jsAjaxUtil.arLoadedScripts[a]==b){return true}}return false},EvalExternal:function(b){if(/\/bitrix\/js\/main\/ajax.js$/i.test(b)||/\/bitrix\/js\/main\/core\/core.js$/i.test(b)){return}if(jsAjaxUtil.__isScriptLoaded(b)){return}jsAjaxUtil.arLoadedScripts.push(b);var c=new CAjaxThread();c.httpRequest.open("GET",b,false);c.httpRequest.send("");var a=c.httpRequest.responseText;c.Clear();c=null;jsAjaxUtil.EvalGlobal(a)},EvalPack:function(c){for(var b=0,a=c.length;b<a;b++){if(c[b].TYPE=="SCRIPT_EXT"||c[b].TYPE=="SCRIPT_SRC"){jsAjaxUtil.EvalExternal(c[b].DATA)}else{if(c[b].TYPE=="SCRIPT"){jsAjaxUtil.EvalGlobal(c[b].DATA)}}}},urlencode:function(a){return escape(a).replace(new RegExp("\\+","g"),"%2B")},trim:function(b){var c,a;a=/^[ \r\n]+/g;c=b.replace(a,"");a=/[ \r\n]+$/g;c=c.replace(a,"");return c},GetWindowSize:function(){var a,e;if(self.innerHeight){a=self.innerWidth;e=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){a=document.documentElement.clientWidth;e=document.documentElement.clientHeight}else{if(document.body){a=document.body.clientWidth;e=document.body.clientHeight}}}var f,d;if(self.pageYOffset){f=self.pageXOffset;d=self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){f=document.documentElement.scrollLeft;d=document.documentElement.scrollTop}else{if(document.body){f=document.body.scrollLeft;d=document.body.scrollTop}}}var b,c;if((document.compatMode&&document.compatMode=="CSS1Compat")){b=document.documentElement.scrollWidth;c=document.documentElement.scrollHeight}else{if(document.body.scrollHeight>document.body.offsetHeight){c=document.body.scrollHeight}else{c=document.body.offsetHeight}if(document.body.scrollWidth>document.body.offsetWidth||(document.compatMode&&document.compatMode=="BackCompat")||(document.documentElement&&!document.documentElement.clientWidth)){b=document.body.scrollWidth}else{b=document.body.offsetWidth}}return{innerWidth:a,innerHeight:e,scrollLeft:f,scrollTop:d,scrollWidth:b,scrollHeight:c}},GetRealPos:function(d){if(d.getBoundingClientRect){var e=d.getBoundingClientRect();var f=jsAjaxUtil.GetWindowSize();var c={left:e.left+f.scrollLeft,top:e.top+f.scrollTop,right:e.right+f.scrollLeft,bottom:e.bottom+f.scrollTop};return c}if(!d||!d.offsetParent){return false}var b=Array();b.left=d.offsetLeft;b.top=d.offsetTop;var a=d.offsetParent;while(a&&a.tagName!="BODY"){b.left+=a.offsetLeft;b.top+=a.offsetTop;a=a.offsetParent}b.right=b.left+d.offsetWidth;b.bottom=b.top+d.offsetHeight;return b},IsIE:function(){return(document.attachEvent&&!jsAjaxUtil.IsOpera())},IsOpera:function(){return(navigator.userAgent.toLowerCase().indexOf("opera")!=-1)},IsSafari:function(){var a=navigator.userAgent.toLowerCase();return(/webkit/.test(a))},LoadData:function(b,a){if(!a){return}var c=jsAjax.InitThread();jsAjax.AddAction(c,a);jsAjax.Send(c,b);return c},PostData:function(b,d,a){if(!a){return}var c=jsAjax.InitThread();jsAjax.AddAction(c,a);jsAjax.Post(c,b,d);return c},__LoadDataToDiv:function(d,a,f,h){if(null==f){f=true}if(null==h){h=true}if(typeof a=="string"||typeof a=="object"&&a.constructor==String){var b=document.getElementById(a)}else{var b=a}if(!b){return}var g=Math.round(Math.random()*1000000);function c(i){if(!b){return}jsAjaxUtil.CloseLocalWaitWindow(g,b);if(f){jsAjaxUtil.RemoveAllChild(b);b.innerHTML=i}else{b.innerHTML+=i}}jsAjaxUtil.ShowLocalWaitWindow(g,b,h);var e=jsAjaxUtil.LoadData(d,c)},InsertDataToNode:function(b,a,c){if(null==c){c=true}jsAjaxUtil.__LoadDataToDiv(b,a,true,c)},AppendDataToNode:function(b,a,c){if(null==c){c=true}jsAjaxUtil.__LoadDataToDiv(b,a,false,c)},GetStyleValue:function(c,a){if(c.currentStyle){var b=c.currentStyle[a]}else{if(window.getComputedStyle){var b=document.defaultView.getComputedStyle(c,null).getPropertyValue(a)}}return b},ShowLocalWaitWindow:function(k,m,c){if(typeof m=="string"||typeof m=="object"&&m.constructor==String){var j=document.getElementById(m)}else{var j=m}if(j.getBoundingClientRect){var i=j.getBoundingClientRect();var l=jsAjaxUtil.GetWindowSize();var h={left:i.left+l.scrollLeft,top:i.top+l.scrollTop,right:i.right+l.scrollLeft,bottom:i.bottom+l.scrollTop}}else{var h=jsAjaxUtil.GetRealPos(j)}var f=j.id;if(!h){return}if(null==c){c=true}if(c){var g=document.body.appendChild(document.createElement("DIV"));g.id="waitshadow_"+f+"_"+k;g.className="waitwindowlocalshadow";g.style.top=(h.top-5)+"px";g.style.left=(h.left-5)+"px";g.style.height=(h.bottom-h.top+10)+"px";g.style.width=(h.right-h.left+10)+"px"}var d=document.body.appendChild(document.createElement("DIV"));d.id="wait_"+f+"_"+k;d.className="waitwindowlocal";var a=h.top+5;if(a<document.body.scrollTop){a=document.body.scrollTop+5}d.style.top=a+"px";d.style.left=(h.left+5)+"px";if(jsAjaxUtil.IsIE()){var b=document.createElement("IFRAME");b.src="javascript:''";b.id="waitframe_"+f+"_"+k;b.className="waitwindowlocal";b.style.width=d.offsetWidth+"px";b.style.height=d.offsetHeight+"px";b.style.left=d.style.left;b.style.top=d.style.top;document.body.appendChild(b)}function e(n){if(!n){n=window.event}if(!n){return}if(n.keyCode==27){jsAjaxUtil.CloseLocalWaitWindow(k,m);jsEvent.removeEvent(document,"keypress",e)}}jsEvent.addEvent(document,"keypress",e)},CloseLocalWaitWindow:function(d,b){if(typeof b=="string"||typeof b=="object"&&b.constructor==String){var c=document.getElementById(b)}else{var c=b}var g=c.id;var f=document.getElementById("waitshadow_"+g+"_"+d);if(f){document.body.removeChild(f)}var e=document.getElementById("waitframe_"+g+"_"+d);if(e){document.body.removeChild(e)}var a=document.getElementById("wait_"+g+"_"+d);if(a){document.body.removeChild(a)}},SendForm:function(d,a){if(typeof d=="string"||typeof d=="object"&&d.constructor==String){var c=document.getElementById(d)}else{var c=d}if(!c.name||c.name.length<=0){c.name="AJAXFORM_"+Math.floor(Math.random()*1000000)}var b=new CAjaxForm(c,a,true);b.process();return true},InsertFormDataToNode:function(b,a,c){if(null==c){c=true}return jsAjaxUtil.__LoadFormToDiv(b,a,true,c)},AppendFormDataToNode:function(b,a,c){if(null==c){c=true}return jsAjaxUtil.__LoadFormToDiv(b,a,false,c)},__LoadFormToDiv:function(e,a,d,f){if(null==d){d=true}if(null==f){f=true}if(typeof a=="string"||typeof a=="object"&&a.constructor==String){var b=document.getElementById(a)}else{var b=a}if(!b){return}function c(g){if(!b){return}if(d){jsAjaxUtil.RemoveAllChild(b);b.innerHTML=g}else{b.innerHTML+=g}jsAjaxUtil.CloseLocalWaitWindow(b.id,b)}jsAjaxUtil.ShowLocalWaitWindow(b.id,b,f);return jsAjaxUtil.SendForm(e,c)},UpdatePageData:function(a){if(a.TITLE){jsAjaxUtil.UpdatePageTitle(a.TITLE)}if(a.NAV_CHAIN){jsAjaxUtil.UpdatePageNavChain(a.NAV_CHAIN)}if(a.CSS&&a.CSS.length>0){jsAjaxUtil.UpdatePageCSS(a.CSS)}if(a.SCRIPTS&&a.SCRIPTS.length>0){jsAjaxUtil.UpdatePageScripts(a.SCRIPTS)}},UpdatePageScripts:function(b){for(var a=0;a<b.length;a++){jsAjaxUtil.EvalExternal(b[a])}},UpdatePageCSS:function(b){jsStyle.UnloadAll();for(var a=0;a<b.length;a++){jsStyle.Load(b[a])}},UpdatePageTitle:function(b){var a=document.getElementById("pagetitle");if(a){a.removeChild(a.firstChild);if(!a.firstChild){a.appendChild(document.createTextNode(b))}else{a.insertBefore(document.createTextNode(b),a.firstChild)}}document.title=b},UpdatePageNavChain:function(a){var b=document.getElementById("navigation");if(b){b.innerHTML=a}},ScrollToNode:function(a){if(typeof a=="string"||typeof a=="object"&&a.constructor==String){var c=document.getElementById(a)}else{var c=a}if(c.scrollIntoView){c.scrollIntoView(true)}else{var b=jsAjaxUtil.GetRealPos(c);window.scrollTo(b.left,b.top)}}};var jsStyle={arCSS:{},bInited:false,Init:function(){var b=document.getElementsByTagName("LINK");if(b.length>0){for(var c=0;c<b.length;c++){if(b[c].href){var a=b[c].href;var d=a.indexOf("://");if(d!=-1){a=a.substr(a.indexOf("/",d+3))}b[c].bxajaxflag=false;this.arCSS[a]=b[c]}}}this.bInited=true},Load:function(a){if(!this.bInited){this.Init()}if(null!=this.arCSS[a]){this.arCSS[a].disabled=false;return}var d=document.createElement("STYLE");d.type="text/css";var b=document.getElementsByTagName("HEAD")[0];b.insertBefore(d,b.firstChild);if(jsAjaxUtil.IsIE()){d.styleSheet.addImport(a)}else{var f=new CAjaxThread();f.httpRequest.onreadystatechange=null;f.httpRequest.open("GET",a,false);f.httpRequest.send("");var c=f.httpRequest.responseText;var g=a.lastIndexOf("/");if(g!=-1){var e=a.substring(0,g);c=c.replace(/url\(([^\/\\].*?)\)/gi,"url("+e+"/$1)")}f.Clear();f=null;d.appendChild(document.createTextNode(c))}},Unload:function(a){if(!this.bInited){this.Init()}if(null!=this.arCSS[a]){this.arCSS[a].disabled=true}},UnloadAll:function(){if(!this.bInited){this.Init()}else{for(var a in this.arCSS){if(this.arCSS[a].bxajaxflag){this.Unload(a)}}}}};var jsEvent={objectList:[null],objectEventList:[null],__eventManager:function(f){if(!f){f=window.event}var b=true;try{if(f.srcElement){f.currentTarget=f.srcElement}}catch(f){}if(this.bxEventIndex&&jsEvent.objectEventList[this.bxEventIndex]&&jsEvent.objectEventList[this.bxEventIndex][f.type]){var a=jsEvent.objectEventList[this.bxEventIndex][f.type].length;for(var c=0;c<a;c++){if(jsEvent.objectEventList[this.bxEventIndex][f.type]&&jsEvent.objectEventList[this.bxEventIndex][f.type][c]){var d=jsEvent.objectEventList[this.bxEventIndex][f.type][c](f);if("boolean"==typeof d){b=b&&d}if(!b){return false}}}}return true},addEvent:function(c,b,a){if(!c.bxEventIndex){c.bxEventIndex=jsEvent.objectList.length;jsEvent.objectList[c.bxEventIndex]=c}if(!jsEvent.objectEventList[c.bxEventIndex]){jsEvent.objectEventList[c.bxEventIndex]={}}if(!jsEvent.objectEventList[c.bxEventIndex][b]){jsEvent.objectEventList[c.bxEventIndex][b]=[];if(c["on"+b]){jsEvent.objectEventList[c.bxEventIndex][b].push(c["on"+b])}c["on"+b]=null;c["on"+b]=jsEvent.__eventManager}jsEvent.objectEventList[c.bxEventIndex][b].push(a)},removeEvent:function(d,c,a){if(d.bxEventIndex){if(jsEvent.objectEventList[d.bxEventIndex][c]){for(var b=0;b<jsEvent.objectEventList[d.bxEventIndex][c].length;b++){if(a==jsEvent.objectEventList[d.bxEventIndex][c][b]){delete jsEvent.objectEventList[d.bxEventIndex][c][b];return}}}}},removeAllHandlers:function(b,a){if(b.bxEventIndex){if(jsEvent.objectEventList[b.bxEventIndex][a]){jsEvent.objectEventList[b.bxEventIndex][a]=[]}}},removeAllEvents:function(a){if(a.bxEventIndex){if(jsEvent.objectEventList[a.bxEventIndex]){jsEvent.objectEventList[a.bxEventIndex]=[]}}},clearObject:function(a){if(a.bxEventIndex){if(jsEvent.objectEventList[a.bxEventIndex]){delete jsEvent.objectEventList[a.bxEventIndex]}if(jsEvent.objectList[a.bxEventIndex]){delete jsEvent.objectList[a.bxEventIndex]}delete a.bxEventIndex}}};var jsAjaxHistory={expected_hash:"",counter:0,bInited:false,obFrame:null,obImage:null,bHashCollision:false,obTimer:null,__hide_object:function(a){a.style.position="absolute";a.style.top="-1000px";a.style.left="-1000px";a.style.height="10px";a.style.width="10px"},init:function(a){if(jsAjaxHistory.bInited){return}jsAjaxHistory.expected_hash=window.location.hash;if(!jsAjaxHistory.expected_hash||jsAjaxHistory.expected_hash=="#"){jsAjaxHistory.expected_hash="__bx_no_hash__"}var b={node:a,title:window.document.title,data:document.getElementById(a).innerHTML};var c=document.getElementById("navigation");if(null!=c){b.nav_chain=c.innerHTML}jsAjaxHistoryContainer.put(jsAjaxHistory.expected_hash,b);jsAjaxHistory.obTimer=setTimeout(jsAjaxHistory.__hashListener,500);if(jsAjaxUtil.IsIE()){jsAjaxHistory.obFrame=document.createElement("IFRAME");jsAjaxHistory.__hide_object(jsAjaxHistory.obFrame);document.body.appendChild(jsAjaxHistory.obFrame);jsAjaxHistory.obFrame.contentWindow.document.open();jsAjaxHistory.obFrame.contentWindow.document.write(jsAjaxHistory.expected_hash);jsAjaxHistory.obFrame.contentWindow.document.close();jsAjaxHistory.obFrame.contentWindow.document.title=window.document.title}else{if(jsAjaxUtil.IsOpera()){jsAjaxHistory.obImage=document.createElement("IMG");jsAjaxHistory.__hide_object(jsAjaxHistory.obImage);document.body.appendChild(jsAjaxHistory.obImage);jsAjaxHistory.obImage.setAttribute("src","javascript:location.href = 'javascript:jsAjaxHistory.__hashListener();';")}}jsAjaxHistory.bInited=true},__hashListener:function(){if(jsAjaxHistory.obTimer){window.clearTimeout(jsAjaxHistory.obTimer);jsAjaxHistory.obTimer=null}if(null!=jsAjaxHistory.obFrame){var c=jsAjaxHistory.obFrame.contentWindow.document.body.innerText}else{var c=window.location.hash}if(!c||c=="#"){c="__bx_no_hash__"}if(c.indexOf("#")==0){c=c.substring(1)}if(c!=jsAjaxHistory.expected_hash){var b=jsAjaxHistoryContainer.get(c);if(b){document.getElementById(b.node).innerHTML=b.data;jsAjaxUtil.UpdatePageTitle(b.title);if(b.nav_chain){jsAjaxUtil.UpdatePageNavChain(b.nav_chain)}jsAjaxHistory.expected_hash=c;if(null!=jsAjaxHistory.obFrame){var a=c=="__bx_no_hash__"?"":c;if(window.location.hash!=a&&window.location.hash!="#"+a){window.location.hash=a}}}}jsAjaxHistory.obTimer=setTimeout(jsAjaxHistory.__hashListener,500)},put:function(b,a){var c={node:b,title:window.document.title,data:document.getElementById(b).innerHTML};var d=document.getElementById("navigation");if(d){c.nav_chain=d.innerHTML}jsAjaxHistoryContainer.put(a,c);jsAjaxHistory.expected_hash=a;window.location.hash=jsAjaxUtil.urlencode(a);if(null!=jsAjaxHistory.obFrame){jsAjaxHistory.obFrame.contentWindow.document.open();jsAjaxHistory.obFrame.contentWindow.document.write(a);jsAjaxHistory.obFrame.contentWindow.document.close();jsAjaxHistory.obFrame.contentWindow.document.title=c.title}},checkRedirectStart:function(a,c){var b=window.location.hash;if(b.substring(0,1)=="#"){b=b.substring(1)}if(b.substring(0,5)=="view/"){jsAjaxHistory.bHashCollision=true;document.write('<div id="__ajax_hash_collision_'+c+'" style="display: none;">')}},checkRedirectFinish:function(a,c){document.write("</div>");var b=window.location.hash;if(b.substring(0,1)=="#"){b=b.substring(1)}jsEvent.addEvent(window,"load",function(){if(b.substring(0,5)=="view/"){var e=document.getElementById("__ajax_hash_collision_"+c);var f=e.firstChild;jsAjaxUtil.RemoveAllChild(f);e.style.display="block";if(!jsAjaxUtil.IsIE()&&!jsAjaxUtil.IsOpera()&&!jsAjaxUtil.IsSafari()){b=jsAjaxHistory.urlencode(b)}b+=(b.indexOf("%3F")==-1?"%3F":"%26")+a+"="+c;var d="/bitrix/tools/ajax_redirector.php?hash="+b;jsAjaxUtil.InsertDataToNode(d,f,false)}})},urlencode:function(a){if(window.encodeURIComponent){return encodeURIComponent(a)}else{if(window.encodeURI){return encodeURI(a)}else{return jsAjaxUtil.urlencode(a)}}}};var jsAjaxHistoryContainer={arHistory:{},put:function(b,a){this.arHistory[b]=a},get:function(a){return this.arHistory[a]}};if(![].pop){Array.prototype.pop=function(){if(this.length<=0){return false}var a=this[this.length-1];delete this[this.length-1];this.length--;return a};Array.prototype.shift=function(){if(this.length<=0){return false}var b=this.reverse();var a=b.pop();this.prototype=b.reverse();return a};Array.prototype.push=function(a){this[this.length]=a}}var jsAjax=new CAjax();