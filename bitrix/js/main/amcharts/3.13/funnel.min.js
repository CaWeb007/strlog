AmCharts.AmFunnelChart=AmCharts.Class({inherits:AmCharts.AmSlicedChart,construct:function(a){this.type="funnel";AmCharts.AmFunnelChart.base.construct.call(this,a);this.cname="AmFunnelChart";this.startX=this.startY=0;this.baseWidth="100%";this.neckHeight=this.neckWidth=0;this.rotate=!1;this.valueRepresents="height";this.pullDistance=30;this.labelPosition="center";this.labelText="[[title]]: [[value]]";this.balloonText="[[title]]: [[value]]\n[[description]]";AmCharts.applyTheme(this,a,this.cname)},drawChart:function(){AmCharts.AmFunnelChart.base.drawChart.call(this);var ah=this.chartData;if(AmCharts.ifArray(ah)){if(0<this.realWidth&&0<this.realHeight){var ak=Math.round(this.depth3D*Math.cos(this.angle*Math.PI/180)),ae=Math.round(-this.depth3D*Math.sin(this.angle*Math.PI/180)),am=this.container,al=this.startDuration,aj=this.rotate,ad=this.updateWidth();this.realWidth=ad;var M=this.updateHeight();this.realHeight=M;var ai=AmCharts.toCoordinate,ac=ai(this.marginLeft,ad),ab=ai(this.marginRight,ad),an=ai(this.marginTop,M)+this.getTitleHeight(),ai=ai(this.marginBottom,M);0<ak&&0>ae&&(this.neckHeight=this.neckWidth=0,aj?ai-=ae/2:an-=ae/2);var ab=ad-ac-ab,Z=AmCharts.toCoordinate(this.baseWidth,ab),K=AmCharts.toCoordinate(this.neckWidth,ab),V=M-ai-an,U=AmCharts.toCoordinate(this.neckHeight,V),s=an+V-U;aj&&(an=M-ai,s=an-V+U);this.firstSliceY=an;AmCharts.VML&&(this.startAlpha=1);for(var j=ab/2+ac,S=(V-U)/((Z-K)/2),aa=1,Y=Z/2,Z=(V-U)*(Z+K)/2+K*U,Q=an,i=0,U=0;U<ah.length;U++){var ag=ah[U],X;if(!0!==ag.hidden){var R=[],O=[],af;if("height"==this.valueRepresents){af=V*ag.percents/100}else{var W=-Z*ag.percents/100/2,o=Y;X=-1/(2*S);af=Math.pow(o,2)-4*X*W;0>af&&(af=0);af=(Math.sqrt(af)-o)/(2*X);if(!aj&&an>=s||aj&&an<=s){af=2*-W/K}else{if(!aj&&an+af>s||aj&&an-af<s){X=aj?Math.round(af+(an-af-s)):Math.round(af-(an+af-s)),af=X/S,af=X+2*(-W-(o-af/2)*X)/K}}}W=Y-af/S;o=!1;!aj&&an+af>s||aj&&an-af<s?(W=K/2,R.push(j-Y,j+Y,j+W,j+W,j-W,j-W),aj?(X=af+(an-af-s),an<s&&(X=0),O.push(an,an,an-X,an-af,an-af,an-X,an)):(X=af-(an+af-s),an>s&&(X=0),O.push(an,an,an+X,an+af,an+af,an+X,an)),o=!0):(R.push(j-Y,j+Y,j+W,j-W),aj?O.push(an,an,an-af,an-af):O.push(an,an,an+af,an+af));am.set();X=am.set();0<ak&&0>ae?(O=W/Y,R=-1,aj||(R=1),isNaN(aa)&&(aa=0),R=(new AmCharts.Cuboid(am,2*Y,R*af,ak,ae*aa,ag.color,ag.alpha,this.outlineThickness,this.outlineColor,this.outlineAlpha,90,0,!1,0,ag.pattern,O)).set,R.translate(j-Y,an-ae/2*aa),aa*=O):R=AmCharts.polygon(am,R,O,ag.color,ag.alpha,this.outlineThickness,this.outlineColor,this.outlineAlpha);AmCharts.setCN(this,X,"funnel-item");AmCharts.setCN(this,R,"funnel-slice");AmCharts.setCN(this,X,ag.className,!0);X.push(R);this.graphsSet.push(X);aj||X.toBack();ag.wedge=X;ag.index=U;if(O=this.gradientRatio){var P=[],T;for(T=0;T<O.length;T++){P.push(AmCharts.adjustLuminosity(ag.color,O[T]))}0<P.length&&R.gradient("linearGradient",P);ag.pattern&&R.pattern(ag.pattern)}0<al&&(this.chartCreated||X.setAttr("opacity",this.startAlpha));this.addEventListeners(X,ag);ag.ty0=an-af/2;if(this.labelsEnabled&&this.labelText&&ag.percents>=this.hideLabelsPercent){P=this.formatString(this.labelText,ag);(R=this.labelFunction)&&(P=R(ag,P));T=ag.labelColor;T||(T=this.color);var O=this.labelPosition,N="left";"center"==O&&(N="middle");"left"==O&&(N="right");R=void 0;""!=P&&(R=AmCharts.wrappedText(am,P,T,this.fontFamily,this.fontSize,N,!1,this.maxLabelWidth),AmCharts.setCN(this,R,"funnel-label"),AmCharts.setCN(this,R,ag.className,!0),R.node.style.pointerEvents="none",X.push(R),P=j,aj?(T=an-af/2,ag.ty0=T):(T=an+af/2,ag.ty0=T,T<Q+i+5&&(T=Q+i+5),T>M-ai&&(T=M-ai)),"right"==O&&(P=ab+10+ac,ag.tx0=j+(Y-af/2/S),o&&(ag.tx0=j+W)),"left"==O&&(ag.tx0=j-(Y-af/2/S),o&&(ag.tx0=j-W),P=ac),ag.label=R,ag.labelX=P,ag.labelY=T,ag.labelHeight=R.getBBox().height,R.translate(P,T),Y=R.getBBox(),Q=AmCharts.rect(am,Y.width+5,Y.height+5,"#ffffff",0.005),Q.translate(P+Y.x,T+Y.y),X.push(Q),ag.hitRect=Q,i=R.getBBox().height,Q=T)}(0===ag.alpha||0<al&&!this.chartCreated)&&X.hide();an=aj?an-af:an+af;Y=W;ag.startX=AmCharts.toCoordinate(this.startX,ad);ag.startY=AmCharts.toCoordinate(this.startY,M);ag.pullX=AmCharts.toCoordinate(this.pullDistance,ad);ag.pullY=0;ag.balloonX=j;ag.balloonY=ag.ty0}}this.arrangeLabels();this.initialStart();(ah=this.legend)&&ah.invalidateSize()}else{this.cleanChart()}}this.dispDUpd();this.chartCreated=!0},arrangeLabels:function(){var q=this.rotate,t;t=q?0:this.realHeight;for(var o=0,v=this.chartData,u=v.length,s,k=0;k<u;k++){s=v[u-k-1];var y=s.label,r=s.labelY,j=s.labelX,i=s.labelHeight,w=r;q?t+o+5>r&&(w=t+o+5):r+i+5>t&&(w=t-5-i);t=w;o=i;if(y){y.translate(j,w);var h=y.getBBox()}s.hitRect&&s.hitRect.translate(j+h.x,w+h.y);s.labelY=w;s.tx=j;s.ty=w;s.tx2=j}"center"!=this.labelPosition&&this.drawTicks()}});AmCharts.Cuboid=AmCharts.Class({construct:function(r,u,q,z,v,t,o,C,s,k,j,A,i,F,h,G,w){this.set=r.set();this.container=r;this.h=Math.round(q);this.w=Math.round(u);this.dx=z;this.dy=v;this.colors=t;this.alpha=o;this.bwidth=C;this.bcolor=s;this.balpha=k;this.dashLength=F;this.topRadius=G;this.pattern=h;this.rotate=i;this.bcn=w;i?0>u&&0===j&&(j=180):0>q&&270==j&&(j=90);this.gradientRotation=j;0===z&&0===v&&(this.cornerRadius=A);this.draw()},draw:function(){var ar=this.set;ar.clear();var av=this.container,ao=av.chart,ax=this.w,aw=this.h,au=this.dx,an=this.dy,ae=this.colors,at=this.alpha,am=this.bwidth,al=this.bcolor,ay=this.balpha,aa=this.gradientRotation,T=this.cornerRadius,Y=this.dashLength,X=this.pattern,ad=this.topRadius,ac=this.bcn,W=ae,ab=ae;"object"==typeof ae&&(W=ae[0],ab=ae[ae.length-1]);var ak,V,Q,aq,aj,ah,af,ap,Z,S=at;X&&(at=0);var ag,ai,U,R,s=this.rotate;if(0<Math.abs(au)||0<Math.abs(an)){if(isNaN(ad)){af=ab,ab=AmCharts.adjustLuminosity(W,-0.2),ab=AmCharts.adjustLuminosity(W,-0.2),ak=AmCharts.polygon(av,[0,au,ax+au,ax,0],[0,an,an,0,0],ab,at,1,al,0,aa),0<ay&&(Z=AmCharts.line(av,[0,au,ax+au],[0,an,an],al,ay,am,Y)),V=AmCharts.polygon(av,[0,0,ax,ax,0],[0,aw,aw,0,0],ab,at,1,al,0,aa),V.translate(au,an),0<ay&&(Q=AmCharts.line(av,[au,au],[an,an+aw],al,ay,am,Y)),aq=AmCharts.polygon(av,[0,0,au,au,0],[0,aw,aw+an,an,0],ab,at,1,al,0,aa),aj=AmCharts.polygon(av,[ax,ax,ax+au,ax+au,ax],[0,aw,aw+an,an,0],ab,at,1,al,0,aa),0<ay&&(ah=AmCharts.line(av,[ax,ax+au,ax+au,ax],[0,an,aw+an,aw],al,ay,am,Y)),ab=AmCharts.adjustLuminosity(af,0.2),af=AmCharts.polygon(av,[0,au,ax+au,ax,0],[aw,aw+an,aw+an,aw,aw],ab,at,1,al,0,aa),0<ay&&(ap=AmCharts.line(av,[0,au,ax+au],[aw,aw+an,aw+an],al,ay,am,Y))}else{var o,j,i;s?(o=aw/2,ab=au/2,i=aw/2,j=ax+au/2,ai=Math.abs(aw/2),ag=Math.abs(au/2)):(ab=ax/2,o=an/2,j=ax/2,i=aw+an/2+1,ag=Math.abs(ax/2),ai=Math.abs(an/2));U=ag*ad;R=ai*ad;0.1<ag&&0.1<ag&&(ak=AmCharts.circle(av,ag,W,at,am,al,ay,!1,ai),ak.translate(ab,o));0.1<U&&0.1<U&&(af=AmCharts.circle(av,U,AmCharts.adjustLuminosity(W,0.5),at,am,al,ay,!1,R),af.translate(j,i))}}at=S;1>Math.abs(aw)&&(aw=0);1>Math.abs(ax)&&(ax=0);!isNaN(ad)&&(0<Math.abs(au)||0<Math.abs(an))?(ae=[W],ae={fill:ae,stroke:al,"stroke-width":am,"stroke-opacity":ay,"fill-opacity":at},s?(at="M0,0 L"+ax+","+(aw/2-aw/2*ad),am=" B",0<ax&&(am=" A"),AmCharts.VML?(at+=am+Math.round(ax-U)+","+Math.round(aw/2-R)+","+Math.round(ax+U)+","+Math.round(aw/2+R)+","+ax+",0,"+ax+","+aw,at=at+(" L0,"+aw)+(am+Math.round(-ag)+","+Math.round(aw/2-ai)+","+Math.round(ag)+","+Math.round(aw/2+ai)+",0,"+aw+",0,0")):(at+="A"+U+","+R+",0,0,0,"+ax+","+(aw-aw/2*(1-ad))+"L0,"+aw,at+="A"+ag+","+ai+",0,0,1,0,0"),ag=90):(am=ax/2-ax/2*ad,at="M0,0 L"+am+","+aw,AmCharts.VML?(at="M0,0 L"+am+","+aw,am=" B",0>aw&&(am=" A"),at+=am+Math.round(ax/2-U)+","+Math.round(aw-R)+","+Math.round(ax/2+U)+","+Math.round(aw+R)+",0,"+aw+","+ax+","+aw,at+=" L"+ax+",0",at+=am+Math.round(ax/2+ag)+","+Math.round(ai)+","+Math.round(ax/2-ag)+","+Math.round(-ai)+","+ax+",0,0,0"):(at+="A"+U+","+R+",0,0,0,"+(ax-ax/2*(1-ad))+","+aw+"L"+ax+",0",at+="A"+ag+","+ai+",0,0,1,0,0"),ag=180),av=av.path(at).attr(ae),av.gradient("linearGradient",[W,AmCharts.adjustLuminosity(W,-0.3),AmCharts.adjustLuminosity(W,-0.3),W],ag),s?av.translate(au/2,0):av.translate(0,an/2)):av=0===aw?AmCharts.line(av,[0,ax],[0,0],al,ay,am,Y):0===ax?AmCharts.line(av,[0,0],[0,aw],al,ay,am,Y):0<T?AmCharts.rect(av,ax,aw,ae,at,am,al,ay,T,aa,Y):AmCharts.polygon(av,[0,0,ax,ax,0],[0,aw,aw,0,0],ae,at,am,al,ay,aa,!1,Y);ax=isNaN(ad)?0>aw?[ak,Z,V,Q,aq,aj,ah,af,ap,av]:[af,ap,V,Q,aq,aj,ak,Z,ah,av]:s?0<ax?[ak,av,af]:[af,av,ak]:0>aw?[ak,av,af]:[af,av,ak];AmCharts.setCN(ao,av,ac+"front");AmCharts.setCN(ao,V,ac+"back");AmCharts.setCN(ao,af,ac+"top");AmCharts.setCN(ao,ak,ac+"bottom");AmCharts.setCN(ao,aq,ac+"left");AmCharts.setCN(ao,aj,ac+"right");for(ak=0;ak<ax.length;ak++){if(V=ax[ak]){ar.push(V),AmCharts.setCN(ao,V,ac+"element")}}X&&av.pattern(X)},width:function(a){isNaN(a)&&(a=0);this.w=Math.round(a);this.draw()},height:function(a){isNaN(a)&&(a=0);this.h=Math.round(a);this.draw()},animateHeight:function(b,c){var a=this;a.easing=c;a.totalFrames=Math.round(1000*b/AmCharts.updateRate);a.rh=a.h;a.frame=0;a.height(1);setTimeout(function(){a.updateHeight.call(a)},AmCharts.updateRate)},updateHeight:function(){var a=this;a.frame++;var b=a.totalFrames;a.frame<=b&&(b=a.easing(0,a.frame,1,a.rh-1,b),a.height(b),setTimeout(function(){a.updateHeight.call(a)},AmCharts.updateRate))},animateWidth:function(b,c){var a=this;a.easing=c;a.totalFrames=Math.round(1000*b/AmCharts.updateRate);a.rw=a.w;a.frame=0;a.width(1);setTimeout(function(){a.updateWidth.call(a)},AmCharts.updateRate)},updateWidth:function(){var a=this;a.frame++;var b=a.totalFrames;a.frame<=b&&(b=a.easing(0,a.frame,1,a.rw-1,b),a.width(b),setTimeout(function(){a.updateWidth.call(a)},AmCharts.updateRate))}});