if(!AmCharts.translations["export"]){AmCharts.translations["export"]={}}if(!AmCharts.translations["export"]["en"]){AmCharts.translations["export"]["en"]={"fallback.save.text":"CTRL + C to copy the data into the clipboard.","fallback.save.image":"Rightclick -> Save picture as... to save the image.","capturing.delayed.menu.label":"{{duration}}","capturing.delayed.menu.title":"Click to cancel","menu.label.print":"Print","menu.label.undo":"Undo","menu.label.redo":"Redo","menu.label.cancel":"Cancel","menu.label.save.image":"Download as ...","menu.label.save.data":"Save as ...","menu.label.draw":"Annotate ...","menu.label.draw.change":"Change ...","menu.label.draw.add":"Add ...","menu.label.draw.shapes":"Shape ...","menu.label.draw.colors":"Color ...","menu.label.draw.widths":"Size ...","menu.label.draw.opacities":"Opacity ...","menu.label.draw.text":"Text","menu.label.draw.modes":"Mode ...","menu.label.draw.modes.pencil":"Pencil","menu.label.draw.modes.line":"Line","menu.label.draw.modes.arrow":"Arrow","label.saved.from":"Saved from: "}}(function(){AmCharts["export"]=function(c,a){var b;var d={name:"export",version:"1.4.66",libs:{async:true,autoLoad:true,reload:false,resources:["fabric.js/fabric.min.js","FileSaver.js/FileSaver.min.js",{"jszip/jszip.min.js":["xlsx/xlsx.min.js"],"pdfmake/pdfmake.min.js":["pdfmake/vfs_fonts.js"]}],namespaces:{"pdfmake.min.js":"pdfMake","jszip.min.js":"JSZip","xlsx.min.js":"XLSX","fabric.min.js":"fabric","FileSaver.min.js":"saveAs"},loadTimeout:10000},config:{},setup:{chart:c,hasBlob:false,wrapper:false,isIE:!!window.document.documentMode,IEversion:window.document.documentMode,hasTouch:typeof window.Touch=="object",focusedMenuItem:undefined},drawing:{enabled:false,undos:[],redos:[],buffer:{position:{x1:0,y1:0,x2:0,y2:0,xD:0,yD:0}},handler:{undo:function(f,e){var g=d.drawing.undos.pop();if(g){g.selectable=true;d.drawing.redos.push(g);if(g.action=="added"){d.setup.fabric.remove(g.target)}var h=JSON.parse(g.state);g.target.set(h);if(g.target instanceof fabric.Group){d.drawing.handler.change({color:h.cfg.color,width:h.cfg.width,opacity:h.cfg.opacity},true,g.target)}d.setup.fabric.renderAll();if(g.state==g.target.recentState&&!e){d.drawing.handler.undo(g,true)}}},redo:function(f,e){var g=d.drawing.redos.pop();if(g){g.selectable=true;d.drawing.undos.push(g);if(g.action=="added"){d.setup.fabric.add(g.target)}var h=JSON.parse(g.state);g.target.recentState=g.state;g.target.set(h);if(g.target instanceof fabric.Group){d.drawing.handler.change({color:h.cfg.color,width:h.cfg.width,opacity:h.cfg.opacity},true,g.target)}d.setup.fabric.renderAll();if(g.action=="addified"){d.drawing.handler.redo()}}},done:function(e){d.drawing.enabled=false;d.drawing.buffer.enabled=false;d.drawing.undos=[];d.drawing.redos=[];d.createMenu(d.config.menu);d.setup.fabric.deactivateAll();if(d.setup.wrapper){d.setup.chart.containerDiv.removeChild(d.setup.wrapper);d.setup.wrapper=false}},add:function(f){var e=d.deepMerge({top:d.setup.fabric.height/2,left:d.setup.fabric.width/2},f||{});var g=e.url.indexOf(".svg")!=-1?fabric.loadSVGFromURL:fabric.Image.fromURL;g(e.url,function(j,h){var k=h!==undefined?fabric.util.groupSVGElements(j,h):j;var i=false;if(k.height>d.setup.fabric.height||k.width>d.setup.fabric.width){i=(d.setup.fabric.height/2)/k.height}if(e.top>d.setup.fabric.height){e.top=d.setup.fabric.height/2}if(e.left>d.setup.fabric.width){e.left=d.setup.fabric.width/2}d.drawing.buffer.isDrawing=true;k.set({originX:"center",originY:"center",top:e.top,left:e.left,width:i?k.width*i:k.width,height:i?k.height*i:k.height,fill:d.drawing.color});d.setup.fabric.add(k)})},change:function(m,k,i){var h=d.deepMerge({},m||{});var e,f,g;var j=i||d.drawing.buffer.target;var l=j?j._objects?j._objects:[j]:null;if(h.mode){d.drawing.mode=h.mode}if(h.width){d.drawing.width=h.width;d.drawing.fontSize=h.fontSize=h.width*3;if(d.drawing.width==1){d.drawing.fontSize=h.fontSize=d.defaults.fabric.drawing.fontSize}}if(h.fontSize){d.drawing.fontSize=h.fontSize}if(h.color){d.drawing.color=h.color}if(h.opacity){d.drawing.opacity=h.opacity}g=d.getRGBA(d.drawing.color);g.pop();g.push(d.drawing.opacity);d.drawing.color="rgba("+g.join()+")";d.setup.fabric.freeDrawingBrush.color=d.drawing.color;d.setup.fabric.freeDrawingBrush.width=d.drawing.width;if(j){e=JSON.parse(j.recentState).cfg;if(e){h.color=h.color||e.color;h.width=h.width||e.width;h.opacity=h.opacity||e.opacity;h.fontSize=h.fontSize||e.fontSize;g=d.getRGBA(h.color);g.pop();g.push(h.opacity);h.color="rgba("+g.join()+")"}for(f=0;f<l.length;f++){if(l[f] instanceof fabric.Text||l[f] instanceof fabric.PathGroup||l[f] instanceof fabric.Triangle){if(h.color||h.opacity){l[f].set({fill:h.color})}if(h.fontSize){l[f].set({fontSize:h.fontSize})}}else{if(l[f] instanceof fabric.Path||l[f] instanceof fabric.Line){if(j instanceof fabric.Group){if(h.color||h.opacity){l[f].set({stroke:h.color})}}else{if(h.color||h.opacity){l[f].set({stroke:h.color})}if(h.width){l[f].set({strokeWidth:h.width})}}}}}if(!k){e=JSON.stringify(d.deepMerge(j.saveState().originalState,{cfg:{color:h.color,width:h.width,opacity:h.opacity}}));j.recentState=e;d.drawing.redos=[];d.drawing.undos.push({action:"modified",target:j,state:e})}d.setup.fabric.renderAll()}},text:function(f){var e=d.deepMerge({text:d.i18l("menu.label.draw.text"),top:d.setup.fabric.height/2,left:d.setup.fabric.width/2,fontSize:d.drawing.fontSize,fontFamily:d.setup.chart.fontFamily||"Verdana",fill:d.drawing.color},f||{});e.click=function(){};var g=new fabric.IText(e.text,e);d.drawing.buffer.isDrawing=true;d.setup.fabric.add(g);d.setup.fabric.setActiveObject(g);g.selectAll();g.enterEditing();return g},line:function(h){var f=d.deepMerge({x1:(d.setup.fabric.width/2)-(d.setup.fabric.width/10),x2:(d.setup.fabric.width/2)+(d.setup.fabric.width/10),y1:(d.setup.fabric.height/2),y2:(d.setup.fabric.height/2),angle:90,strokeLineCap:d.drawing.lineCap,arrow:d.drawing.arrow,color:d.drawing.color,width:d.drawing.width,group:[],},h||{});var i,j,g,l;var e=new fabric.Line([f.x1,f.y1,f.x2,f.y2],{stroke:f.color,strokeWidth:f.width,strokeLineCap:f.strokeLineCap});f.group.push(e);if(f.arrow){f.angle=f.angle?f.angle:d.getAngle(f.x1,f.y1,f.x2,f.y2);if(f.arrow=="start"){g=f.y1+(f.width/2);l=f.x1+(f.width/2)}else{if(f.arrow=="middle"){g=f.y2+(f.width/2)-((f.y2-f.y1)/2);l=f.x2+(f.width/2)-((f.x2-f.x1)/2)}else{g=f.y2+(f.width/2);l=f.x2+(f.width/2)}}j=new fabric.Triangle({top:g,left:l,fill:f.color,height:f.width*7,width:f.width*7,angle:f.angle,originX:"center",originY:"bottom"});f.group.push(j)}d.drawing.buffer.isDrawing=true;if(f.action!="config"){if(f.arrow){var k=new fabric.Group(f.group);k.set({cfg:f,fill:f.color,action:f.action,selectable:true,known:f.action=="change"});if(f.action=="change"){d.setup.fabric.setActiveObject(k)}d.setup.fabric.add(k);return k}else{d.setup.fabric.add(e);return e}}else{for(i=0;i<f.group.length;i++){d.setup.fabric.add(f.group[i])}}return f}}},defaults:{position:"top-right",fileName:"amCharts",action:"download",overflow:true,path:((c.path||"")+"plugins/export/"),formats:{JPG:{mimeType:"image/jpg",extension:"jpg",capture:true},PNG:{mimeType:"image/png",extension:"png",capture:true},SVG:{mimeType:"text/xml",extension:"svg",capture:true},PDF:{mimeType:"application/pdf",extension:"pdf",capture:true},CSV:{mimeType:"text/plain",extension:"csv"},JSON:{mimeType:"text/plain",extension:"json"},XLSX:{mimeType:"application/octet-stream",extension:"xlsx"}},fabric:{backgroundColor:"#FFFFFF",removeImages:true,forceRemoveImages:false,selection:false,loadTimeout:5000,drawing:{enabled:true,arrow:"end",lineCap:"butt",mode:"pencil",modes:["pencil","line","arrow"],color:"#000000",colors:["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF"],shapes:["11.svg","14.svg","16.svg","17.svg","20.svg","27.svg"],width:1,fontSize:11,widths:[1,5,10,15],opacity:1,opacities:[1,0.8,0.6,0.4,0.2],menu:undefined,autoClose:true},border:{fill:"",fillOpacity:0,stroke:"#000000",strokeWidth:1,strokeOpacity:1}},pdfMake:{images:{},pageOrientation:"portrait",pageMargins:40,pageOrigin:true,pageSize:"A4",pageSizes:{"4A0":[4767.87,6740.79],"2A0":[3370.39,4767.87],A0:[2383.94,3370.39],A1:[1683.78,2383.94],A2:[1190.55,1683.78],A3:[841.89,1190.55],A4:[595.28,841.89],A5:[419.53,595.28],A6:[297.64,419.53],A7:[209.76,297.64],A8:[147.4,209.76],A9:[104.88,147.4],A10:[73.7,104.88],B0:[2834.65,4008.19],B1:[2004.09,2834.65],B2:[1417.32,2004.09],B3:[1000.63,1417.32],B4:[708.66,1000.63],B5:[498.9,708.66],B6:[354.33,498.9],B7:[249.45,354.33],B8:[175.75,249.45],B9:[124.72,175.75],B10:[87.87,124.72],C0:[2599.37,3676.54],C1:[1836.85,2599.37],C2:[1298.27,1836.85],C3:[918.43,1298.27],C4:[649.13,918.43],C5:[459.21,649.13],C6:[323.15,459.21],C7:[229.61,323.15],C8:[161.57,229.61],C9:[113.39,161.57],C10:[79.37,113.39],RA0:[2437.8,3458.27],RA1:[1729.13,2437.8],RA2:[1218.9,1729.13],RA3:[864.57,1218.9],RA4:[609.45,864.57],SRA0:[2551.18,3628.35],SRA1:[1814.17,2551.18],SRA2:[1275.59,1814.17],SRA3:[907.09,1275.59],SRA4:[637.8,907.09],EXECUTIVE:[521.86,756],FOLIO:[612,936],LEGAL:[612,1008],LETTER:[612,792],TABLOID:[792,1224]}},menu:undefined,divId:null,menuReviver:null,menuWalker:null,fallback:true,keyListener:true,fileListener:true,compress:true,debug:false},i18l:function(f,h){var g=h?h:d.setup.chart.language?d.setup.chart.language:"en";var e=AmCharts.translations[d.name][g]||AmCharts.translations[d.name]["en"];return e[f]||f},download:function(j,i,h){if(window.saveAs&&d.setup.hasBlob){var g=d.toBlob({data:j,type:i},function(m){saveAs(m,h)})}else{if(d.config.fallback&&i=="text/plain"){var l=document.createElement("div");var k=document.createElement("div");var e=document.createElement("textarea");k.innerHTML=d.i18l("fallback.save.text");l.appendChild(k);l.appendChild(e);k.setAttribute("class","amcharts-export-fallback-message");l.setAttribute("class","amcharts-export-fallback");d.setup.chart.containerDiv.appendChild(l);e.setAttribute("readonly","");e.value=j;e.focus();e.select();d.createMenu([{"class":"export-main export-close",label:"Done",click:function(){d.createMenu(d.config.menu);d.setup.chart.containerDiv.removeChild(l)}}])}else{if(d.config.fallback&&i.split("/")[0]=="image"){var l=document.createElement("div");var k=document.createElement("div");var f=d.toImage({data:j});k.innerHTML=d.i18l("fallback.save.image");l.appendChild(k);l.appendChild(f);k.setAttribute("class","amcharts-export-fallback-message");l.setAttribute("class","amcharts-export-fallback");d.setup.chart.containerDiv.appendChild(l);d.createMenu([{"class":"export-main export-close",label:"Done",click:function(){d.createMenu(d.config.menu);d.setup.chart.containerDiv.removeChild(l)}}])}else{throw new Error("Unable to create file. Ensure saveAs (FileSaver.js) is supported.")}}}return j},loadResource:function(e,n){var j,l,h,p,g,m;var f=e.indexOf("//")!=-1?e:[d.libs.path,e].join("");var k=function o(){if(n){for(j=0;j<n.length;j++){d.loadResource(n[j])}}};if(e.indexOf(".js")!=-1){h=document.createElement("script");h.setAttribute("type","text/javascript");h.setAttribute("src",f);if(d.libs.async){h.setAttribute("async","")}}else{if(e.indexOf(".css")!=-1){h=document.createElement("link");h.setAttribute("type","text/css");h.setAttribute("rel","stylesheet");h.setAttribute("href",f)}}for(j=0;j<document.head.childNodes.length;j++){p=document.head.childNodes[j];g=p?(p.src||p.href):false;m=p?p.tagName:false;if(p&&g&&g.indexOf(e)!=-1){if(d.libs.reload){document.head.removeChild(p)}l=true;break}}for(j in d.libs.namespaces){var i=d.libs.namespaces[j];var g=e.toLowerCase();var p=j.toLowerCase();if(g.indexOf(p)!=-1&&window[i]!==undefined){l=true;break}}if(!l||d.libs.reload){h.addEventListener("load",k);h.addEventListener("error",function(){d.handleLog(["amCharts[export]: Loading error on ",this.src||this.href].join(""))});document.head.appendChild(h);if(!d.listenersToRemove){d.listenersToRemove=[]}d.listenersToRemove.push({node:h,method:k,event:"load"})}},loadDependencies:function(){var f,e;if(d.libs.autoLoad){for(f=0;f<d.libs.resources.length;f++){if(d.libs.resources[f] instanceof Object){for(e in d.libs.resources[f]){d.loadResource(e,d.libs.resources[f][e])}}else{d.loadResource(d.libs.resources[f])}}}},pxToNumber:function(e,f){if(!e&&f){return undefined}return Number(String(e).replace("px",""))||0},numberToPx:function(e){return String(e)+"px"},cloneObject:function(i){var j,g,f,e,h;j=Array.isArray(i)?[]:{};for(f in i){g=i[f];e=typeof g==="object";h=g instanceof Date;j[f]=e&&!h?d.cloneObject(g):g}return j},deepMerge:function(f,e,h){var j,g,i=e instanceof Array?"array":"object";if(!(f instanceof Object||f instanceof Array)){return f}for(j in e){if(i=="array"&&isNaN(j)){continue}g=e[j];if(f&&f[j]==undefined||h){if(g instanceof Array){f[j]=new Array()}else{if(g instanceof Function){f[j]=function(){}}else{if(g instanceof Date){f[j]=new Date()}else{if(g instanceof Object){f[j]=new Object()}else{if(g instanceof Number){f[j]=new Number()}else{if(g instanceof String){f[j]=new String()}}}}}}}if((g instanceof Object||g instanceof Array)&&!(g instanceof Function||g instanceof Date||d.isElement(g))&&j!="chart"&&j!="scope"){d.deepMerge(f[j],g,h)}else{if(f instanceof Array&&!h){f.push(g)}else{if(f){f[j]=g}}}}return f},isElement:function(e){return e instanceof Object&&e&&e.nodeType===1},isHashbanged:function(e){var f=String(e).replace(/\"/g,"");return f.slice(0,3)=="url"?f.slice(f.indexOf("#")+1,f.length-1):false},isPressed:function(e){if(e.type=="mousemove"&&e.which===1){}else{if(e.type=="touchmove"||e.buttons===1||e.button===1||e.which===1){d.drawing.buffer.isPressed=true}else{d.drawing.buffer.isPressed=false}}return d.drawing.buffer.isPressed},removeImage:function(e){if(e){if(d.config.fabric.forceRemoveImages){return true}else{if(d.config.fabric.removeImages&&d.isTainted(e)){return true}else{if(d.setup.isIE&&(d.setup.IEversion==10||d.setup.IEversion==11)&&e.toLowerCase().indexOf(".svg")!=-1){return true}}}}return false},isTainted:function(f){var e=String(window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));if(f){if(e.indexOf(":\\")!=-1||f.indexOf(":\\")!=-1||e.indexOf("file://")!=-1||f.indexOf("file://")!=-1){return true}else{if(f.indexOf("//")!=-1&&f.indexOf(e.replace(/.*:/,""))==-1){return true}}}return false},isSupported:function(){if(!d.config.enabled){return false}if(d.setup.isIE&&d.setup.IEversion<=9){if(!Array.prototype.indexOf||!document.head||d.config.fallback===false){return false}}return true},getAngle:function(g,i,f,h){var e=f-g;var k=h-i;var j;if(e==0){if(k==0){j=0}else{if(k>0){j=Math.PI/2}else{j=Math.PI*3/2}}}else{if(k==0){if(e>0){j=0}else{j=Math.PI}}else{if(e<0){j=Math.atan(k/e)+Math.PI}else{if(k<0){j=Math.atan(k/e)+(2*Math.PI)}else{j=Math.atan(k/e)}}}}return j*180/Math.PI},gatherAttribute:function(i,e,f,g){var h,g=g?g:0,f=f?f:3;if(i){h=i.getAttribute(e);if(!h&&g<f){return d.gatherAttribute(i.parentNode,e,f,g+1)}}return h},gatherClassName:function(i,g,e,f){var h,f=f?f:0,e=e?e:3;if(d.isElement(i)){h=(i.getAttribute("class")||"").split(" ").indexOf(g)!=-1;if(!h&&f<e){return d.gatherClassName(i.parentNode,g,e,f+1)}else{if(h){h=i}}}return h},gatherElements:function(p,j,n){var h,g;for(h=0;h<p.children.length;h++){var e=p.children[h];if(e.tagName=="clipPath"){var q={};var f=fabric.parseTransformAttribute(d.gatherAttribute(e,"transform"));for(g=0;g<e.childNodes.length;g++){e.childNodes[g].setAttribute("fill","transparent");q={x:d.pxToNumber(e.childNodes[g].getAttribute("x")),y:d.pxToNumber(e.childNodes[g].getAttribute("y")),width:d.pxToNumber(e.childNodes[g].getAttribute("width")),height:d.pxToNumber(e.childNodes[g].getAttribute("height"))}}p.clippings[e.id]={svg:e,bbox:q,transform:f}}else{if(e.tagName=="pattern"){var m={node:e,source:e.getAttribute("xlink:href"),width:Number(e.getAttribute("width")),height:Number(e.getAttribute("height")),repeat:"repeat",offsetX:0,offsetY:0};for(g=0;g<e.childNodes.length;g++){if(e.childNodes[g].tagName=="rect"){m.fill=e.childNodes[g].getAttribute("fill")}else{if(e.childNodes[g].tagName=="image"){var o=fabric.parseAttributes(e.childNodes[g],fabric.SHARED_ATTRIBUTES);if(o.transformMatrix){m.offsetX=o.transformMatrix[4];m.offsetY=o.transformMatrix[5]}}}}if(d.removeImage(m.source)){p.patterns[e.id]=m.fill?m.fill:"transparent"}else{p.patterns[m.node.id]=m}}else{if(e.tagName=="image"){n.included++;fabric.Image.fromURL(e.getAttribute("xlink:href"),function(s){n.loaded++})}else{var o=["fill","stroke"];for(g=0;g<o.length;g++){var l=o[g];var k=e.getAttribute(l);var i=d.getRGBA(k);var r=d.isHashbanged(k);if(k&&!i&&!r){e.setAttribute(l,"none");e.setAttribute(l+"-opacity","0")}}}}}}return p},getRGBA:function(f,e){if(f!="none"&&f!="transparent"&&!d.isHashbanged(f)){f=new fabric.Color(f);if(f._source){return e?f:f.getSource()}}return false},gatherPosition:function(g,e){var f=d.drawing.buffer.position;var h=fabric.util.invertTransform(d.setup.fabric.viewportTransform);var i;if(g.type=="touchmove"){if("touches" in g){g=g.touches[0]}else{if("changedTouches" in g){g=g.changedTouches[0]}}}i=fabric.util.transformPoint(d.setup.fabric.getPointer(g,true),h);if(e==1){f.x1=i.x;f.y1=i.y}f.x2=i.x;f.y2=i.y;f.xD=(f.x1-f.x2)<0?(f.x1-f.x2)*-1:(f.x1-f.x2);f.yD=(f.y1-f.y2)<0?(f.y1-f.y2)*-1:(f.y1-f.y2);return f},modifyFabric:function(){fabric.ElementsParser.prototype.resolveGradient=function(i,h){var f=i.get(h);if(!(/^url\(/).test(f)){return}var g=f.slice(f.indexOf("#")+1,f.length-1);if(fabric.gradientDefs[this.svgUid][g]){var e=fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][g],i);if(e.coords.y1&&d.setup.chart.type!="pie"){e.coords.y2=e.coords.y1*-1;e.coords.y1=0}i.set(h,e)}};fabric.Text.fromElement=function(g,f){if(!g){return null}var j=fabric.parseAttributes(g,fabric.Text.ATTRIBUTE_NAMES);f=fabric.util.object.extend((f?fabric.util.object.clone(f):{}),j);f.top=f.top||0;f.left=f.left||0;if("dx" in j){f.left+=j.dx}if("dy" in j){f.top+=j.dy}if(!("fontSize" in f)){f.fontSize=fabric.Text.DEFAULT_SVG_FONT_SIZE}if(!f.originX){f.originX="left"}var i="";var l=[];if(!("textContent" in g)){if("firstChild" in g&&g.firstChild!==null){if("data" in g.firstChild&&g.firstChild.data!==null){l.push(g.firstChild.data)}}}else{if(g.childNodes){for(var h=0;h<g.childNodes.length;h++){l.push(g.childNodes[h].textContent)}}else{l.push(g.textContent)}}i=l.join("\n");var k=new fabric.Text(i,f),e=0;if(k.originX==="left"){e=k.getWidth()/2}if(k.originX==="right"){e=-k.getWidth()/2}if(l.length>1){k.set({left:k.getLeft()+e,top:k.getTop()+k.fontSize*(l.length-1)*(0.18+k._fontSizeFraction),textAlign:f.originX,lineHeight:l.length>1?0.965:1.16,})}else{k.set({left:k.getLeft()+e,top:k.getTop()-k.getHeight()/2+k.fontSize*(0.18+k._fontSizeFraction)})}return k}},capture:function(p,o){var f;var i=d.deepMerge(d.deepMerge({},d.config.fabric),p||{});var e=[];var g={x:0,y:0,pX:0,pY:0,lX:0,lY:0,width:d.setup.chart.divRealWidth,height:d.setup.chart.divRealHeight};var j={loaded:0,included:0};var h={items:[],width:0,height:0,maxWidth:0,maxHeight:0};if(!d.handleNamespace("fabric",{scope:this,cb:d.capture,args:arguments})){return false}d.modifyFabric();d.handleCallback(i.beforeCapture,i);var m=d.setup.chart.containerDiv.getElementsByTagName("svg");for(f=0;f<m.length;f++){var n={svg:m[f],parent:m[f].parentNode,children:m[f].getElementsByTagName("*"),offset:{x:0,y:0},patterns:{},clippings:{},has:{legend:false,panel:false,scrollbar:false}};n.has.legend=d.gatherClassName(n.parent,d.setup.chart.classNamePrefix+"-legend-div",1);n.has.panel=d.gatherClassName(n.parent,d.setup.chart.classNamePrefix+"-stock-panel-div");n.has.scrollbar=d.gatherClassName(n.parent,d.setup.chart.classNamePrefix+"-scrollbar-chart-div");n=d.gatherElements(n,i,j);e.push(n)}if(d.config.legend){if(d.setup.chart.type=="stock"){for(f=0;f<d.setup.chart.panels.length;f++){if(d.setup.chart.panels[f].stockLegend&&d.setup.chart.panels[f].stockLegend.divId){h.items.push(d.setup.chart.panels[f].stockLegend)}}}else{if(d.setup.chart.legend&&d.setup.chart.legend.divId){h.items.push(d.setup.chart.legend)}}for(f=0;f<h.items.length;f++){var l=h.items[f];var n={svg:l.container.container,parent:l.container.container.parentNode,children:l.container.container.getElementsByTagName("*"),offset:{x:0,y:0},legend:{id:f,type:["top","left"].indexOf(d.config.legend.position)!=-1?"unshift":"push",position:d.config.legend.position,width:d.config.legend.width?d.config.legend.width:l.container.div.offsetWidth,height:d.config.legend.height?d.config.legend.height:l.container.div.offsetHeight},patterns:{},clippings:{},has:{legend:false,panel:false,scrollbar:false}};h.width+=n.legend.width;h.height+=n.legend.height;h.maxWidth=n.legend.width>h.maxWidth?n.legend.width:h.maxWidth;h.maxHeight=n.legend.height>h.maxHeight?n.legend.height:h.maxHeight;n=d.gatherElements(n,i,j);e[n.legend.type](n)}if(["top","bottom"].indexOf(d.config.legend.position)!=-1){g.width=h.maxWidth>g.width?h.maxWidth:g.width;g.height+=h.height}else{if(["left","right"].indexOf(d.config.legend.position)!=-1){g.width+=h.maxWidth;g.height=h.height>g.height?h.height:g.height}else{g.height+=h.height;g.width+=h.maxWidth}}}d.drawing.enabled=i.drawing.enabled=i.action=="draw";d.drawing.buffer.enabled=d.drawing.enabled;d.setup.wrapper=document.createElement("div");d.setup.wrapper.setAttribute("class",d.setup.chart.classNamePrefix+"-export-canvas");d.setup.chart.containerDiv.appendChild(d.setup.wrapper);if(d.setup.chart.type=="stock"){var k={top:0,right:0,bottom:0,left:0};if(d.setup.chart.leftContainer){g.width-=d.setup.chart.leftContainer.offsetWidth;k.left=d.setup.chart.leftContainer.offsetWidth+(d.setup.chart.panelsSettings.panelSpacing*2)}if(d.setup.chart.rightContainer){g.width-=d.setup.chart.rightContainer.offsetWidth;k.right=d.setup.chart.rightContainer.offsetWidth+(d.setup.chart.panelsSettings.panelSpacing*2)}if(d.setup.chart.periodSelector&&["top","bottom"].indexOf(d.setup.chart.periodSelector.position)!=-1){g.height-=d.setup.chart.periodSelector.offsetHeight+d.setup.chart.panelsSettings.panelSpacing;k[d.setup.chart.periodSelector.position]+=d.setup.chart.periodSelector.offsetHeight+d.setup.chart.panelsSettings.panelSpacing}if(d.setup.chart.dataSetSelector&&["top","bottom"].indexOf(d.setup.chart.dataSetSelector.position)!=-1){g.height-=d.setup.chart.dataSetSelector.offsetHeight;k[d.setup.chart.dataSetSelector.position]+=d.setup.chart.dataSetSelector.offsetHeight}d.setup.wrapper.style.paddingTop=d.numberToPx(k.top);d.setup.wrapper.style.paddingRight=d.numberToPx(k.right);d.setup.wrapper.style.paddingBottom=d.numberToPx(k.bottom);d.setup.wrapper.style.paddingLeft=d.numberToPx(k.left)}d.setup.canvas=document.createElement("canvas");d.setup.wrapper.appendChild(d.setup.canvas);d.setup.fabric=new fabric.Canvas(d.setup.canvas,d.deepMerge({width:g.width,height:g.height,isDrawingMode:true},i));d.deepMerge(d.setup.fabric,i);d.deepMerge(d.setup.fabric.freeDrawingBrush,i.drawing);d.deepMerge(d.drawing,i.drawing);d.drawing.handler.change(i.drawing);d.setup.fabric.on("mouse:down",function(r){var q=d.gatherPosition(r.e,1);d.drawing.buffer.pressedTS=Number(new Date());d.isPressed(r.e);d.drawing.buffer.isDrawing=false;d.drawing.buffer.isDrawingTimer=setTimeout(function(){if(!d.drawing.buffer.isSelected){d.drawing.buffer.isDrawing=true}},200)});d.setup.fabric.on("mouse:move",function(v){var u=d.gatherPosition(v.e,2);d.isPressed(v.e);if(d.drawing.buffer.isPressed&&!d.drawing.buffer.isSelected){d.drawing.buffer.isDrawing=true;if(!d.drawing.buffer.line&&d.drawing.mode!="pencil"&&(u.xD>5||u.yD>5)){d.setup.fabric.isDrawingMode=false;d.setup.fabric._isCurrentlyDrawing=false;d.setup.fabric.freeDrawingBrush.onMouseUp();d.setup.fabric.remove(d.setup.fabric._objects.pop());d.drawing.buffer.line=d.drawing.handler.line({x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,arrow:d.drawing.mode=="line"?false:d.drawing.arrow,action:"config"})}}if(d.drawing.buffer.isSelected){d.setup.fabric.isDrawingMode=false}if(d.drawing.buffer.line){var t,s,r;var q=d.drawing.buffer.line;q.x2=u.x2;q.y2=u.y2;for(f=0;f<q.group.length;f++){t=q.group[f];if(t instanceof fabric.Line){t.set({x2:q.x2,y2:q.y2})}else{if(t instanceof fabric.Triangle){q.angle=(d.getAngle(q.x1,q.y1,q.x2,q.y2)+90);if(q.arrow=="start"){s=q.y1+(q.width/2);r=q.x1+(q.width/2)}else{if(q.arrow=="middle"){s=q.y2+(q.width/2)-((q.y2-q.y1)/2);r=q.x2+(q.width/2)-((q.x2-q.x1)/2)}else{s=q.y2+(q.width/2);r=q.x2+(q.width/2)}}t.set({top:s,left:r,angle:q.angle})}}}d.setup.fabric.renderAll()}});d.setup.fabric.on("mouse:up",function(r){if(!d.drawing.buffer.isDrawing){var q=d.setup.fabric.findTarget(r.e);if(q&&q.selectable){d.setup.fabric.setActiveObject(q)}}if(d.drawing.buffer.line){for(f=0;f<d.drawing.buffer.line.group.length;f++){d.drawing.buffer.line.group[f].remove()}delete d.drawing.buffer.line.action;delete d.drawing.buffer.line.group;d.drawing.handler.line(d.drawing.buffer.line)}d.drawing.buffer.line=false;d.drawing.buffer.hasLine=false;d.drawing.buffer.isPressed=false;clearTimeout(d.drawing.buffer.isDrawingTimer);d.drawing.buffer.isDrawing=false});d.setup.fabric.on("object:selected",function(q){d.drawing.buffer.isSelected=true;d.drawing.buffer.target=q.target;d.setup.fabric.isDrawingMode=false});d.setup.fabric.on("selection:cleared",function(q){d.drawing.buffer.target=false;if(d.drawing.buffer.isSelected){d.setup.fabric._isCurrentlyDrawing=false}d.drawing.buffer.isSelected=false;d.setup.fabric.isDrawingMode=true});d.setup.fabric.on("path:created",function(r){var q=r.path;if(!d.drawing.buffer.isDrawing||d.drawing.buffer.hasLine){d.setup.fabric.remove(q);d.setup.fabric.renderAll();return}});d.setup.fabric.on("object:added",function(s){var q=s.target;var r=d.deepMerge(q.saveState().originalState,{cfg:{color:d.drawing.color,width:d.drawing.width,opacity:d.drawing.opacity,fontSize:d.drawing.fontSize}});r=JSON.stringify(r);q.recentState=r;if(q.selectable&&!q.known){q.isAnnotation=true;d.drawing.undos.push({action:"added",target:q,state:r});d.drawing.undos.push({action:"addified",target:q,state:r});d.drawing.redos=[]}q.known=true;d.setup.fabric.isDrawingMode=true});d.setup.fabric.on("object:modified",function(t){var r=t.target;var q=JSON.parse(r.recentState);var s=d.deepMerge(r.saveState().originalState,{cfg:q.cfg});s=JSON.stringify(s);r.recentState=s;d.drawing.undos.push({action:"modified",target:r,state:s});d.drawing.redos=[]});d.setup.fabric.on("text:changed",function(r){var q=r.target;clearTimeout(q.timer);q.timer=setTimeout(function(){var s=JSON.stringify(q.saveState().originalState);q.recentState=s;d.drawing.redos=[];d.drawing.undos.push({action:"modified",target:q,state:s})},250)});if(d.drawing.enabled){d.setup.wrapper.setAttribute("class",d.setup.chart.classNamePrefix+"-export-canvas active");d.setup.wrapper.style.backgroundColor=i.backgroundColor;d.setup.wrapper.style.display="block"}else{d.setup.wrapper.setAttribute("class",d.setup.chart.classNamePrefix+"-export-canvas");d.setup.wrapper.style.display="none"}for(f=0;f<e.length;f++){var n=e[f];if(d.setup.chart.type=="stock"&&d.setup.chart.legendSettings.position){if(["top","bottom"].indexOf(d.setup.chart.legendSettings.position)!=-1){if(n.parent.style.top&&n.parent.style.left){n.offset.y=d.pxToNumber(n.parent.style.top);n.offset.x=d.pxToNumber(n.parent.style.left)}else{n.offset.x=g.x;n.offset.y=g.y;g.y+=d.pxToNumber(n.parent.style.height);if(n.has.panel){g.pY=d.pxToNumber(n.has.panel.style.marginTop);n.offset.y+=g.pY}else{if(n.has.scrollbar){n.offset.y+=g.pY}}}}else{if(["left","right"].indexOf(d.setup.chart.legendSettings.position)!=-1){n.offset.y=d.pxToNumber(n.parent.style.top)+g.pY;n.offset.x=d.pxToNumber(n.parent.style.left)+g.pX;if(n.has.legend){g.pY+=d.pxToNumber(n.has.panel.style.height)+d.setup.chart.panelsSettings.panelSpacing}else{if(n.has.scrollbar){n.offset.y-=d.setup.chart.panelsSettings.panelSpacing}}}}}else{if(n.parent.style.position=="absolute"){n.offset.absolute=true;n.offset.top=d.pxToNumber(n.parent.style.top);n.offset.right=d.pxToNumber(n.parent.style.right,true);n.offset.bottom=d.pxToNumber(n.parent.style.bottom,true);n.offset.left=d.pxToNumber(n.parent.style.left);n.offset.width=d.pxToNumber(n.parent.style.width);n.offset.height=d.pxToNumber(n.parent.style.height)}else{if(n.parent.style.top&&n.parent.style.left){n.offset.y=d.pxToNumber(n.parent.style.top);n.offset.x=d.pxToNumber(n.parent.style.left)}else{if(n.legend){if(n.legend.position=="left"){g.x=h.maxWidth}else{if(n.legend.position=="right"){n.offset.x=g.width-h.maxWidth}else{if(n.legend.position=="top"){g.y+=n.legend.height}else{if(n.legend.position=="bottom"){n.offset.y=g.height-h.height}}}}n.offset.y+=g.lY;g.lY+=n.legend.height}else{n.offset.x=g.x;n.offset.y=g.y+g.pY;g.y+=d.pxToNumber(n.parent.style.height)}}}if(n.has.legend&&n.has.panel&&n.has.panel.style.marginTop){g.y+=d.pxToNumber(n.has.panel.style.marginTop);n.offset.y+=d.pxToNumber(n.has.panel.style.marginTop)}else{if(d.setup.chart.legend&&["left","right"].indexOf(d.setup.chart.legend.position)!=-1){n.offset.y=d.pxToNumber(n.parent.style.top);n.offset.x=d.pxToNumber(n.parent.style.left)}}}fabric.parseSVGDocument(n.svg,(function(q){return function(E,G){var z,y;var B=fabric.util.groupSVGElements(E,G);var F=[];var A={selectable:false,isCoreElement:true};if(q.offset.absolute){if(q.offset.bottom!==undefined){A.top=g.height-q.offset.height-q.offset.bottom}else{A.top=q.offset.top}if(q.offset.right!==undefined){A.left=g.width-q.offset.width-q.offset.right}else{A.left=q.offset.left}}else{A.top=q.offset.y;A.left=q.offset.x}for(z=0;z<B.paths.length;z++){var s=null;if(B.paths[z]){if(d.removeImage(B.paths[z]["xlink:href"])){continue}if(B.paths[z].fill instanceof Object){if(B.paths[z].fill.type=="radial"){if(["pie","gauge"].indexOf(d.setup.chart.type)==-1){B.paths[z].fill.coords.r2=B.paths[z].fill.coords.r1*-1;B.paths[z].fill.coords.r1=0;B.paths[z].set({opacity:B.paths[z].fillOpacity})}}}else{if(s=d.isHashbanged(B.paths[z].fill)){if(q.patterns&&q.patterns[s]){var C=q.patterns[s];j.included++;fabric.Image.fromURL(C.source,(function(H,I){return function(J){j.loaded++;J.set({top:H.offsetY,left:H.offsetX,width:H.width,height:H.height});if(d.setup.fabric._isRetinaScaling()){J.set({top:H.offsetY/2,left:H.offsetX/2,scaleX:0.5,scaleY:0.5})}var L=new fabric.StaticCanvas(undefined,{backgroundColor:H.fill,width:J.getWidth(),height:J.getHeight()});L.add(J);var K=new fabric.Pattern({source:L.getElement(),offsetX:B.paths[I].width/2,offsetY:B.paths[I].height/2,repeat:"repeat",});B.paths[I].set({fill:K,opacity:B.paths[I].fillOpacity})}})(C,z))}}}if(s=d.isHashbanged(B.paths[z].clipPath)){if(q.clippings&&q.clippings[s]){(function(H,J){var I=B.paths[H].toSVG;B.paths[H].toSVG=function(K){return I.apply(this,[function(L){return K(L,q.clippings[J])}])}})(z,s);B.paths[z].set({clipTo:(function(H,I){return function(K){var M=q.clippings[I];var J=this.transformMatrix||[1,0,0,1,0,0];var L={top:M.bbox.y,left:M.bbox.x,width:M.bbox.width,height:M.bbox.height};if(d.setup.chart.type=="map"){L.top+=M.transform[5];L.left+=M.transform[4]}if(M.bbox.x&&J[4]&&M.bbox.y&&J[5]){L.top-=J[5];L.left-=J[4]}if(d.setup.chart.smoothCustomBullets!==undefined&&this.className==d.setup.chart.classNamePrefix+"-graph-bullet"&&B.paths[H].svg.tagName=="image"){radius=M.svg.firstChild.rx.baseVal.value/2+2;K.beginPath();K.moveTo(L.left+radius,L.top);K.lineTo(L.left+L.width-radius,L.top);K.quadraticCurveTo(L.left+L.width,L.top,L.left+L.width,L.top+radius);K.lineTo(L.left+L.width,L.top+L.height-radius);K.quadraticCurveTo(L.left+L.width,L.top+L.height,L.left+L.width-radius,L.top+L.height);K.lineTo(L.left+radius,L.top+L.height);K.quadraticCurveTo(L.left,L.top+L.height,L.left,L.top+L.height-radius);K.lineTo(L.left,L.top+radius);K.quadraticCurveTo(L.left,L.top,L.left+radius,L.top);K.closePath()}else{K.rect(L.left,L.top,L.width,L.height)}}})(z,s)})}}}F.push(B.paths[z])}B.paths=F;A.top+=0.5;A.left+=0.5;B.set(A);d.setup.fabric.add(B);if(q.svg.parentNode&&q.svg.parentNode.getElementsByTagName){var D=q.svg.parentNode.getElementsByClassName(d.setup.chart.classNamePrefix+"-balloon-div");for(z=0;z<D.length;z++){if(i.balloonFunction instanceof Function){i.balloonFunction.apply(d,[D[z],q])}else{var w=D[z];var u=fabric.parseStyleAttribute(w);var r=fabric.parseStyleAttribute(w.childNodes[0]);var x=new fabric.Text(w.innerText||w.textContent||w.innerHTML,{selectable:false,top:u.top+q.offset.y,left:u.left+q.offset.x,fill:r.color,fontSize:r.fontSize,fontFamily:r.fontFamily,textAlign:r["text-align"],isCoreElement:true});d.setup.fabric.add(x)}}}if(q.svg.nextSibling&&q.svg.nextSibling.tagName=="A"){var w=q.svg.nextSibling;var u=fabric.parseStyleAttribute(w);var x=new fabric.Text(w.innerText||w.textContent||w.innerHTML,{selectable:false,top:u.top+q.offset.y,left:u.left+q.offset.x,fill:u.color,fontSize:u.fontSize,fontFamily:u.fontFamily,opacity:u.opacity,isCoreElement:true});if(!q.has.scrollbar){d.setup.fabric.add(x)}}e.pop();if(!e.length){var t=Number(new Date());var v=setInterval(function(){var H=Number(new Date());if(j.loaded==j.included||H-t>d.config.fabric.loadTimeout){clearTimeout(v);d.handleBorder(i);d.handleCallback(i.afterCapture,i);d.setup.fabric.renderAll();d.handleCallback(o,i)}},AmCharts.updateRate)}}})(n),function(u,t){var s;var z=d.gatherAttribute(u,"class");var q=d.gatherAttribute(u,"visibility");var y=d.gatherAttribute(u,"clip-path");t.className=String(z);t.classList=String(z).split(" ");t.clipPath=y;t.svg=u;var A=["fill","stroke"];for(s=0;s<A.length;s++){var x=A[s];var w=String(u.getAttribute(x)||"none");var r=Number(u.getAttribute(x+"-opacity")||"1");var v=d.getRGBA(w);if(q=="hidden"){t.opacity=0;r=0}if(v){v.pop();v.push(r);t[x]="rgba("+v.join()+")";t[x+d.capitalize("opacity")]=r}}d.handleCallback(i.reviver,t,u)})}},toCanvas:function(f,h){var e=d.deepMerge({},f||{});var g=d.setup.canvas;d.handleCallback(h,g,e);return g},toImage:function(g,i){var e=d.deepMerge({format:"png",quality:1,multiplier:d.config.multiplier},g||{});var h=e.data;var f=document.createElement("img");if(!d.handleNamespace("fabric",{scope:this,cb:d.toImage,args:arguments})){return false}if(!e.data){if(e.lossless||e.format=="svg"){h=d.toSVG(d.deepMerge(e,{getBase64:true}))}else{h=d.setup.fabric.toDataURL(e)}}f.setAttribute("src",h);d.handleCallback(i,f,e);return f},toBlob:function(f,i){var e=d.deepMerge({data:"empty",type:"text/plain"},f||{});var g;var h=/^data:.+;base64,(.*)$/.exec(e.data);if(h){e.data=h[0];e.type=e.data.slice(5,e.data.indexOf(",")-7);e.data=d.toByteArray({data:e.data.slice(e.data.indexOf(",")+1,e.data.length)})}if(e.getByteArray){g=e.data}else{g=new Blob([e.data],{type:e.type})}d.handleCallback(i,g,e);return g},toJPG:function(f,h){var e=d.deepMerge({format:"jpeg",quality:1,multiplier:d.config.multiplier},f||{});e.format=e.format.toLowerCase();var g;if(!d.handleNamespace("fabric",{scope:this,cb:d.toJPG,args:arguments})){return false}g=d.setup.fabric.toDataURL(e);d.handleCallback(h,g,e);return g},toPNG:function(f,h){var e=d.deepMerge({format:"png",quality:1,multiplier:d.config.multiplier},f||{});var g;if(!d.handleNamespace("fabric",{scope:this,cb:d.toPNG,args:arguments})){return false}g=d.setup.fabric.toDataURL(e);d.handleCallback(h,g,e);return g},toSVG:function(g,l){var i=[];var h=[];var f=d.deepMerge({compress:d.config.compress,reviver:function(m,r){var n=new RegExp(/\bstyle=(['"])(.*?)\1/);var s=n.exec(m)[0].slice(7,-1);var t=s.split(";");var x=[];for(i1=0;i1<t.length;i1++){if(t[i1]){var v=t[i1].replace(/\s/g,"").split(":");var D=v[0];var w=v[1];if(["fill","stroke"].indexOf(D)!=-1){w=d.getRGBA(w,true);if(w){var z="#"+w.toHex();var o=w._source[3];x.push([D,z].join(":"));x.push([D+"-opacity",o].join(":"))}else{x.push(t[i1])}}else{if(D!="opactiy"){x.push(t[i1])}}}}m=m.replace(s,x.join(";"));if(r&&r.svg){var y=r.svg.id;var A=2;var p=m.slice(-A);if(p!="/>"){A=3;p=m.slice(-A)}var q=m.slice(0,m.length-A);var u=' clip-path="url(#'+y+')" ';var C=d.gatherAttribute(r.svg,"class");C=C?C.split(" "):[];if(C.indexOf(d.setup.chart.classNamePrefix+"-graph-line")!=-1){m=q+u+p}else{m="<g "+u+">"+m+"</g>"}if(h.indexOf(y)==-1){var B=new XMLSerializer().serializeToString(r.svg);i.push(B);h.push(y)}}return m}},g||{});var j;if(!d.handleNamespace("fabric",{scope:this,cb:d.toSVG,args:arguments})){return false}j=d.setup.fabric.toSVG(f,f.reviver);if(i.length){var k=j.slice(0,j.length-6);var e=j.slice(-6);j=k+i.join("")+e}if(f.compress){j=j.replace(/[\t\r\n]+/g,"")}if(f.getBase64){j="data:image/svg+xml;base64,"+btoa(j)}d.handleCallback(l,j,f);return j},toPDF:function(m,k){var j=d.deepMerge(d.deepMerge({multiplier:d.config.multiplier||2,pageOrigin:d.config.pageOrigin===undefined?true:false},d.config.pdfMake),m||{},true);var i;if(!d.handleNamespace("pdfMake",{scope:this,cb:d.toPDF,args:arguments})){return false}i=new pdfMake.createPdf(j);j.images.reference=d.toPNG(j);function h(n){if(typeof n==="number"||n instanceof Number){n={left:n,right:n,top:n,bottom:n}}else{if(n instanceof Array){if(n.length===2){n={left:n[0],top:n[1],right:n[0],bottom:n[1]}}else{if(n.length===4){n={left:n[0],top:n[1],right:n[2],bottom:n[3]}}else{throw"Invalid pageMargins definition"}}}else{n={left:d.defaults.pdfMake.pageMargins,top:d.defaults.pdfMake.pageMargins,right:d.defaults.pdfMake.pageMargins,bottom:d.defaults.pdfMake.pageMargins}}}return n}function l(n,o){var p=d.defaults.pdfMake.pageSizes[String(n).toUpperCase()].slice();if(!p){throw new Error('The given pageSize "'+n+'" does not exist!')}if(o=="landscape"){p.reverse()}return p}if(!j.content){var e=[];var g=l(j.pageSize,j.pageOrientation);var f=h(j.pageMargins);g[0]-=(f.left+f.right);g[1]-=(f.top+f.bottom);if(j.pageOrigin){e.push(d.i18l("label.saved.from"));e.push(window.location.href);g[1]-=(14.064*2)}e.push({image:"reference",fit:g});j.content=e}if(k){i.getDataUrl((function(n){return function(o){n.apply(d,arguments)}})(k))}return i},toPRINT:function(i,l){var j;var f=d.deepMerge({delay:0.01,lossless:false},i||{});var k=d.toImage(f);var h=[];var g=document.body.childNodes;var e=document.documentElement.scrollTop||document.body.scrollTop;k.setAttribute("style","width: 100%; max-height: 100%;");for(j=0;j<g.length;j++){if(d.isElement(g[j])){h[j]=g[j].style.display;g[j].style.display="none"}}document.body.appendChild(k);setTimeout(function(){window.print();f.delay*=1000;var m=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(m&&f.delay<1000){f.delay=1000}setTimeout(function(){for(j=0;j<g.length;j++){if(d.isElement(g[j])){g[j].style.display=h[j]}}document.body.removeChild(k);document.documentElement.scrollTop=document.body.scrollTop=e;d.handleCallback(l,k,f)},f.delay)},1);return k},toJSON:function(f,h){var e=d.deepMerge({dateFormat:d.config.dateFormat||"dateObject"},f||{},true);var g={};if(!d.handleNamespace("JSON",{scope:this,cb:d.toJSON,args:arguments})){return false}e.data=e.data!==undefined?e.data:d.getChartData(e);g=JSON.stringify(e.data,undefined,"\t");d.handleCallback(h,g,e);return g},toCSV:function(h,k){var j,g;var f=d.deepMerge({delimiter:",",quotes:true,escape:true,withHeader:true},h||{},true);var e=[];var i="";e=d.toArray(f);for(j in e){if(!isNaN(j)){i+=e[j].join(f.delimiter)+"\n"}}d.handleCallback(k,i,f);return i},toXLSX:function(i,l){var h=d.deepMerge({name:"amCharts",dateFormat:d.config.dateFormat||"dateObject",withHeader:true,stringify:false},i||{},true);var g=[];var k="";var j={SheetNames:[],Sheets:{}};if(!d.handleNamespace("XLSX",{scope:this,cb:d.toXLSX,args:arguments})){return false}g=d.toArray(h);function e(n,m){if(m){n+=1462}var o=Date.parse(n);var p=n.getTimezoneOffset()*60*1000;return(o-p-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000)}function f(s,r){var n={};var o={s:{c:10000000,r:10000000},e:{c:0,r:0}};for(var q=0;q!=s.length;++q){for(var t=0;t!=s[q].length;++t){if(o.s.r>q){o.s.r=q}if(o.s.c>t){o.s.c=t}if(o.e.r<q){o.e.r=q}if(o.e.c<t){o.e.c=t}var m={v:s[q][t]};if(m.v==null){continue}var p=XLSX.utils.encode_cell({c:t,r:q});if(typeof m.v==="number"){m.t="n"}else{if(typeof m.v==="boolean"){m.t="b"}else{if(m.v instanceof Date){m.t="n";m.z=XLSX.SSF._table[14];m.v=e(m.v)}else{if(m.v instanceof Object){m.t="s";m.v=JSON.stringify(m.v)}else{m.t="s"}}}}n[p]=m}}if(o.s.c<10000000){n["!ref"]=XLSX.utils.encode_range(o)}return n}j.SheetNames.push(h.name);j.Sheets[h.name]=f(g);k=XLSX.write(j,{bookType:"xlsx",bookSST:true,type:"base64"});k="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+k;d.handleCallback(l,k,h);return k},toArray:function(p,n){var o,e;var h=d.deepMerge({withHeader:false,stringify:true,escape:false,quotes:false},p||{},true);var g=[];var l=[];var f=[];var j=d.config.processData;function k(t,r){var q=r.exportFields||Object.keys(r.dataFieldsMap);for(e=0;e<q.length;e++){var s=q[e];var u=r.dataFieldsTitlesMap[s];l.push(u)}if(j){return d.handleCallback(j,t,r)}return t}function i(q){if(typeof q==="string"){if(h.escape){q=q.replace('"','""')}if(h.quotes){q=['"',q,'"'].join("")}}return q}h.processData=k;h.data=h.data!==undefined?d.processData(h):d.getChartData(h);if(h.withHeader){f=[];for(e in l){if(!isNaN(e)){f.push(i(l[e]))}}g.push(f)}for(o in h.data){f=[];if(!isNaN(o)){for(e in l){if(!isNaN(e)){var e=l[e];var m=h.data[o][e];if(m==null){m=""}else{if(h.stringify){m=String(m)}else{m=m}}f.push(i(m))}}g.push(f)}}d.handleCallback(n,g,h);return g},toByteArray:function(p,o){var n=d.deepMerge({},p||{});var l=(typeof Uint8Array!=="undefined")?Uint8Array:Array;var k="+".charCodeAt(0);var f="/".charCodeAt(0);var h="0".charCodeAt(0);var g="a".charCodeAt(0);var m="A".charCodeAt(0);var j=i(n.data);function e(q){var r=q.charCodeAt(0);if(r===k){return 62}if(r===f){return 63}if(r<h){return -1}if(r<h+10){return r-h+26+26}if(r<m+26){return r-m}if(r<g+26){return r-g+26}}function i(q){var u,t,r,v,s,w;if(q.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var x=q.length;s="="===q.charAt(x-2)?2:"="===q.charAt(x-1)?1:0;w=new l(q.length*3/4-s);r=s>0?q.length-4:q.length;var z=0;function y(A){w[z++]=A}for(u=0,t=0;u<r;u+=4,t+=3){v=(e(q.charAt(u))<<18)|(e(q.charAt(u+1))<<12)|(e(q.charAt(u+2))<<6)|e(q.charAt(u+3));y((v&16711680)>>16);y((v&65280)>>8);y(v&255)}if(s===2){v=(e(q.charAt(u))<<2)|(e(q.charAt(u+1))>>4);y(v&255)}else{if(s===1){v=(e(q.charAt(u))<<10)|(e(q.charAt(u+1))<<4)|(e(q.charAt(u+2))>>2);y((v>>8)&255);y(v&255)}}return w}d.handleCallback(o,j,n);return j},handleCallback:function(g){var e,f=Array();if(g&&g instanceof Function){for(e=0;e<arguments.length;e++){if(e>0){f.push(arguments[e])}}return g.apply(d,f)}},handleLog:function(e){if(d.config.debug===true){console.log(e)}},handleNamespace:function(g,j){var f=d.config.scope||window;var i=false;var h=Number(new Date());var k;i=!!(g in f);function e(){var l=Number(new Date());i=!!(g in f);if(g=="pdfMake"&&i){i=f.pdfMake.vfs}if(i){clearTimeout(k);j.cb.apply(j.scope,j.args);d.handleLog(['AmCharts [export]: Namespace "',g,'" showed up in: ',String(f)].join(""))}else{if(l-h<d.libs.loadTimeout){k=setTimeout(e,250)}else{d.handleLog(['AmCharts [export]: Gave up waiting for "',g,'" in: ',String(f)].join(""))}}}if(!i){d.handleLog(['AmCharts [export]: Could not find "',g,'" in: ',String(f)].join(""));e()}return i},handleBorder:function(g){if(d.config.border instanceof Object){var e=d.deepMerge(d.defaults.fabric.border,g.border||{},true);var f=new fabric.Rect();e.width=d.setup.fabric.width-e.strokeWidth;e.height=d.setup.fabric.height-e.strokeWidth;f.set(e);d.setup.fabric.add(f)}},handleDropbox:function(h){if(d.drawing.enabled){h.preventDefault();h.stopPropagation();if(h.type=="dragover"){d.setup.wrapper.setAttribute("class",d.setup.chart.classNamePrefix+"-export-canvas active dropbox")}else{d.setup.wrapper.setAttribute("class",d.setup.chart.classNamePrefix+"-export-canvas active");if(h.type=="drop"&&h.dataTransfer.files.length){for(var g=0;g<h.dataTransfer.files.length;g++){var f=new FileReader();f.onloadend=(function(e){return function(){d.drawing.handler.add({url:f.result,top:h.layerY-(e*10),left:h.layerX-(e*10)})}})(g);f.readAsDataURL(h.dataTransfer.files[g])}}}}},handleReady:function(j){var h,g;var i=this;var e=Number(new Date());i.handleCallback(j,"data",false);for(filename in i.libs.namespaces){var f=i.libs.namespaces[filename];(function(k){var l=setInterval(function(){var m=Number(new Date());if(m-e>i.libs.loadTimeout||k in window){clearTimeout(l);i.handleCallback(j,k,m-e>i.libs.loadTimeout)}},AmCharts.updateRate)})(f)}},getChartData:function(h){var k=d.deepMerge({data:[],titles:{},dateFields:[],dataFields:[],dataFieldsMap:{},exportTitles:d.config.exportTitles,exportFields:d.config.exportFields,exportSelection:d.config.exportSelection,columnNames:d.config.columnNames},h||{},true);var l,s,r,q;var n=["valueField","openField","closeField","highField","lowField","xField","yField"];var v;function e(A,B,z){function y(D,C){if(k.dataFields.indexOf(D)!=-1){return y([D,".",C].join(""))}return D}if(A&&k.exportTitles&&d.setup.chart.type!="gantt"){l=y(A,z);k.dataFieldsMap[l]=A;k.dataFields.push(l);k.titles[l]=B||l}}if(k.data.length==0){if(d.setup.chart.type=="stock"){k.data=d.cloneObject(d.setup.chart.mainDataSet.dataProvider);e(d.setup.chart.mainDataSet.categoryField);k.dateFields.push(d.setup.chart.mainDataSet.categoryField);for(s=0;s<d.setup.chart.mainDataSet.fieldMappings.length;s++){var j=d.setup.chart.mainDataSet.fieldMappings[s];for(r=0;r<d.setup.chart.panels.length;r++){var o=d.setup.chart.panels[r];for(q=0;q<o.stockGraphs.length;q++){var g=o.stockGraphs[q];for(i4=0;i4<n.length;i4++){if(g[n[i4]]==j.toField){e(j.fromField,g.title,n[i4])}}}}}if(d.setup.chart.comparedGraphs.length){v=[];for(s=0;s<k.data.length;s++){v.push(k.data[s][d.setup.chart.mainDataSet.categoryField])}for(s=0;s<d.setup.chart.comparedGraphs.length;s++){var g=d.setup.chart.comparedGraphs[s];for(r=0;r<g.dataSet.dataProvider.length;r++){var p=g.dataSet.categoryField;var i=g.dataSet.dataProvider[r][p];var u=v.indexOf(i);if(u!=-1){for(q=0;q<g.dataSet.fieldMappings.length;q++){var j=g.dataSet.fieldMappings[q];var l=g.dataSet.id+"_"+j.toField;k.data[u][l]=g.dataSet.dataProvider[r][j.fromField];if(!k.titles[l]){e(l,g.dataSet.title)}}}}}}}else{if(d.setup.chart.type=="gantt"){e(d.setup.chart.categoryField);var f=d.setup.chart.segmentsField;for(s=0;s<d.setup.chart.dataProvider.length;s++){var m=d.setup.chart.dataProvider[s];if(m[f]){for(r=0;r<m[f].length;r++){m[f][r][d.setup.chart.categoryField]=m[d.setup.chart.categoryField];k.data.push(m[f][r])}}}for(s=0;s<d.setup.chart.graphs.length;s++){var g=d.setup.chart.graphs[s];for(r=0;r<n.length;r++){var w=n[r];var t=g[w];var x=g.title;e(t,g.title,w)}}}else{if(["pie","funnel"].indexOf(d.setup.chart.type)!=-1){k.data=d.setup.chart.dataProvider;e(d.setup.chart.titleField);k.dateFields.push(d.setup.chart.titleField);e(d.setup.chart.valueField)}else{if(d.setup.chart.type!="map"){k.data=d.setup.chart.dataProvider;if(d.setup.chart.categoryAxis){e(d.setup.chart.categoryField,d.setup.chart.categoryAxis.title);if(d.setup.chart.categoryAxis.parseDates!==false){k.dateFields.push(d.setup.chart.categoryField)}}for(s=0;s<d.setup.chart.graphs.length;s++){var g=d.setup.chart.graphs[s];for(r=0;r<n.length;r++){var w=n[r];var t=g[w];e(t,g.title,w)}}}}}}}return d.processData(k)},getAnnotations:function(f,j){var e=d.deepMerge({},f||{},true);var g;var h=[];for(g=0;g<d.setup.fabric._objects.length;g++){if(!d.setup.fabric._objects[g].isCoreElement){var i=d.setup.fabric._objects[g].toJSON();d.handleCallback(e.reviver,i,g);h.push(i)}}d.handleCallback(j,h);return h},setAnnotations:function(f,g){var e=d.deepMerge({data:[]},f||{},true);fabric.util.enlivenObjects(e.data,function(h){h.forEach(function(j,i){d.handleCallback(e.reviver,j,i);d.setup.fabric.add(j)});d.handleCallback(g,e)});return e.data},processData:function(o){var i=d.deepMerge({data:[],titles:{},dateFields:[],dataFields:[],dataFieldsMap:{},dataFieldsTitlesMap:{},dataDateFormat:d.setup.chart.dataDateFormat,dateFormat:d.config.dateFormat||d.setup.chart.dataDateFormat||"YYYY-MM-DD",exportTitles:d.config.exportTitles,exportFields:d.config.exportFields,exportSelection:d.config.exportSelection,columnNames:d.config.columnNames,processData:d.config.processData},o||{},true);var f,e;if(i.data.length){for(f=0;f<i.data.length;f++){for(e in i.data[f]){if(i.dataFields.indexOf(e)==-1){i.dataFields.push(e);i.dataFieldsMap[e]=e}}}if(i.exportFields!==undefined){i.dataFields=i.exportFields.filter(function(p){return i.dataFields.indexOf(p)!=-1})}var g=[];for(f=0;f<i.data.length;f++){var h={};var m=false;for(e=0;e<i.dataFields.length;e++){var l=i.dataFields[e];var n=i.dataFieldsMap[l];var j=(i.columnNames&&i.columnNames[l])||i.titles[l]||l;var k=i.data[f][n];if(k==null){k=undefined}if(i.exportTitles&&d.setup.chart.type!="gantt"){if(j in h){j+=["( ",l," )"].join("")}}if(i.dateFields.indexOf(n)!=-1){if(i.dataDateFormat&&(k instanceof String||typeof k=="string")){k=AmCharts.stringToDate(k,i.dataDateFormat)}else{if(i.dateFormat&&(k instanceof Number||typeof k=="number")){k=new Date(k)}}if(i.exportSelection){if(k instanceof Date){if(k<c.startDate||k>c.endDate){m=true}}else{if(f<c.startIndex||f>c.endIndex){m=true}}}if(i.dateFormat&&i.dateFormat!="dateObject"&&k instanceof Date){k=AmCharts.formatDate(k,i.dateFormat)}}i.dataFieldsTitlesMap[n]=j;h[j]=k}if(!m){g.push(h)}}i.data=g}if(i.processData!==undefined){i.data=d.handleCallback(i.processData,i.data,i)}return i.data},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},createMenu:function(h,f){var i;var e=[];function g(q,k){var n,l,r=document.createElement("ul");for(n=0;n<q.length;n++){var y=typeof q[n]==="string"?{format:q[n]}:q[n];var x=document.createElement("li");var v=document.createElement("a");var p=document.createElement("img");var w=document.createElement("span");var m=String(y.action?y.action:y.format).toLowerCase();y.format=String(y.format).toUpperCase();x.addEventListener("mouseleave",function(z){this.classList.remove("active")});v.addEventListener("focus",function(B){if(!d.setup.hasTouch){d.setup.focusedMenuItem=this;var A=this.parentNode;if(A.tagName!="UL"){A=A.parentNode}var z=A.getElementsByTagName("li");for(n=0;n<z.length;n++){z[n].classList.remove("active")}this.parentNode.classList.add("active");this.parentNode.parentNode.parentNode.classList.add("active")}});if(d.config.formats[y.format]){y=d.deepMerge({label:y.icon?"":y.format,format:y.format,mimeType:d.config.formats[y.format].mimeType,extension:d.config.formats[y.format].extension,capture:d.config.formats[y.format].capture,action:d.config.action,fileName:d.config.fileName},y)}else{if(!y.label){y.label=y.label?y.label:d.i18l("menu.label."+m)}}if(["CSV","JSON","XLSX"].indexOf(y.format)!=-1&&["map","gauge"].indexOf(d.setup.chart.type)!=-1){continue}else{if(!d.setup.hasBlob&&y.format!="UNDEFINED"){if(y.mimeType&&y.mimeType.split("/")[0]!="image"&&y.mimeType!="text/plain"){continue}}}if(y.action=="draw"){if(d.config.fabric.drawing.enabled){y.menu=y.menu?y.menu:d.config.fabric.drawing.menu;y.click=(function(z){return function(){this.capture(z,function(){this.createMenu(z.menu)})}})(y)}else{y.menu=[]}}else{if(!y.populated&&y.action&&y.action.indexOf("draw.")!=-1){var u=y.action.split(".")[1];var t=y[u]||d.config.fabric.drawing[u]||[];y.menu=[];y.populated=true;for(l=0;l<t.length;l++){var o={label:t[l]};if(u=="shapes"){var s=t[l].indexOf("//")==-1;var j=(s?d.config.path+"shapes/":"")+t[l];o.action="add";o.url=j;o.icon=j;o.ignore=s;o["class"]="export-drawing-shape"}else{if(u=="colors"){o.style="background-color: "+t[l];o.action="change";o.color=t[l];o["class"]="export-drawing-color"}else{if(u=="widths"){o.action="change";o.width=t[l];o.label=document.createElement("span");o.label.style.width=d.numberToPx(t[l]);o.label.style.height=d.numberToPx(t[l]);o["class"]="export-drawing-width"}else{if(u=="opacities"){o.style="opacity: "+t[l];o.action="change";o.opacity=t[l];o.label=(t[l]*100)+"%";o["class"]="export-drawing-opacity"}else{if(u=="modes"){o.label=d.i18l("menu.label.draw.modes."+t[l]);o.click=(function(z){return function(){d.drawing.mode=z}})(t[l]);o["class"]="export-drawing-mode"}}}}}y.menu.push(o)}}else{if(!y.click&&!y.menu&&!y.items){if(d.drawing.handler[m] instanceof Function){y.action=m;y.click=(function(z){return function(){this.drawing.handler[z.action](z);if(z.action!="cancel"){this.createMenu(this.config.fabric.drawing.menu)}}})(y)}else{if(d.drawing.enabled){y.click=(function(z){return function(){if(this.config.drawing.autoClose){this.drawing.handler.done()}this["to"+z.format](z,function(A){if(z.action=="download"){this.download(A,z.mimeType,[z.fileName,z.extension].join("."))}})}})(y)}else{if(y.format!="UNDEFINED"){y.click=(function(z){return function(){if(z.capture||z.action=="print"||z.format=="PRINT"){this.capture(z,function(){this.drawing.handler.done();this["to"+z.format](z,function(A){if(z.action=="download"){this.download(A,z.mimeType,[z.fileName,z.extension].join("."));this.createMenu(this.config.menu)}})})}else{if(this["to"+z.format]){this["to"+z.format](z,function(A){this.download(A,z.mimeType,[z.fileName,z.extension].join("."));this.createMenu(this.config.menu)})}else{throw new Error("Invalid format. Could not determine output type.")}}}})(y)}}}}}}if(y.menu!==undefined&&!y.menu.length){continue}v.setAttribute("href","#");v.addEventListener("click",(function(A,z){return function(C){C.preventDefault();var B=[C,z];if((z.action=="draw"||z.format=="PRINT"||(z.format!="UNDEFINED"&&z.capture))&&!d.drawing.enabled){if(!isNaN(z.delay)||!isNaN(d.config.delay)){z.delay=!isNaN(z.delay)?z.delay:d.config.delay;d.delay(z,A);return}}A.apply(d,B)}})(y.click||function(z){z.preventDefault()},y));if(d.setup.hasTouch&&x.classList){v.addEventListener("click",(function(z){return function(F){F.preventDefault();var K=z.elements.li;var A=C(K);var J=E(K);var H=I(K);function C(O){var M=O.parentNode.parentNode;var N=M.classList;if(M.tagName=="LI"&&N.contains("active")){return true}return false}function E(P){var O=P.parentNode.children;for(n=0;n<O.length;n++){var M=O[n];var N=M.classList;if(M!==P&&N.contains("active")){N.remove("active");return true}}return false}function I(M){return M.getElementsByTagName("ul").length>0}function B(M){return M.classList.contains("export-main")||M.classList.contains("export-drawing")}if(B(K)||!H){d.setup.menu.classList.toggle("active")}if(!A||!H){while(e.length){var D=e.pop();var G=B(D);var L=D!==K;if(G){if(!H){D.classList.remove("active")}}else{if(L){D.classList.remove("active")}}}}e.push(K);if(H){K.classList.toggle("active")}}})(y))}x.appendChild(v);if(d.isElement(y.label)){w.appendChild(y.label)}else{w.innerHTML=y.label}if(y["class"]){x.className=y["class"]}if(y.style){x.setAttribute("style",y.style)}if(y.icon){p.setAttribute("src",(!y.ignore&&y.icon.slice(0,10).indexOf("//")==-1?c.pathToImages:"")+y.icon);v.appendChild(p)}if(y.label){v.appendChild(w)}if(y.title){v.setAttribute("title",y.title)}if(d.config.menuReviver){x=d.config.menuReviver.apply(d,[y,x])}y.elements={li:x,a:v,img:p,span:w};if((y.menu||y.items)&&y.action!="draw"){if(g(y.menu||y.items,x).childNodes.length){r.appendChild(x)}}else{r.appendChild(x)}}if(r.childNodes.length){k.appendChild(r)}return r}if(!f){if(typeof d.config.divId=="string"){d.config.divId=f=document.getElementById(d.config.divId)}else{if(d.isElement(d.config.divId)){f=d.config.divId}else{f=d.setup.chart.containerDiv}}}if(d.isElement(d.setup.menu)){d.setup.menu.innerHTML=""}else{d.setup.menu=document.createElement("div")}d.setup.menu.setAttribute("class",d.setup.chart.classNamePrefix+"-export-menu "+d.setup.chart.classNamePrefix+"-export-menu-"+d.config.position+" amExportButton");if(d.config.menuWalker){g=d.config.menuWalker}g.apply(this,[h,d.setup.menu]);if(d.setup.menu.childNodes.length){f.appendChild(d.setup.menu)}return d.setup.menu},delay:function(g,l){var e=d.deepMerge({delay:3,precision:2},g||{});var i,h,k=Number(new Date());var j=d.createMenu([{label:d.i18l("capturing.delayed.menu.label").replace("{{duration}}",AmCharts.toFixed(e.delay,e.precision)),title:d.i18l("capturing.delayed.menu.title"),"class":"export-delayed-capturing",click:function(){clearTimeout(i);clearTimeout(h);d.createMenu(d.config.menu)}}]);var f=j.getElementsByTagName("a")[0];i=setInterval(function(){var m=e.delay-(Number(new Date())-k)/1000;if(m<=0){clearTimeout(i);if(e.action!="draw"){d.createMenu(d.config.menu)}}else{if(f){f.innerHTML=d.i18l("capturing.delayed.menu.label").replace("{{duration}}",AmCharts.toFixed(m,2))}}},AmCharts.updateRate);h=setTimeout(function(){l.apply(d,arguments)},e.delay*1000)},migrateSetup:function(e){var f={enabled:true,migrated:true,libs:{autoLoad:true},menu:[]};function g(h){var i;for(i in h){var j=h[i];if(i.slice(0,6)=="export"&&j){f.menu.push(i.slice(6))}else{if(i=="userCFG"){g(j)}else{if(i=="menuItems"){f.menu=j}else{if(i=="libs"){f.libs=j}else{if(typeof i=="string"){f[i]=j}}}}}}}g(e);return f},clear:function(){d.setup=undefined;if(d.docListener){document.removeEventListener("keydown",d.docListener)}var g=d.listenersToRemove;if(g){for(var f=0;f<g.length;f++){var e=g[f];e.node.removeEventListener(e.event,e.method)}}d.listenersToRemove=[]},loadListeners:function(){function e(f){if(f){f.set({top:f.top+10,left:f.left+10});d.setup.fabric.add(f)}}if(d.config.keyListener&&d.config.keyListener!="attached"){d.docListener=function(l){var m=d.drawing.buffer.target;var n=[37,38,39,40,13,9,27];var h=["top-left","bottom-left"].indexOf(d.config.position)!=-1;var i=["top-right","bottom-right"].indexOf(d.config.position)!=-1;function g(s,q){for(i1=0;i1<s.length;i1++){var r=s[i1];r.parentNode.classList.remove("active");if(i1==0&&!q){r.focus()}}}function k(q){if(d.setup.focusedMenuItem&&d.setup.focusedMenuItem.nextSibling){d.setup.focusedMenuItem.parentNode.classList.add("active");g(d.setup.focusedMenuItem.nextSibling.getElementsByTagName("a"),q)}}function j(q){if(d.setup.focusedMenuItem&&d.setup.focusedMenuItem.parentNode.parentNode.parentNode){d.setup.focusedMenuItem.parentNode.classList.add("active");g(d.setup.focusedMenuItem.parentNode.parentNode.parentNode.getElementsByTagName("a"),q)}}function p(q){if(d.setup.focusedMenuItem&&d.setup.focusedMenuItem.parentNode.nextSibling){d.setup.focusedMenuItem.parentNode.classList.remove("active");g(d.setup.focusedMenuItem.parentNode.nextSibling.getElementsByTagName("a"),q)}}function o(q){if(d.setup.focusedMenuItem&&d.setup.focusedMenuItem.parentNode.previousSibling){d.setup.focusedMenuItem.parentNode.classList.remove("active");g(d.setup.focusedMenuItem.parentNode.previousSibling.getElementsByTagName("a"),q)}}function f(){function q(r){if(d.isElement(r)){r.blur();if(r.parentNode){r.parentNode.classList.remove("active")}if(!r.classList.contains("amExportButton")){q(r.parentNode)}}}if(d.setup.focusedMenuItem){q(d.setup.focusedMenuItem);d.setup.focusedMenuItem=undefined}}if(d.setup.focusedMenuItem&&n.indexOf(l.keyCode)!=-1){if(l.keyCode==9){if(!d.setup.focusedMenuItem.nextSibling){d.setup.focusedMenuItem.parentNode.classList.remove("active");if(!d.setup.focusedMenuItem.parentNode.nextSibling){d.setup.focusedMenuItem.parentNode.classList.remove("active");d.setup.focusedMenuItem.parentNode.parentNode.parentNode.classList.remove("active")}}else{if(l.shiftKey){d.setup.focusedMenuItem.parentNode.classList.remove("active")}}return}if(l.keyCode==13&&d.setup.focusedMenuItem.nextSibling){k()}if(l.keyCode==37){if(i){k()}else{j()}}if(l.keyCode==39){if(i){j()}else{k()}}if(l.keyCode==40){p()}if(l.keyCode==38){o()}if(l.keyCode==27){f()}}if((l.keyCode==8||l.keyCode==46)&&m){l.preventDefault();d.setup.fabric.remove(m)}else{if(l.keyCode==27&&d.drawing.enabled){l.preventDefault();if(d.drawing.buffer.isSelected){d.setup.fabric.discardActiveObject()}else{d.drawing.handler.done()}}else{if(l.keyCode==67&&(l.metaKey||l.ctrlKey)&&m){d.drawing.buffer.copy=m}else{if(l.keyCode==88&&(l.metaKey||l.ctrlKey)&&m){d.drawing.buffer.copy=m;d.setup.fabric.remove(m)}else{if(l.keyCode==86&&(l.metaKey||l.ctrlKey)){if(d.drawing.buffer.copy){e(d.drawing.buffer.copy.clone(e))}}else{if(l.keyCode==90&&(l.metaKey||l.ctrlKey)){l.preventDefault();if(l.shiftKey){d.drawing.handler.redo()}else{d.drawing.handler.undo()}}}}}}}};d.config.keyListener="attached";document.addEventListener("keydown",d.docListener)}if(d.config.fileListener){d.setup.chart.containerDiv.addEventListener("dragover",d.handleDropbox);d.setup.chart.containerDiv.addEventListener("dragleave",d.handleDropbox);d.setup.chart.containerDiv.addEventListener("drop",d.handleDropbox)}},init:function(){clearTimeout(b);b=setInterval(function(){if(d.setup&&d.setup.chart.containerDiv){clearTimeout(b);if(d.config.enabled){d.setup.chart.AmExport=d;if(d.config.overflow){d.setup.chart.div.style.overflow="visible"}d.loadListeners();d.createMenu(d.config.menu);d.handleReady(d.config.onReady)}}},AmCharts.updateRate)},construct:function(){d.drawing.handler.cancel=d.drawing.handler.done;try{d.setup.hasBlob=!!new Blob}catch(f){}window.safari=window.safari?window.safari:{};d.defaults.fabric.drawing.fontSize=d.setup.chart.fontSize||11;d.config.drawing=d.deepMerge(d.defaults.fabric.drawing,d.config.drawing||{},true);if(d.config.border){d.config.border=d.deepMerge(d.defaults.fabric.border,d.config.border||{},true)}d.deepMerge(d.defaults.fabric,d.config,true);d.deepMerge(d.defaults.fabric,d.config.fabric||{},true);d.deepMerge(d.defaults.pdfMake,d.config,true);d.deepMerge(d.defaults.pdfMake,d.config.pdfMake||{},true);d.deepMerge(d.libs,d.config.libs||{},true);d.config.drawing=d.defaults.fabric.drawing;d.config.fabric=d.defaults.fabric;d.config.pdfMake=d.defaults.pdfMake;d.config=d.deepMerge(d.defaults,d.config,true);if(d.config.fabric.drawing.enabled){if(d.config.fabric.drawing.menu===undefined){d.config.fabric.drawing.menu=[];d.deepMerge(d.config.fabric.drawing.menu,[{"class":"export-drawing",menu:[{label:d.i18l("menu.label.draw.add"),menu:[{label:d.i18l("menu.label.draw.shapes"),action:"draw.shapes"},{label:d.i18l("menu.label.draw.text"),action:"text"}]},{label:d.i18l("menu.label.draw.change"),menu:[{label:d.i18l("menu.label.draw.modes"),action:"draw.modes"},{label:d.i18l("menu.label.draw.colors"),action:"draw.colors"},{label:d.i18l("menu.label.draw.widths"),action:"draw.widths"},{label:d.i18l("menu.label.draw.opacities"),action:"draw.opacities"},"UNDO","REDO"]},{label:d.i18l("menu.label.save.image"),menu:["PNG","JPG","SVG","PDF"]},"PRINT","CANCEL"]}])}}if(d.config.menu===undefined){d.config.menu=[];d.deepMerge(d.config,{menu:[{"class":"export-main",menu:[{label:d.i18l("menu.label.save.image"),menu:["PNG","JPG","SVG","PDF"]},{label:d.i18l("menu.label.save.data"),menu:["CSV","XLSX","JSON"]},{label:d.i18l("menu.label.draw"),action:"draw",menu:d.config.fabric.drawing.menu},{format:"PRINT",label:d.i18l("menu.label.print")}]}]})}if(!d.libs.path){d.libs.path=d.config.path+"libs/"}if(d.isSupported()){d.loadDependencies(d.libs.resources,d.libs.reload);d.setup.chart.addClassNames=true;d.setup.chart[d.name]=d;d.init()}}};if(a){d.config=a}else{if(d.setup.chart[d.name]){d.config=d.setup.chart[d.name]}else{if(d.setup.chart.amExport||d.setup.chart.exportConfig){d.config=d.migrateSetup(d.setup.chart.amExport||d.setup.chart.exportConfig)}else{return}}}d.construct();return d.deepMerge(this,d)}})();AmCharts.addInitHandler(function(a){new AmCharts["export"](a)},["pie","serial","xy","funnel","radar","gauge","stock","map","gantt"]);