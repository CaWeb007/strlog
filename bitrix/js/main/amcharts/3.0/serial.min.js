AmCharts.AmSerialChart=AmCharts.Class({inherits:AmCharts.AmRectangularChart,construct:function(){AmCharts.AmSerialChart.base.construct.call(this);this.createEvents("changed");this.columnSpacing=5;this.columnSpacing3D=0;this.columnWidth=0.8;this.updateScrollbar=!0;var b=new AmCharts.CategoryAxis;b.chart=this;this.categoryAxis=b;this.chartType="serial";this.zoomOutOnDataUpdate=!0;this.skipZoom=!1;this.minSelectedTime=0},initChart:function(){AmCharts.AmSerialChart.base.initChart.call(this);this.updateCategoryAxis(this.categoryAxis,this.rotate,"categoryAxis");this.dataChanged&&(this.updateData(),this.dataChanged=!1,this.dispatchDataUpdated=!0);var e=this.chartCursor;e&&e.updateData();var e=this.countColumns(),d=this.graphs,f;for(f=0;f<d.length;f++){d[f].columnCount=e}this.updateScrollbar=!0;this.drawChart();this.autoMargins&&!this.marginsUpdated&&(this.marginsUpdated=!0,this.measureMargins())},validateData:function(b){this.marginsUpdated=!1;this.zoomOutOnDataUpdate&&!b&&(this.endTime=this.end=this.startTime=this.start=NaN);AmCharts.AmSerialChart.base.validateData.call(this)},drawChart:function(){AmCharts.AmSerialChart.base.drawChart.call(this);var e=this.chartData;if(AmCharts.ifArray(e)){var d=this.chartScrollbar;d&&d.draw();if(0<this.realWidth&&0<this.realHeight){var e=e.length-1,f,d=this.categoryAxis;if(d.parseDates&&!d.equalSpacing){if(d=this.startTime,f=this.endTime,isNaN(d)||isNaN(f)){d=this.firstTime,f=this.lastTime}}else{if(d=this.start,f=this.end,isNaN(d)||isNaN(f)){d=0,f=e}}this.endTime=this.startTime=this.end=this.start=void 0;this.zoom(d,f)}}else{this.cleanChart()}this.dispDUpd();this.chartCreated=!0},cleanChart:function(){AmCharts.callMethod("destroy",[this.valueAxes,this.graphs,this.categoryAxis,this.chartScrollbar,this.chartCursor])},updateCategoryAxis:function(e,d,f){e.id=f;e.rotate=d;e.axisRenderer=AmCharts.RecAxis;e.guideFillRenderer=AmCharts.RecFill;e.axisItemRenderer=AmCharts.RecItem;e.setOrientation(!this.rotate);e.x=this.marginLeftReal;e.y=this.marginTopReal;e.dx=this.dx;e.dy=this.dy;e.width=this.plotAreaWidth-1;e.height=this.plotAreaHeight-1;e.viW=this.plotAreaWidth-1;e.viH=this.plotAreaHeight-1;e.viX=this.marginLeftReal;e.viY=this.marginTopReal;e.marginsChanged=!0},updateValueAxes:function(){AmCharts.AmSerialChart.base.updateValueAxes.call(this);var f=this.valueAxes,e;for(e=0;e<f.length;e++){var h=f[e],g=this.rotate;h.rotate=g;h.setOrientation(g);g=this.categoryAxis;if(!g.startOnAxis||g.parseDates){h.expandMinMax=!0}}},updateData:function(){this.parseData();var e=this.graphs,d,f=this.chartData;for(d=0;d<e.length;d++){e[d].data=f}0<f.length&&(this.firstTime=this.getStartTime(f[0].time),this.lastTime=this.getEndTime(f[f.length-1].time))},getStartTime:function(d){var c=this.categoryAxis;return AmCharts.resetDateToMin(new Date(d),c.minPeriod,1,c.firstDayOfWeek).getTime()},getEndTime:function(d){var c=AmCharts.extractPeriod(this.categoryAxis.minPeriod);return AmCharts.changeDate(new Date(d),c.period,c.count,!0).getTime()-1},updateMargins:function(){AmCharts.AmSerialChart.base.updateMargins.call(this);var b=this.chartScrollbar;b&&(this.getScrollbarPosition(b,this.rotate,this.categoryAxis.position),this.adjustMargins(b,this.rotate))},updateScrollbars:function(){this.updateChartScrollbar(this.chartScrollbar,this.rotate)},zoom:function(e,d){var f=this.categoryAxis;f.parseDates&&!f.equalSpacing?this.timeZoom(e,d):this.indexZoom(e,d)},timeZoom:function(i,h){var p=this.maxSelectedTime;isNaN(p)||(h!=this.endTime&&h-i>p&&(i=h-p,this.updateScrollbar=!0),i!=this.startTime&&h-i>p&&(h=i+p,this.updateScrollbar=!0));var o=this.minSelectedTime;if(0<o&&h-i<o){var n=Math.round(i+(h-i)/2),o=Math.round(o/2);i=n-o;h=n+o}var l=this.chartData,n=this.categoryAxis;if(AmCharts.ifArray(l)&&(i!=this.startTime||h!=this.endTime)){var j=n.minDuration(),o=this.firstTime,f=this.lastTime;i||(i=o,isNaN(p)||(i=f-p));h||(h=f);i>f&&(i=f);h<o&&(h=o);i<o&&(i=o);h>f&&(h=f);h<i&&(h=i+j);h-i<j/5&&(h<f?h=i+j/5:i=h-j/5);this.startTime=i;this.endTime=h;p=l.length-1;j=this.getClosestIndex(l,"time",i,!0,0,p);l=this.getClosestIndex(l,"time",h,!1,j,p);n.timeZoom(i,h);n.zoom(j,l);this.start=AmCharts.fitToBounds(j,0,p);this.end=AmCharts.fitToBounds(l,0,p);this.zoomAxesAndGraphs();this.zoomScrollbar();i!=o||h!=f?this.showZB(!0):this.showZB(!1);this.updateColumnsDepth();this.dispatchTimeZoomEvent()}},indexZoom:function(f,e){var h=this.maxSelectedSeries;isNaN(h)||(e!=this.end&&e-f>h&&(f=e-h,this.updateScrollbar=!0),f!=this.start&&e-f>h&&(e=f+h,this.updateScrollbar=!0));if(f!=this.start||e!=this.end){var g=this.chartData.length-1;isNaN(f)&&(f=0,isNaN(h)||(f=g-h));isNaN(e)&&(e=g);e<f&&(e=f);e>g&&(e=g);f>g&&(f=g-1);0>f&&(f=0);this.start=f;this.end=e;this.categoryAxis.zoom(f,e);this.zoomAxesAndGraphs();this.zoomScrollbar();0!==f||e!=this.chartData.length-1?this.showZB(!0):this.showZB(!1);this.updateColumnsDepth();this.dispatchIndexZoomEvent()}},updateGraphs:function(){AmCharts.AmSerialChart.base.updateGraphs.call(this);var e=this.graphs,d;for(d=0;d<e.length;d++){var f=e[d];f.columnWidthReal=this.columnWidth;f.categoryAxis=this.categoryAxis}},updateColumnsDepth:function(){var g,f=this.graphs,j;AmCharts.remove(this.columnsSet);this.columnsArray=[];for(g=0;g<f.length;g++){j=f[g];var i=j.columnsArray;if(i){var h;for(h=0;h<i.length;h++){this.columnsArray.push(i[h])}}}this.columnsArray.sort(this.compareDepth);if(0<this.columnsArray.length){f=this.container.set();this.columnSet.push(f);for(g=0;g<this.columnsArray.length;g++){f.push(this.columnsArray[g].column.set)}j&&f.translate(j.x,j.y);this.columnsSet=f}},compareDepth:function(d,c){return d.depth>c.depth?1:-1},zoomScrollbar:function(){var d=this.chartScrollbar,c=this.categoryAxis;d&&this.updateScrollbar&&(c.parseDates&&!c.equalSpacing?d.timeZoom(this.startTime,this.endTime):d.zoom(this.start,this.end),this.updateScrollbar=!0)},updateTrendLines:function(){var e=this.trendLines,d;for(d=0;d<e.length;d++){var f=e[d];f.chart=this;f.valueAxis||(f.valueAxis=this.valueAxes[0]);f.categoryAxis=this.categoryAxis}},zoomAxesAndGraphs:function(){if(!this.scrollbarOnly){var d=this.valueAxes,c;for(c=0;c<d.length;c++){d[c].zoom(this.start,this.end)}d=this.graphs;for(c=0;c<d.length;c++){d[c].zoom(this.start,this.end)}this.zoomTrendLines();(c=this.chartCursor)&&c.zoom(this.start,this.end,this.startTime,this.endTime)}},countColumns:function(){var r=0,q=this.valueAxes.length,p=this.graphs.length,o,n,j=!1,i,f;for(f=0;f<q;f++){n=this.valueAxes[f];var h=n.stackType;if("100%"==h||"regular"==h){for(j=!1,i=0;i<p;i++){o=this.graphs[i],o.hidden||o.valueAxis!=n||"column"!=o.type||(!j&&o.stackable&&(r++,j=!0),!o.stackable&&o.clustered&&r++,o.columnIndex=r-1,o.clustered||(o.columnIndex=0))}}if("none"==h||"3d"==h){for(i=0;i<p;i++){o=this.graphs[i],!o.hidden&&o.valueAxis==n&&"column"==o.type&&o.clustered&&(o.columnIndex=r,r++)}}if("3d"==h){for(f=0;f<p;f++){o=this.graphs[f],o.depthCount=r}r=1}}return r},parseData:function(){AmCharts.AmSerialChart.base.parseData.call(this);this.parseSerialData()},getCategoryIndexByValue:function(f){var e=this.chartData,h,g;for(g=0;g<e.length;g++){e[g].category==f&&(h=g)}return h},handleCursorChange:function(b){this.updateLegendValues(b.index)},handleCursorZoom:function(b){this.updateScrollbar=!0;this.zoom(b.start,b.end)},handleScrollbarZoom:function(b){this.updateScrollbar=!1;this.zoom(b.start,b.end)},dispatchTimeZoomEvent:function(){if(this.prevStartTime!=this.startTime||this.prevEndTime!=this.endTime){var e={type:"zoomed"};e.startDate=new Date(this.startTime);e.endDate=new Date(this.endTime);e.startIndex=this.start;e.endIndex=this.end;this.startIndex=this.start;this.endIndex=this.end;this.startDate=e.startDate;this.endDate=e.endDate;this.prevStartTime=this.startTime;this.prevEndTime=this.endTime;var d=this.categoryAxis,f=AmCharts.extractPeriod(d.minPeriod).period,d=d.dateFormatsObject[f];e.startValue=AmCharts.formatDate(e.startDate,d);e.endValue=AmCharts.formatDate(e.endDate,d);e.chart=this;e.target=this;this.fire(e.type,e)}},dispatchIndexZoomEvent:function(){if(this.prevStartIndex!=this.start||this.prevEndIndex!=this.end){this.startIndex=this.start;this.endIndex=this.end;var d=this.chartData;if(AmCharts.ifArray(d)&&!isNaN(this.start)&&!isNaN(this.end)){var c={chart:this,target:this,type:"zoomed"};c.startIndex=this.start;c.endIndex=this.end;c.startValue=d[this.start].category;c.endValue=d[this.end].category;this.categoryAxis.parseDates&&(this.startTime=d[this.start].time,this.endTime=d[this.end].time,c.startDate=new Date(this.startTime),c.endDate=new Date(this.endTime));this.prevStartIndex=this.start;this.prevEndIndex=this.end;this.fire(c.type,c)}}},updateLegendValues:function(f){var e=this.graphs,h;for(h=0;h<e.length;h++){var g=e[h];isNaN(f)?g.currentDataItem=void 0:g.currentDataItem=this.chartData[f].axes[g.valueAxis.id].graphs[g.id]}this.legend&&this.legend.updateValues()},getClosestIndex:function(i,h,p,o,n,l){0>n&&(n=0);l>i.length-1&&(l=i.length-1);var j=n+Math.round((l-n)/2),f=i[j][h];if(1>=l-n){if(o){return n}o=i[l][h];return Math.abs(i[n][h]-p)<Math.abs(o-p)?n:l}return p==f?j:p<f?this.getClosestIndex(i,h,p,o,n,j):this.getClosestIndex(i,h,p,o,j,l)},zoomToIndexes:function(f,e){this.updateScrollbar=!0;var h=this.chartData;if(h){var g=h.length;0<g&&(0>f&&(f=0),e>g-1&&(e=g-1),g=this.categoryAxis,g.parseDates&&!g.equalSpacing?this.zoom(h[f].time,this.getEndTime(h[e].time)):this.zoom(f,e))}},zoomToDates:function(f,e){this.updateScrollbar=!0;var h=this.chartData;if(this.categoryAxis.equalSpacing){var g=this.getClosestIndex(h,"time",f.getTime(),!0,0,h.length),h=this.getClosestIndex(h,"time",e.getTime(),!1,0,h.length);this.zoom(g,h)}else{this.zoom(f.getTime(),e.getTime())}},zoomToCategoryValues:function(d,c){this.updateScrollbar=!0;this.zoom(this.getCategoryIndexByValue(d),this.getCategoryIndexByValue(c))},formatPeriodString:function(Z,Y){if(Y){var X=["value","open","low","high","close"],W="value open low high close average sum count".split(" "),V=Y.valueAxis,T=this.chartData,R=Y.numberFormatter;R||(R=this.numberFormatter);for(var P=0;P<X.length;P++){for(var Q=X[P],S=0,U=0,O,F,N,H,o,j=0,J=0,L,G,E,i,M,K=this.start;K<=this.end;K++){var D=T[K];if(D&&(D=D.axes[V.id].graphs[Y.id])){if(D.values){var I=D.values[Q];if(!isNaN(I)){isNaN(O)&&(O=I);F=I;if(isNaN(N)||N>I){N=I}if(isNaN(H)||H<I){H=I}S+=I;U++;o=S/U}}if(D.percents&&(D=D.percents[Q],!isNaN(D))){isNaN(L)&&(L=D);G=D;if(isNaN(E)||E>D){E=D}if(isNaN(i)||i<D){i=D}j+=D;J++;M=j/J}}}j={open:L,close:G,high:i,low:E,average:M,sum:j,count:J};Z=AmCharts.formatValue(Z,{open:O,close:F,high:H,low:N,average:o,sum:S,count:U},W,R,Q+"\\.",this.usePrefixes,this.prefixesOfSmallNumbers,this.prefixesOfBigNumbers);Z=AmCharts.formatValue(Z,j,W,this.percentFormatter,"percents\\."+Q+"\\.")}}return Z},formatString:function(h,f){var l=f.graph;if(-1!=h.indexOf("[[category]]")){var k=f.serialDataItem.category;if(this.categoryAxis.parseDates){var j=this.balloonDateFormat,i=this.chartCursor;i&&(j=i.categoryBalloonDateFormat);-1!=h.indexOf("[[category]]")&&(j=AmCharts.formatDate(k,j),-1!=j.indexOf("fff")&&(j=AmCharts.formatMilliseconds(j,k)),k=j)}h=h.replace(/\[\[category\]\]/g,String(k))}l=l.numberFormatter;l||(l=this.numberFormatter);k=f.graph.valueAxis;(j=k.duration)&&!isNaN(f.values.value)&&(k=AmCharts.formatDuration(f.values.value,j,"",k.durationUnits,k.maxInterval,l),h=h.replace(RegExp("\\[\\[value\\]\\]","g"),k));k="value open low high close total".split(" ");j=this.percentFormatter;h=AmCharts.formatValue(h,f.percents,k,j,"percents\\.");h=AmCharts.formatValue(h,f.values,k,l,"",this.usePrefixes,this.prefixesOfSmallNumbers,this.prefixesOfBigNumbers);h=AmCharts.formatValue(h,f.values,["percents"],j);-1!=h.indexOf("[[")&&(h=AmCharts.formatDataContextValue(h,f.dataContext));return h=AmCharts.AmSerialChart.base.formatString.call(this,h,f)},addChartScrollbar:function(b){AmCharts.callMethod("destroy",[this.chartScrollbar]);b&&(b.chart=this,this.listenTo(b,"zoomed",this.handleScrollbarZoom));this.rotate?void 0===b.width&&(b.width=b.scrollbarHeight):void 0===b.height&&(b.height=b.scrollbarHeight);this.chartScrollbar=b},removeChartScrollbar:function(){AmCharts.callMethod("destroy",[this.chartScrollbar]);this.chartScrollbar=null},handleReleaseOutside:function(b){AmCharts.AmSerialChart.base.handleReleaseOutside.call(this,b);AmCharts.callMethod("handleReleaseOutside",[this.chartScrollbar])}});AmCharts.Cuboid=AmCharts.Class({construct:function(A,z,y,x,w,t,r,o,q,s,v,j,B,i){this.set=A.set();this.container=A;this.h=Math.round(y);this.w=Math.round(z);this.dx=x;this.dy=w;this.colors=t;this.alpha=r;this.bwidth=o;this.bcolor=q;this.balpha=s;this.colors=t;this.dashLength=i;B?0>z&&0===v&&(v=180):0>y&&270==v&&(v=90);this.gradientRotation=v;0===x&&0===w&&(this.cornerRadius=j);this.draw()},draw:function(){var X=this.set;X.clear();var W=this.container,V=this.w,U=this.h,T=this.dx,R=this.dy,P=this.colors,N=this.alpha,O=this.bwidth,Q=this.bcolor,S=this.balpha,M=this.gradientRotation,E=this.cornerRadius,L=this.dashLength,G=P,o=P;"object"==typeof P&&(G=P[0],o=P[P.length-1]);var j,H,J,F,D,i,K,I,C;if(0<T||0<R){K=o,o=AmCharts.adjustLuminosity(G,-0.2),o=AmCharts.adjustLuminosity(G,-0.2),j=AmCharts.polygon(W,[0,T,V+T,V,0],[0,R,R,0,0],o,N,0,0,0,M),0<S&&(C=AmCharts.line(W,[0,T,V+T],[0,R,R],Q,S,O,L)),H=AmCharts.polygon(W,[0,0,V,V,0],[0,U,U,0,0],o,N,0,0,0,0,M),H.translate(T,R),0<S&&(J=AmCharts.line(W,[T,T],[R,R+U],Q,1,O,L)),F=AmCharts.polygon(W,[0,0,T,T,0],[0,U,U+R,R,0],o,N,0,0,0,M),D=AmCharts.polygon(W,[V,V,V+T,V+T,V],[0,U,U+R,R,0],o,N,0,0,0,M),0<S&&(i=AmCharts.line(W,[V,V+T,V+T,V],[0,R,U+R,U],Q,S,O,L)),o=AmCharts.adjustLuminosity(K,0.2),K=AmCharts.polygon(W,[0,T,V+T,V,0],[U,U+R,U+R,U,U],o,N,0,0,0,M),0<S&&(I=AmCharts.line(W,[0,T,V+T],[U,U+R,U+R],Q,S,O,L))}1>Math.abs(U)&&(U=0);1>Math.abs(V)&&(V=0);W=0===U?AmCharts.line(W,[0,V],[0,0],Q,S,O,L):0===V?AmCharts.line(W,[0,0],[0,U],Q,S,O,L):0<E?AmCharts.rect(W,V,U,P,N,O,Q,S,E,M,L):AmCharts.polygon(W,[0,0,V,V,0],[0,U,U,0,0],P,N,O,Q,S,M,!1,L);U=0>U?[j,C,H,J,F,D,i,K,I,W]:[K,I,H,J,F,D,j,C,i,W];for(j=0;j<U.length;j++){(H=U[j])&&X.push(H)}},width:function(b){this.w=b;this.draw()},height:function(b){this.h=b;this.draw()},animateHeight:function(e,d){var f=this;f.easing=d;f.totalFrames=1000*e/AmCharts.updateRate;f.rh=f.h;f.frame=0;f.height(1);setTimeout(function(){f.updateHeight.call(f)},AmCharts.updateRate)},updateHeight:function(){var d=this;d.frame++;var c=d.totalFrames;d.frame<=c&&(c=d.easing(0,d.frame,1,d.rh-1,c),d.height(c),setTimeout(function(){d.updateHeight.call(d)},AmCharts.updateRate))},animateWidth:function(e,d){var f=this;f.easing=d;f.totalFrames=1000*e/AmCharts.updateRate;f.rw=f.w;f.frame=0;f.width(1);setTimeout(function(){f.updateWidth.call(f)},AmCharts.updateRate)},updateWidth:function(){var d=this;d.frame++;var c=d.totalFrames;d.frame<=c&&(c=d.easing(0,d.frame,1,d.rw-1,c),d.width(c),setTimeout(function(){d.updateWidth.call(d)},AmCharts.updateRate))}});AmCharts.CategoryAxis=AmCharts.Class({inherits:AmCharts.AxisBase,construct:function(){AmCharts.CategoryAxis.base.construct.call(this);this.minPeriod="DD";this.equalSpacing=this.parseDates=!1;this.position="bottom";this.startOnAxis=!1;this.firstDayOfWeek=1;this.gridPosition="middle";this.markPeriodChange=this.boldPeriodBeginning=!0;this.safeDistance=30;this.centerLabelOnFullPeriod=!0;this.periods=[{period:"ss",count:1},{period:"ss",count:5},{period:"ss",count:10},{period:"ss",count:30},{period:"mm",count:1},{period:"mm",count:5},{period:"mm",count:10},{period:"mm",count:30},{period:"hh",count:1},{period:"hh",count:3},{period:"hh",count:6},{period:"hh",count:12},{period:"DD",count:1},{period:"DD",count:2},{period:"DD",count:3},{period:"DD",count:4},{period:"DD",count:5},{period:"WW",count:1},{period:"MM",count:1},{period:"MM",count:2},{period:"MM",count:3},{period:"MM",count:6},{period:"YYYY",count:1},{period:"YYYY",count:2},{period:"YYYY",count:5},{period:"YYYY",count:10},{period:"YYYY",count:50},{period:"YYYY",count:100}];this.dateFormats=[{period:"fff",format:"JJ:NN:SS"},{period:"ss",format:"JJ:NN:SS"},{period:"mm",format:"JJ:NN"},{period:"hh",format:"JJ:NN"},{period:"DD",format:"MMM DD"},{period:"WW",format:"MMM DD"},{period:"MM",format:"MMM"},{period:"YYYY",format:"YYYY"}];this.nextPeriod={};this.nextPeriod.fff="ss";this.nextPeriod.ss="mm";this.nextPeriod.mm="hh";this.nextPeriod.hh="DD";this.nextPeriod.DD="MM";this.nextPeriod.MM="YYYY"},draw:function(){AmCharts.CategoryAxis.base.draw.call(this);this.generateDFObject();var X=this.chart.chartData;this.data=X;if(AmCharts.ifArray(X)){var W,V=this.chart,U=this.start,T=this.labelFrequency,R=0;W=this.end-U+1;var P=this.gridCount,N=this.showFirstLabel,O=this.showLastLabel,Q,S="",M=AmCharts.extractPeriod(this.minPeriod);Q=AmCharts.getPeriodDuration(M.period,M.count);var E,L,G,o,j;E=this.rotate;var H=this.firstDayOfWeek,J=this.boldPeriodBeginning,X=AmCharts.resetDateToMin(new Date(X[X.length-1].time+1.05*Q),this.minPeriod,1,H).getTime(),F;this.endTime>X&&(this.endTime=X);F=this.minorGridEnabled;var D,X=this.gridAlpha,i;if(this.parseDates&&!this.equalSpacing){this.timeDifference=this.endTime-this.startTime;U=this.choosePeriod(0);T=U.period;E=U.count;L=AmCharts.getPeriodDuration(T,E);L<Q&&(T=M.period,E=M.count,L=Q);G=T;"WW"==G&&(G="DD");this.stepWidth=this.getStepWidth(this.timeDifference);var P=Math.ceil(this.timeDifference/L)+5,K=S=AmCharts.resetDateToMin(new Date(this.startTime-L),T,E,H).getTime();G==T&&1==E&&this.centerLabelOnFullPeriod&&(o=L*this.stepWidth);this.cellWidth=Q*this.stepWidth;W=Math.round(S/L);U=-1;W/2==Math.round(W/2)&&(U=-2,S-=L);var I=V.firstTime,C=0;F&&1<E&&(D=this.chooseMinorFrequency(E),i=AmCharts.getPeriodDuration(T,D));if(0<this.gridCount){for(W=U;W<=P;W++){M=I+L*(W+Math.floor((K-I)/L))-C;M=AmCharts.resetDateToMin(new Date(M),T,E,H).getTime();"MM"==T&&(F=(M-S)/L,1.5<=(M-S)/L&&(M-=(F-1)*L,C+=L));Q=(M-this.startTime)*this.stepWidth;j=!1;this.nextPeriod[G]&&(j=this.checkPeriodChange(this.nextPeriod[G],1,M,S));F=!1;j&&this.markPeriodChange?(S=this.dateFormatsObject[this.nextPeriod[G]],F=!0):S=this.dateFormatsObject[G];J||(F=!1);S=AmCharts.formatDate(new Date(M),S);if(W==U&&!N||W==P&&!O){S=" "}this.labelFunction&&(S=this.labelFunction(S,new Date(M),this));S=new this.axisItemRenderer(this,Q,S,!1,o,0,!1,F);this.pushAxisItem(S);S=M;if(!isNaN(D)){for(Q=1;Q<E;Q+=D){this.gridAlpha=this.minorGridAlpha,F=M+i*Q,F=AmCharts.resetDateToMin(new Date(F),T,D,H).getTime(),F=new this.axisItemRenderer(this,(F-this.startTime)*this.stepWidth),this.pushAxisItem(F)}}this.gridAlpha=X}}}else{if(!this.parseDates){if(this.cellWidth=this.getStepWidth(W),W<P&&(P=W),R+=this.start,this.stepWidth=this.getStepWidth(W),0<P){for(J=Math.floor(W/P),D=this.chooseMinorFrequency(J),Q=R,Q/2==Math.round(Q/2)&&Q--,0>Q&&(Q=0),P=0,W=Q;W<=this.end+2;W++){H=!1;0<=W&&W<this.data.length?(G=this.data[W],S=G.category,H=G.forceShow):S="";if(F&&!isNaN(D)){if(W/D==Math.round(W/D)||H){W/J==Math.round(W/J)||H||(this.gridAlpha=this.minorGridAlpha,S=void 0)}else{continue}}else{if(W/J!=Math.round(W/J)&&!H){continue}}Q=this.getCoordinate(W-R);H=0;"start"==this.gridPosition&&(Q-=this.cellWidth/2,H=this.cellWidth/2);if(W==U&&!N||W==this.end&&!O){S=void 0}Math.round(P/T)!=P/T&&(S=void 0);P++;K=this.cellWidth;E&&(K=NaN);this.labelFunction&&G&&(S=this.labelFunction(S,G,this));S=AmCharts.fixNewLines(S);S=new this.axisItemRenderer(this,Q,S,!0,K,H,void 0,!1,H);this.pushAxisItem(S);this.gridAlpha=X}}}else{if(this.parseDates&&this.equalSpacing){R=this.start;this.startTime=this.data[this.start].time;this.endTime=this.data[this.end].time;this.timeDifference=this.endTime-this.startTime;U=this.choosePeriod(0);T=U.period;E=U.count;L=AmCharts.getPeriodDuration(T,E);L<Q&&(T=M.period,E=M.count,L=Q);G=T;"WW"==G&&(G="DD");this.stepWidth=this.getStepWidth(W);P=Math.ceil(this.timeDifference/L)+1;S=AmCharts.resetDateToMin(new Date(this.startTime-L),T,E,H).getTime();this.cellWidth=this.getStepWidth(W);W=Math.round(S/L);U=-1;W/2==Math.round(W/2)&&(U=-2,S-=L);Q=this.start;Q/2==Math.round(Q/2)&&Q--;0>Q&&(Q=0);o=this.end+2;o>=this.data.length&&(o=this.data.length);i=!1;i=!N;this.previousPos=-1000;20<this.labelRotation&&(this.safeDistance=5);L=Q;if(this.data[Q].time!=AmCharts.resetDateToMin(new Date(this.data[Q].time),T,E,H).getTime()){for(H=0,I=S,W=Q;W<o;W++){M=this.data[W].time,this.checkPeriodChange(T,E,M,I)&&(H++,2<=H&&(L=W,W=o),I=M)}}F&&1<E&&(D=this.chooseMinorFrequency(E),AmCharts.getPeriodDuration(T,D));for(W=Q;W<o;W++){if(M=this.data[W].time,this.checkPeriodChange(T,E,M,S)&&W>=L){Q=this.getCoordinate(W-this.start);j=!1;this.nextPeriod[G]&&(j=this.checkPeriodChange(this.nextPeriod[G],1,M,S));F=!1;j&&this.markPeriodChange?(S=this.dateFormatsObject[this.nextPeriod[G]],F=!0):S=this.dateFormatsObject[G];S=AmCharts.formatDate(new Date(M),S);if(W==U&&!N||W==P&&!O){S=" "}i?i=!1:(J||(F=!1),Q-this.previousPos>this.safeDistance*Math.cos(this.labelRotation*Math.PI/180)&&(this.labelFunction&&(S=this.labelFunction(S,new Date(M),this)),S=new this.axisItemRenderer(this,Q,S,void 0,void 0,void 0,void 0,F),H=S.graphics(),this.pushAxisItem(S),H=H.getBBox().width,AmCharts.isModern||(H-=Q),this.previousPos=Q+H));S=M}else{isNaN(D)||(this.checkPeriodChange(T,D,M,K)&&(this.gridAlpha=this.minorGridAlpha,Q=this.getCoordinate(W-this.start),F=new this.axisItemRenderer(this,Q),this.pushAxisItem(F),K=M),this.gridAlpha=X)}}}}}for(W=0;W<this.data.length;W++){if(N=this.data[W]){O=this.parseDates&&!this.equalSpacing?Math.round((N.time-this.startTime)*this.stepWidth+this.cellWidth/2):this.getCoordinate(W-R),N.x[this.id]=O}}N=this.guides.length;for(W=0;W<N;W++){O=this.guides[W],J=J=J=X=U=NaN,D=O.above,O.toCategory&&(J=V.getCategoryIndexByValue(O.toCategory),isNaN(J)||(U=this.getCoordinate(J-R),S=new this.axisItemRenderer(this,U,"",!0,NaN,NaN,O),this.pushAxisItem(S,D))),O.category&&(J=V.getCategoryIndexByValue(O.category),isNaN(J)||(X=this.getCoordinate(J-R),J=(U-X)/2,S=new this.axisItemRenderer(this,X,O.label,!0,NaN,J,O),this.pushAxisItem(S,D))),O.toDate&&(this.equalSpacing?(J=V.getClosestIndex(this.data,"time",O.toDate.getTime(),!1,0,this.data.length-1),isNaN(J)||(U=this.getCoordinate(J-R))):U=(O.toDate.getTime()-this.startTime)*this.stepWidth,S=new this.axisItemRenderer(this,U,"",!0,NaN,NaN,O),this.pushAxisItem(S,D)),O.date&&(this.equalSpacing?(J=V.getClosestIndex(this.data,"time",O.date.getTime(),!1,0,this.data.length-1),isNaN(J)||(X=this.getCoordinate(J-R))):X=(O.date.getTime()-this.startTime)*this.stepWidth,J=(U-X)/2,S="H"==this.orientation?new this.axisItemRenderer(this,X,O.label,!1,2*J,NaN,O):new this.axisItemRenderer(this,X,O.label,!1,NaN,J,O),this.pushAxisItem(S,D)),U=new this.guideFillRenderer(this,X,U,O),X=U.graphics(),this.pushAxisItem(U,D),O.graphics=X,X.index=W,O.balloonText&&this.addEventListeners(X,O)}}this.axisCreated=!0;V=this.x;R=this.y;this.set.translate(V,R);this.labelsSet.translate(V,R);this.positionTitle();(V=this.axisLine.set)&&V.toFront()},chooseMinorFrequency:function(d){for(var c=10;0<c;c--){if(d/c==Math.round(d/c)){return d/c}}},choosePeriod:function(f){var e=AmCharts.getPeriodDuration(this.periods[f].period,this.periods[f].count),h=Math.ceil(this.timeDifference/e),g=this.periods;return this.timeDifference<e&&0<f?g[f-1]:h<=this.gridCount?g[f]:f+1<g.length?this.choosePeriod(f+1):g[f]},getStepWidth:function(d){var c;this.startOnAxis?(c=this.axisWidth/(d-1),1==d&&(c=this.axisWidth)):c=this.axisWidth/d;return c},getCoordinate:function(b){b*=this.stepWidth;this.startOnAxis||(b+=this.stepWidth/2);return Math.round(b)},timeZoom:function(d,c){this.startTime=d;this.endTime=c},minDuration:function(){var b=AmCharts.extractPeriod(this.minPeriod);return AmCharts.getPeriodDuration(b.period,b.count)},checkPeriodChange:function(h,f,l,k){l=new Date(l);var j=new Date(k),i=this.firstDayOfWeek;k=f;"DD"==h&&(f=1);l=AmCharts.resetDateToMin(l,h,f,i).getTime();f=AmCharts.resetDateToMin(j,h,f,i).getTime();return"DD"==h&&l-f<=AmCharts.getPeriodDuration(h,k)?!1:l!=f?!0:!1},generateDFObject:function(){this.dateFormatsObject={};var d;for(d=0;d<this.dateFormats.length;d++){var c=this.dateFormats[d];this.dateFormatsObject[c.period]=c.format}},xToIndex:function(h){var f=this.data,l=this.chart,k=l.rotate,j=this.stepWidth;this.parseDates&&!this.equalSpacing?(h=this.startTime+Math.round(h/j)-this.minDuration()/2,l=l.getClosestIndex(f,"time",h,!1,this.start,this.end+1)):(this.startOnAxis||(h-=j/2),l=this.start+Math.round(h/j));var l=AmCharts.fitToBounds(l,0,f.length-1),i;f[l]&&(i=f[l].x[this.id]);k?i>this.height+1&&l--:i>this.width+1&&l--;0>i&&l++;return l=AmCharts.fitToBounds(l,0,f.length-1)},dateToCoordinate:function(b){return this.parseDates&&!this.equalSpacing?(b.getTime()-this.startTime)*this.stepWidth:this.parseDates&&this.equalSpacing?(b=this.chart.getClosestIndex(this.data,"time",b.getTime(),!1,0,this.data.length-1),this.getCoordinate(b-this.start)):NaN},categoryToCoordinate:function(b){return this.chart?(b=this.chart.getCategoryIndexByValue(b),this.getCoordinate(b-this.start)):NaN},coordinateToDate:function(b){return this.equalSpacing?(b=this.xToIndex(b),new Date(this.data[b].time)):new Date(this.startTime+b/this.stepWidth)}});