am4internal_webpackJsonp(["a376"],{"8Znc":function(m,u,j){Object.defineProperty(u,"__esModule",{value:!0});var v={};j.d(v,"SliceGrouper",function(){return g});var d=j("m4/l"),f=j("Iz1H"),q=j("vMqJ"),b=j("aCit"),p=j("BEgH"),k=j("Qkdp"),g=function(c){function a(){var e=c.call(this)||this;return e.smallSlices=new q.b,e.bigSlices=new q.b,e.groupName="Other",e.groupProperties={},e.syncLegend=!1,e._threshold=5,e._clickDisposers=[],e._clickBehavior="none",e._ignoreDataUpdate=!1,e._closed=!0,e}return Object(d.c)(a,c),a.prototype.init=function(){c.prototype.init.call(this),this.processSeries()},a.prototype.processSeries=function(){var o=this,l=this.target,h=l.baseSprite,n=l.data&&l.data.length?l:h;this._disposers.push(n.events.on("datavalidated",function(r){if(o._ignoreDataUpdate){o._ignoreDataUpdate=!1}else{o.groupSlice=void 0,o.smallSlices.clear(),o.bigSlices.clear();var s,t=0;if(l.dataItems.each(function(x){var w=x.values.value.percent;x.dataContext.sliceGrouperOther?s=x.dataContext:w<=o.threshold?(t+=x.value,x.hiddenInLegend=!0,x.hide(),x.hidden=!0,x.label.events.on("transitionended",function(y){o._closed&&x.hide()}),o.smallSlices.push(x.slice)):o.bigSlices.push(x.slice)}),t>0){if(s){s[l.dataFields.value]=t,o._ignoreDataUpdate=!0,n.validateRawData()}else{var e={sliceGrouperOther:!0};e[l.dataFields.category]=o.groupName,e[l.dataFields.value]=t,o._ignoreDataUpdate=!0,n.addData(e)}}}})),this._disposers.push(l.events.on("validated",function(e){l.slices.each(function(i){i.dataItem.dataContext.sliceGrouperOther&&(o.groupSlice||(o.groupSlice=i,o.initSlices()))})}))},a.prototype.initSlices=function(){var h=this;this.groupSlice&&(k.each(this.groupProperties,function(l,e){h.groupSlice[l]=e}),"none"!=this.clickBehavior&&(this.groupSlice.events.has("hit")||this._clickDisposers.push(this.groupSlice.events.on("hit",function(e){h.toggleGroupOn()}))))},a.prototype.toggleGroupOn=function(){var h=this;"none"!=this.clickBehavior&&(this._closed=!1,this.groupSlice.dataItem.hide(),this.syncLegend&&(this.groupSlice.dataItem.hiddenInLegend=!0),this._clickDisposers.push(this.groupSlice.events.once("shown",function(e){h.toggleGroupOff()})),this.smallSlices.each(function(e){e.dataItem.hidden=!1,e.dataItem.show(),h.syncLegend&&(e.dataItem.hiddenInLegend=!1)}),"zoom"==this.clickBehavior&&this.bigSlices.each(function(e){e.dataItem.hide(),h.syncLegend&&(e.dataItem.hiddenInLegend=!0)}),this.syncLegend&&this.target.baseSprite.feedLegend(),this.zoomOutButton.show())},a.prototype.toggleGroupOff=function(){var h=this;"none"!=this.clickBehavior&&(this._closed=!0,this.groupSlice.events.disableType("shown"),this.groupSlice.dataItem.show(),this.groupSlice.events.enableType("shown"),this.syncLegend&&(this.groupSlice.dataItem.hiddenInLegend=!1),"zoom"==this.clickBehavior&&this.bigSlices.each(function(e){e.dataItem.hidden=!1,e.dataItem.show(),h.syncLegend&&(e.dataItem.hiddenInLegend=!1)}),this.smallSlices.each(function(e){e.dataItem.hide(),h.syncLegend&&(e.dataItem.hiddenInLegend=!0)}),this.syncLegend&&this.target.baseSprite.feedLegend(),this.zoomOutButton.hide())},Object.defineProperty(a.prototype,"threshold",{get:function(){return this._threshold},set:function(h){this._threshold!=h&&(this._threshold=h)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"zoomOutButton",{get:function(){var i=this;if(!this._zoomOutButton){var h=this.target.baseSprite.tooltipContainer.createChild(p.a);h.shouldClone=!1,h.align="right",h.valign="top",h.zIndex=Number.MAX_SAFE_INTEGER,h.marginTop=5,h.marginRight=5,h.hide(0),this.zoomOutButton=h,this._disposers.push(this._zoomOutButton),h.events.on("hit",function(){i.toggleGroupOff()},this)}return this._zoomOutButton},set:function(h){this._zoomOutButton=h},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"clickBehavior",{get:function(){return this._clickBehavior},set:function(h){this._clickBehavior!=h&&(this._clickBehavior=h,this.initSlices())},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this.disposeClickEvents(),this.groupSlice=void 0,this.smallSlices.clear(),this.bigSlices.clear(),c.prototype.dispose.call(this)},a.prototype.disposeClickEvents=function(){var h=this._clickDisposers;for(this._clickDisposers=null;0!==h.length;){h.shift().dispose()}},a}(f.a);b.c.registeredClasses.SliceGrouper=g,window.am4plugins_sliceGrouper=v}},["8Znc"]);