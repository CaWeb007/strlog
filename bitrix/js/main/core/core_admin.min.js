(function(a){if(BX.admin){return}BX.admin={__border_style:"solid 1px #777f8c",__bg_style:"#777f8c",__border_dx:0,__border_min_height:12,__border_menu_timeout:500,__borders_last_comp_pos:{},__borders:null,dynamic_mode:false,dynamic_mode_show_borders:false,timer:null,createComponentBorder:function(){BX.admin.__borders={};BX.admin.__borders.cont=document.body.appendChild(BX.create("DIV",{style:{display:"none",height:"0px",width:"0px"}}));BX.admin.__borders.top=BX.admin.__borders.cont.appendChild(BX.create("DIV",{style:{position:"absolute",height:"1px",fontSize:"1px",overflow:"hidden",zIndex:990,background:BX.admin.__bg_style}}));BX.admin.__borders.right=BX.admin.__borders.cont.appendChild(BX.create("DIV",{style:{position:"absolute",width:"1px",fontSize:"1px",overflow:"hidden",zIndex:990,background:BX.admin.__bg_style}}));BX.admin.__borders.bottom=BX.admin.__borders.cont.appendChild(BX.create("DIV",{style:{position:"absolute",height:"1px",fontSize:"1px",overflow:"hidden",zIndex:990,background:BX.admin.__bg_style}}));BX.admin.__borders.left=BX.admin.__borders.cont.appendChild(BX.create("DIV",{style:{position:"absolute",width:"1px",fontSize:"1px",overflow:"hidden",zIndex:990,background:BX.admin.__bg_style}}))},__borders_adjust:function(){var d=BX.pos(this),c=BX.admin.__border_dx;var b=BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0;BX.adjust(BX.admin.__borders.top,{style:{top:(d.top-c-b)+"px",left:(d.left-c-b)+"px",width:(d.width+c*2)+"px"}});BX.adjust(BX.admin.__borders.right,{style:{top:(d.top-c-b)+"px",left:(d.right+c-1-b)+"px",height:(d.height+c*2)+"px"}});BX.adjust(BX.admin.__borders.bottom,{style:{top:(d.bottom+c-b)+"px",left:(d.left-c-b)+"px",width:(d.width+c*2)+"px"}});BX.adjust(BX.admin.__borders.left,{style:{top:(d.top-c-b)+"px",left:(d.left-c-b)+"px",height:(d.height+c*2)+"px"}});BX.admin.__borders_last_comp_pos=d},setComponentBorder:function(b){if(!BX.isReady){return BX.ready(function(){BX.admin.setComponentBorder(b)})}if(null==BX.admin.__borders){BX.admin.createComponentBorder()}b=BX(b);if(!b){return}if(b.children.length>0){var f=b.firstChild,e=null,d=0;while(f){if(BX.type.isElementNode(f)&&f.tagName.toUpperCase()!="SCRIPT"){d++;if(d>1||!BX.is_relative(f)&&!BX.is_float(f)){d=-1;break}e=f}f=f.nextSibling}if(d==1&&e){if(b.OPENER){b.OPENER.setParent(e)}b=e}}if(BX.admin.dynamic_mode){BX.addCustomEvent(a,"onDynamicModeChange",BX.delegate(BX.admin.__empty_comp_onmodechange,b))}BX.admin.__empty_comp_onmodechange.apply(b,[!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders]);BX.bind(b,"mouseover",BX.admin.__borders_show);BX.bind(b,"mouseout",BX.admin.__borders_hide);if(b.OPENER&&b.OPENER.defaultAction){b.title=BX.message("ADMIN_INCLAREA_DBLCLICK")+" - "+b.OPENER.defaultActionTitle;BX.bind(b,"dblclick",BX.admin.__borders_dblclick)}},removeComponentBorder:function(b){b=BX(b);if(!b){return}BX.unbind(b,"mouseover",BX.admin.__borders_show);BX.unbind(b,"mouseout",BX.admin.__borders_hide);if(b.bx_msover){BX.admin.__borders_hide.apply(b)}},__empty_comp_onmodechange:function(b){if(this.offsetHeight<=BX.admin.__border_min_height){if(b){if(BX.browser.IsIE()&&!BX.browser.IsDoctype()){this.style.height=BX.admin.__border_min_height+"px"}else{this.style.minHeight=BX.admin.__border_min_height+"px"}BX.addClass(this,"bx-context-toolbar-empty-area")}else{if(BX.browser.IsIE()&&!BX.browser.IsDoctype()){this.style.height=null}else{this.style.minHeight=null}BX.removeClass(this,"bx-context-toolbar-empty-area")}}},__borders_dblclick:function(b){if((!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders)&&this.OPENER&&this.OPENER.defaultAction){this.OPENER.executeDefaultAction();return BX.PreventDefault(b)}return true},__borders_show:function(c){c=c||a.event;var b=BX.is_relative(this)?this.parentNode:this;if(BX.admin.dynamic_mode&&!BX.admin.dynamic_mode_show_borders){if(b.title){b._title=b.title;b.title=""}return}if(b._title){b.title=b._title}if(!BX.admin.__borders_adjusted){BX.admin.__borders.cont.style.display="block";BX.admin.__borders_adjust.apply(this);BX.admin.__borders_adjusted=true}this.bx_msover=true;if(this.OPENER){if(this.bxtimer){clearTimeout(this.bxtimer)}this.bxtimer=setTimeout(BX.proxy(BX.admin.__borders_menu_show,this),this.OPENER.timeout||BX.admin.__border_menu_timeout);this.OPENER.setHoverHoutEvents(BX.proxy(BX.admin.__borders_show,this),BX.proxy(BX.admin.__borders_hide,this))}},__borders_menu_show:function(){if(this.bx_msover&&this.OPENER){this.OPENER.UnHide()}},__borders_hide:function(){if(BX.admin.dynamic_mode&&!BX.admin.dynamic_mode_show_borders){return}if(this.OPENER&&this.OPENER.isMenuVisible()){setTimeout(BX.admin.__borders_hide,3*BX.admin.__border_menu_timeout);return}BX.admin.__borders.cont.style.display="none";BX.admin.__borders_adjusted=false;this.bx_msover=false;if(this.OPENER){var b=BX.admin.__get_hide_timeout(this.OPENER);if(this.bxtimer){clearTimeout(this.bxtimer)}this.bxtimer=setTimeout(BX.proxy(BX.admin.__borders_menu_hide,this),b)}},__borders_menu_hide:function(b){if(!this.bx_msover&&this.OPENER){this.OPENER.Hide()}},__get_hide_timeout:function(b){var c=BX.admin.__border_menu_timeout;return c}};BX.admin.panel={state:{fixed:false,collapsed:false},DIV:null,BACKDIV:null,BACKFRAME:null,NOTIFY:null,buttons:[],Init:function(){var g;BX.admin.panel.DIV=BX("bx-panel");if(BX.admin.panel.DIV){BX.setUnselectable(BX.admin.panel.DIV);g=BX("bx-panel-toggle");if(g){g.onclick=function(i){BX.admin.toggle.toggleStatus();i=i||a.event;BX.PreventDefault(i)}}g=BX("bx-panel-toggle-icon");if(g){BX.bind(g,"mousedown",BX.proxy(BX.admin.toggle.start,BX.admin.toggle));BX.bind(g,"click",BX.PreventDefault)}g=BX("bx-panel-hider");if(g){BX.admin.panel.DIV.ondblclick=BX("bx-panel-expander").onclick=g.onclick=BX.admin.panel.Collapse;BX("bx-panel-tabs").ondblclick=BX.PreventDefault;var c=BX("bx-panel-switcher");if(c){c.ondblclick=BX.PreventDefault}}g=BX("bx-panel-pin");if(g){BX.bind(g,"click",function(){var i=BX.hasClass(this,"bx-panel-pin-fixed");if(i){BX.removeClass(this,"bx-panel-pin-fixed")}else{BX.addClass(this,"bx-panel-pin-fixed")}BX.userOptions.save("admin_panel","settings","fix",(i?"off":"on"))});BX.bind(g,"click",BX.admin.panel.Fix);if(BX.admin.panel.state.fixed){BX.admin.panel.Fix()}}for(var e=0,b=BX.admin.panel.buttons.length;e<b;e++){var d=BX(BX.admin.panel.buttons[e]["ID"]);if(d){if(BX.admin.panel.buttons[e].HOVER_CSS){d.bx_hover_class=BX.admin.panel.buttons[e].HOVER_CSS;if(BX.admin.panel.buttons[e].ACTIVE_CSS){d.bx_active_class=BX.admin.panel.buttons[e].ACTIVE_CSS}BX.bind(d,"mouseover",BX.admin.panel.__btn_hover);BX.bind(d,"mouseout",BX.admin.panel.__btn_hout);BX.bind(d,"mousedown",BX.admin.panel.__btn_down)}if(BX.admin.panel.buttons[e].MENU){var f=new BX.COpener({DIV:d,ATTACH:d.parentNode.parentNode,MENU:BX.admin.panel.buttons[e].MENU,TYPE:"click"});BX.addCustomEvent(f,"onOpenerMenuOpen",BX.delegate(BX.admin.panel.__btn_menuopen,d));BX.addCustomEvent(f,"onOpenerMenuClose",BX.delegate(BX.admin.panel.__btn_menuclose,d))}if(BX.admin.panel.buttons[e].HINT){var h=BX.admin.panel.buttons[e].HINT.TARGET?d.parentNode.parentNode:d;if(BX.admin.panel.buttons[e].HINT.ID){BX.hint(h,BX.admin.panel.buttons[e].HINT.TITLE,BX.admin.panel.buttons[e].HINT.TEXT,BX.admin.panel.buttons[e].HINT.ID)}else{h.BXHINT=new BX.CHint({parent:h,hint:BX.admin.panel.buttons[e].HINT.TEXT,title:BX.admin.panel.buttons[e].HINT.TITLE,id:BX.admin.panel.buttons[e].HINT.ID})}}d.ondblclick=BX.PreventDefault;if(BX.browser.IsIE()){d.setAttribute("hideFocus","hidefocus")}}}}g=null},__view_mode_toggle:function(d){var b=BX("bx-panel-toggle");var c=BX("bx-panel-toggle-caption-mode");if(b.className=="bx-panel-toggle-on"){b.className="bx-panel-toggle-off";c.innerHTML=BX.message("ADMIN_SHOW_MODE_OFF");BX.admin.dynamic_mode_show_borders=false;b.href=b.href.replace("bitrix_include_areas=N","bitrix_include_areas=Y")}else{b.className="bx-panel-toggle-on";c.innerHTML=BX.message("ADMIN_SHOW_MODE_ON");BX.admin.dynamic_mode_show_borders=true;b.href=b.href.replace("bitrix_include_areas=Y","bitrix_include_areas=N")}if(null!=this.BXHINT){this.BXHINT.Destroy()}this.BXHINT=new BX.CHint({parent:this,title:BX.message("AMDIN_SHOW_MODE_TITLE"),hint:BX.admin.dynamic_mode_show_borders?BX.message("ADMIN_SHOW_MODE_ON_HINT"):BX.message("ADMIN_SHOW_MODE_OFF_HINT"),showOnce:true,preventHide:true,show_timeout:0,hide_timeout:2000});BX.userOptions.save("admin_panel","settings","edit",(BX.admin.dynamic_mode_show_borders?"on":"off"));BX.onCustomEvent(a,"onDynamicModeChange",[BX.admin.dynamic_mode_show_borders]);return BX.eventReturnFalse(d)},__btn_hover:function(){this.bx_hover=true;if(!BX.admin.panel._menu_open){BX.addClass(this.parentNode.parentNode,this.bx_hover_class)}},__btn_hout:function(){this.bx_hover=false;if(!BX.admin.panel._menu_open){BX.removeClass(this.parentNode.parentNode,this.bx_hover_class)}BX.admin.panel.__btn_inactive.apply(this)},__btn_down:function(){BX.admin.panel.__btn_active.apply(this)},__btn_up:function(){BX.unbind(document,"mouseup",BX.proxy(BX.admin.panel.__btn_up,this));BX.admin.panel.__btn_inactive.apply(this)},__btn_active:function(){this.bx_active=true;if(!BX.admin.panel._menu_open){BX.addClass(this.parentNode.parentNode,this.bx_active_class)}},__btn_inactive:function(){this.bx_active=false;if(!BX.admin.panel._menu_open){BX.removeClass(this.parentNode.parentNode,this.bx_active_class)}},__btn_menuopen:function(){if(this.bx_hover){BX.admin.panel.__btn_hover.apply(this)}if(this.bx_active){BX.admin.panel.__btn_active.apply(this)}BX.admin.panel._menu_open=true},__btn_menuclose:function(){BX.admin.panel._menu_open=false;if(!this.bx_hover){BX.admin.panel.__btn_hout.apply(this)}BX.admin.panel.__btn_inactive.apply(this)},RegisterButton:function(b){BX.admin.panel.buttons[BX.admin.panel.buttons.length]=b},Collapse:function(g){g=g||a.event;BX.admin.panel.state.collapsed=!(BX.admin.panel.DIV.className.indexOf("bx-panel-folded")>-1);var d=BX.admin.panel.DIV.offsetHeight;var f=BX("bx-panel-hider",true);var h=BX("bx-panel-expander",true);var b=BX("bx-panel-toggle");if(BX.admin.panel.state.collapsed){BX.admin.toggle.unset();BX("bx-panel-userinfo").insertBefore(b.parentNode.removeChild(b),h);BX.addClass(BX.admin.panel.DIV,"bx-panel-folded")}else{BX.admin.toggle.unset();BX("bx-panel-switcher").insertBefore(b.parentNode.removeChild(b),f);BX.removeClass(BX.admin.panel.DIV,"bx-panel-folded")}var c=BX.admin.panel.DIV.offsetHeight-d;BX.userOptions.save("admin_panel","settings","collapsed",(BX.admin.panel.state.collapsed?"on":"off"));BX.admin.panel.__adjustBackDiv();BX.onCustomEvent("onTopPanelCollapse",[BX.admin.panel.state.collapsed,c]);return BX.PreventDefault(g)},isFixed:function(){return BX.admin.panel.DIV.className.indexOf("bx-panel-fixed")>-1},Fix:function(){if(null==BX.admin.panel.BACKDIV){BX.admin.panel.BACKDIV=BX("bx-panel-back")}var c=BX.admin.panel.isFixed();var b=BX.browser.IsIE();if(b){try{BX.admin.panel.DIV.style.removeExpression("top")}catch(d){b=false}}if(c){BX.removeClass(BX.admin.panel.DIV,b?"bx-panel-fixed-ie":"bx-panel-fixed");BX.admin.panel.BACKDIV.style.display="none";if(b){BX.admin.panel.DIV.style.cssText="position: static !important;";if(BX.admin.panel.BACKFRAME){BX.admin.panel.BACKFRAME.style.visibility="hidden"}}}else{if(b){try{BX.admin.panel.DIV.style.setExpression("top","0")}catch(d){b=false}}if(b){BX.admin.panel.DIV.style.cssText=""}BX.addClass(BX.admin.panel.DIV,b?"bx-panel-fixed-ie":"bx-panel-fixed");if(b){if(document.body.currentStyle.backgroundImage=="none"){document.body.style.backgroundImage="url(/bitrix/images/1.gif)";document.body.style.backgroundAttachment="fixed";document.body.style.backgroundRepeat="no-repeat"}BX.admin.panel.DIV.style.setExpression("top","eval((document.documentElement && document.documentElement.scrollTop) ? document.documentElement.scrollTop : document.body.scrollTop)");BX.admin.panel.DIV.style.setExpression("left","eval((document.documentElement && document.documentElement.scrollLeft) ? document.documentElement.scrollLeft : document.body.scrollLeft)");BX.admin.panel.DIV.style.setExpression("width","eval((document.documentElement && document.documentElement.clientWidth) ? document.documentElement.clientWidth : document.body.clientWidth)")}BX.admin.panel.__adjustBackDiv();BX.admin.panel.BACKDIV.style.display="block";if(b){if(BX.admin.panel.BACKFRAME){BX.admin.panel.BACKFRAME.style.visibility="visible"}else{BX.admin.panel.CreateFrame()}}}BX.onCustomEvent("onTopPanelFix",[!c])},__adjustBackDiv:function(){if(BX.admin.panel.BACKDIV){var b=BX.admin.panel.DIV.offsetHeight+"px";BX.admin.panel.BACKDIV.style.height=b;var c=BX("bx-panel-frame");if(BX.admin.panel.BACKFRAME){BX.admin.panel.BACKFRAME.style.height=b}}},CreateFrame:function(){BX.admin.panel.BACKFRAME=document.body.appendChild(BX.create("IFRAME",{props:{id:"bx-panel-frame"},style:{position:"absolute",overflow:"hidden",zIndex:parseInt(BX.admin.panel.DIV.currentStyle.zIndex)-1,height:BX.admin.panel.DIV.offsetHeight+"px"}}));BX.admin.panel.BACKFRAME.style.setExpression("top","eval(document.body.scrollTop)");BX.admin.panel.BACKFRAME.style.setExpression("left","eval(document.body.scrollLeft)");BX.admin.panel.BACKFRAME.style.setExpression("width","eval(document.body.clientWidth)")},Notify:function(c){if(!BX.isReady){var b=arguments;BX.ready(function(){BX.admin.panel.Notify.apply(this,b)});return}if(!BX.admin.panel.DIV){return}if(null==BX.admin.panel.NOTIFY){BX.admin.panel.NOTIFY=BX.admin.panel.DIV.appendChild(BX.create("DIV",{props:{className:"adm-warning-block"},html:'<span class="adm-warning-text">'+(c||"&nbsp;")+'</span><span onclick="BX.admin.panel.hideNotify(this.parentNode)" class="adm-warning-close"></span>'}))}BX.removeClass(BX.admin.panel.NOTIFY,"adm-warning-animate");BX.admin.panel.__adjustBackDiv()},hideNotify:function(b){b=BX.type.isDomNode(b)?b:this;if(!!b&&!!b.parentNode&&!!b.parentNode.parentNode){b.style.height=b.offsetHeight+"px";setTimeout(function(){BX.addClass(b,"adm-warning-animate")},50)}if(BX.type.isDomNode(b)&&b.getAttribute("data-ajax")=="Y"){var c=parseInt(b.getAttribute("data-id"));if(c>0){BX.ajax({url:"/bitrix/admin/admin_notify.php",method:"POST",dataType:"json",data:{ID:c,sessid:BX.bitrix_sessid()}})}}(BX.defer(BX.admin.panel.__adjustBackDiv,this))();setTimeout(BX.proxy(BX.admin.panel.__adjustBackDiv,this),310)}};BX.admin.toggle={icon:null,indicator:null,toggle:null,caption:null,pageX:0,initIconPos:0,initIndicatorPos:0,minLeft:-3,maxLeft:17,unset:function(){this.icon=this.indicator=this.toggle=this.caption=null},start:function(b){b=b||a.event;if(!this._init()||!b){return}BX.fixEventPageX(b);this.pageX=b.pageX;this.initIconPos=parseInt(BX.style(this.icon,"left"));this.initIndicatorPos=BX.hasClass(this.toggle,"bx-panel-toggle-on")?-270:-290;BX.removeClass(this.toggle,"bx-panel-toggle-animate");BX.bind(document,"mousemove",BX.proxy(this._onMouseMove,this));BX.bind(document,"mouseup",BX.proxy(this._onMouseUp,this));document.body.onselectstart=BX.False;document.body.ondragstart=BX.False;document.body.style.MozUserSelect="none"},_init:function(){if(this.toggle){return true}this.toggle=BX("bx-panel-toggle");this.icon=BX("bx-panel-toggle-icon");this.indicator=BX("bx-panel-toggle-indicator");this.caption=BX("bx-panel-toggle-caption-mode");return(this.toggle&&this.icon&&this.indicator&&this.caption)},_onMouseMove:function(b){b=b||a.event;BX.fixEventPageX(b);this._moveToggle(b.pageX-this.pageX)},_onMouseUp:function(){var c=parseInt(BX.style(this.icon,"left"));if(this.initIconPos==c){this.toggleStatus()}else{var b=this.minLeft+Math.floor((this.maxLeft-this.minLeft)/2);if(c>=b){BX.addClass(this.toggle,"bx-panel-toggle-on bx-panel-toggle-animate");BX.removeClass(this.toggle,"bx-panel-toggle-off");this._changePosition(true)}else{BX.addClass(this.toggle,"bx-panel-toggle-off bx-panel-toggle-animate");BX.removeClass(this.toggle,"bx-panel-toggle-on");this._changePosition(false)}}this.icon.style.cssText="";this.indicator.style.cssText="";BX.unbind(document,"mousemove",BX.proxy(this._onMouseMove,this));BX.unbind(document,"mouseup",BX.proxy(this._onMouseUp,this));document.body.onselectstart=null;document.body.ondragstart=null;document.body.style.MozUserSelect=""},_changePosition:function(b){var c=this.caption.childNodes[0];if((b&&c.id=="bx-panel-toggle-caption-mode-on")||(!b&&c.id=="bx-panel-toggle-caption-mode-off")){return}this.caption.appendChild(this.caption.removeChild(c));if(BX.admin.dynamic_mode){if(b){BX.admin.dynamic_mode_show_borders=true;this.toggle.href=this.toggle.href.replace("bitrix_include_areas=Y","bitrix_include_areas=N")}else{BX.admin.dynamic_mode_show_borders=false;this.toggle.href=this.toggle.href.replace("bitrix_include_areas=N","bitrix_include_areas=Y")}if(null!=BX.admin.panel.BXHINT){BX.admin.panel.BXHINT.Destroy()}BX.admin.panel.BXHINT=new BX.CHint({parent:this.toggle,title:BX.message("AMDIN_SHOW_MODE_TITLE"),hint:BX.admin.dynamic_mode_show_borders?BX.message("ADMIN_SHOW_MODE_ON_HINT"):BX.message("ADMIN_SHOW_MODE_OFF_HINT"),showOnce:true,preventHide:true,show_timeout:0,hide_timeout:2000});BX.userOptions.save("admin_panel","settings","edit",(BX.admin.dynamic_mode_show_borders?"on":"off"));BX.onCustomEvent(a,"onDynamicModeChange",[BX.admin.dynamic_mode_show_borders])}else{BX.reload(this.toggle.href)}},_moveToggle:function(c){var b=this.initIconPos+c;b=Math.min(this.maxLeft,Math.max(b,this.minLeft));this.icon.style.cssText="left:"+b+"px !important";this.indicator.style.cssText="background-position: "+(this.initIndicatorPos+b-this.initIconPos)+"px -1751px !important"},toggleStatus:function(){if(!this._init()){return}if(BX.hasClass(this.toggle,"bx-panel-toggle-off")){BX.addClass(this.toggle,"bx-panel-toggle-on bx-panel-toggle-animate");BX.removeClass(this.toggle,"bx-panel-toggle-off");this._changePosition(true)}else{BX.addClass(this.toggle,"bx-panel-toggle-off bx-panel-toggle-animate");BX.removeClass(this.toggle,"bx-panel-toggle-on");this._changePosition(false)}}};BX.admin.moreButton={buttonContainer:null,menu:null,buttonSpan:null,buttons:[],groupsMenu:{},moreButtonSize:64,moreButton:null,lastVisibleButton:-1,init:function(b){this.params=b||{};this.buttonContainer=BX("bx-panel-buttons-inner");if(this.buttonContainer&&this.buttonContainer.childNodes&&this.buttonContainer.childNodes.length>0){setTimeout(BX.proxy(this.__init,this),0);BX.ready(function(){BX.admin.moreButton.__init();BX.admin.moreButton.recal()})}else{BX.ready(function(){BX.admin.moreButton.buttonContainer=BX("bx-panel-buttons-inner");BX.admin.moreButton.__init()})}},__init:function(){if(this.moreButton){return}this.buttons=BX.findChildren(this.buttonContainer,{tagName:"span"});for(var c=0,d=BX.admin.panel.buttons.length;c<d;c++){var b=BX.admin.panel.buttons[c];if(typeof(b.GROUP_ID)=="underfined"||(b.SKIP&&b.SKIP===true)){continue}if(!BX.type.isArray(this.groupsMenu[b.GROUP_ID])){this.groupsMenu[b.GROUP_ID]=[]}b.TEXT=this.getButtonTitle(b);this.groupsMenu[b.GROUP_ID].push(b)}this.moreButton=BX.create("span",{props:{className:"bx-panel-button-group"},children:[BX.create("span",{props:{className:"bx-panel-button bx-panel-button-more"},children:[BX.create("span",{props:{className:"bx-panel-button-inner"},children:[(this.buttonSpan=BX.create("span",{props:{bx_hover_class:"bx-panel-button-hover",bx_active_class:"bx-panel-button-active"},events:{mouseover:BX.admin.panel.__btn_hover,mouseout:BX.admin.panel.__btn_hout,mousedown:BX.admin.panel.__btn_down,click:BX.proxy(this.onButtonClick,this),dblclick:BX.PreventDefault},html:'<span class="bx-panel-button-icon bx-panel-more-button-icon"></span><span class="bx-panel-button-text">'+this.params.buttonTitle+'&nbsp;<span class="bx-panel-button-arrow"></span></span>'}))]})]})]});this.menu=new BX.COpener({DIV:this.buttonSpan,ATTACH:this.buttonSpan.parentNode.parentNode,MENU:[],TYPE:"click"});BX.addCustomEvent(this.menu,"onOpenerMenuOpen",BX.delegate(BX.admin.panel.__btn_menuopen,this.buttonSpan));BX.addCustomEvent(this.menu,"onOpenerMenuClose",BX.delegate(BX.admin.panel.__btn_menuclose,this.buttonSpan));BX.bind(a,"resize",BX.proxy(this.recal,this));BX.bind(a,"orientationchange",BX.proxy(this.recal,this));BX.addCustomEvent("onTopPanelCollapse",BX.proxy(this.recal,this));this.recal()},recal:function(){if(this.moreButton.parentNode){this.moreButton.parentNode.removeChild(this.moreButton)}this.menu.Close();this.lastVisibleButton=-1;var e=this.buttons[0];var b=this.buttons[this.buttons.length-1];if(e.offsetTop==b.offsetTop){return}for(var d=this.buttons.length-1;d>=0;d--){var c=this.buttons[d];if(c.offsetTop==e.offsetTop&&this.getFreeSpace(c)>=this.moreButtonSize){this.lastVisibleButton=d;this.buttonContainer.insertBefore(this.moreButton,this.buttons[d+1]);break}}},getButtonTitle:function(d){if(BX.type.isNotEmptyString(d.TEXT)){return d.TEXT}else{if(d.HINT&&BX.type.isNotEmptyString(d.HINT.TITLE)){return d.HINT.TITLE}else{if(BX.type.isArray(d.MENU)&&d.MENU.length>0){var b=null;for(var c=0;c<d.MENU.length;c++){if(d.MENU[c].DEFAULT){b=d.MENU[c];break}}return b?b.TEXT:d.MENU[0].TEXT}}}return d.ID},getFreeSpace:function(b){var c=b.offsetWidth+parseInt(BX.style(b,"marginRight"));return b.offsetParent.offsetWidth-b.offsetLeft-c},onButtonClick:function(){var e=[];for(var d=this.lastVisibleButton+1;d<this.buttons.length;d++){var c=this.buttons[d];var b=c.getAttribute("data-group-id");if(BX.type.isNotEmptyString(b)&&BX.type.isArray(this.groupsMenu[b])){if(e.length>0){e.push({SEPARATOR:true})}BX.util.array_merge(e,this.groupsMenu[b])}}this.menu.SetMenu(e)}};BX.admin.startMenuRecent=function(b){BX.ajax.get("/bitrix/admin/get_start_menu.php",{mode:"save_recent",url:b.LINK,text:b.TEXT,title:b.TITLE,icon:b.GLOBAL_ICON,sessid:BX.bitrix_sessid()})};BX.admin.startMenuFavAdd=function(b){a.location.href="/bitrix/admin/favorite_edit.php?lang="+BX.message("LANGUAGE_ID")+"&name="+BX.util.urlencode(document.title)+"&addurl="+BX.util.urlencode(a.location.href)+"&encoded=Y"+(!!b?"&back_url_pub="+BX.util.urlencode(b):"")};BX.ready(function(){BX.admin.panel.Init()})})(window);