(function(){BX.namespace("BX.Main.ui");BX.Main.ui.Factory=function(){if(BX.Main.ui.Factory instanceof BX.Main.ui.Factory){return BX.Main.ui.Factory}this.data=[];this.classControl="main-ui-control";this.classSelect="main-ui-select";this.classMultiSelect="main-ui-multi-select";this.classDate="main-ui-date";this.maxEventPathDepth=5;this.init()};BX.Main.ui.Factory.prototype={init:function(){BX.bind(document,"click",BX.delegate(this._onHandleEvent,this));document.addEventListener("focus",BX.delegate(this._onHandleEvent,this),true)},_onHandleEvent:function(a){this.prepareEvent(a);a.path.forEach(function(e,d){if(!this.validateIteration(e,d)){return false}if(this.isSelect(e)&&!this.isControlInitialized(e)){var b={node:e,instance:new BX.Main.ui.select(e)};this.data.push(b);b.instance._onControlClick(a)}if(this.isDate(e)&&!this.isControlInitialized(e)){var c={node:e,instance:new BX.Main.ui.date(e)};this.data.push(c)}},this)},validateIteration:function(b,a){return a<=this.maxEventPathDepth&&BX.type.isDomNode(b)},prepareEvent:function(c){if(!("path" in c)||!c.path.length){c.path=[c.target];var b=0;var a;while((a=c.path[b++].parentNode)!==null){c.path.push(a)}}},isSelect:function(a){return BX.hasClass(a,this.classSelect)||BX.hasClass(a,this.classMultiSelect)},isControl:function(a){return BX.hasClass(a,this.classControl)},isDate:function(a){return BX.hasClass(a,this.classDate)},isControlInitialized:function(a){return this.data.some(function(b){return b.node===a},this)},get:function(b){var a=this.data.filter(function(c){return b===c.node});return a.length>0?a[0]:null}};BX.Main.ui.Factory=new BX.Main.ui.Factory()})();