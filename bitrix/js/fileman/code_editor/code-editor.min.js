(function(){window.JCCodeEditor=function(u,v){this.actionCount=0;this.arConfig=u;this.MESS=v;this.arSyntaxes={};this.pTA=BX(this.arConfig.textareaId);if(!this.pTA||!BX.isNodeInDom(this.pTA)){return false}this.saveSettings=!!u.saveSettings;this.highlightMode=!!u.highlightMode&&this.IsValidBrowser();this.theme=u.theme;this.tabSize=4;this.undoDepth=30;this.timeout=100;this.delay=200;this.pollInterval=100;this.cursorInterval=500;this.indentUnit=4;this._cachedWidthFor=0;this._cachedWidth=0;this.prevInput="";this._cachedHeight=null;this._cachedHeightFor=null;this._measurePre=null;this.lineNums=0;this.tabSymTA="        ";this.arBrackets={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};this.Init()};window.JCCodeEditor.prototype={Init:function(){var w=this;if(this.pTA.parentNode.offsetWidth<=0||this.pTA.parentNode.offsetHeight<=0){return setTimeout(function(){w.Init()},100)}if(this.arConfig.forceSyntax&&{php:1,js:1,css:1,sql:1}[this.arConfig.forceSyntax]){this.syntaxName=this.arConfig.forceSyntax}else{this.syntaxName="php";this.arConfig.forceSyntax=false}this.InitKeyEngine();this.BuildSceleton();if(BX.browser.IsIOS()){this.pInput.style.width="0px"}if(!BX.browser.IsSafari()&&!BX.browser.IsChrome()){this.pScroller.draggable=true}this.pLinesCont.style.outline="none";this.FocusInput();if(BX.browser.IsMac()){this.pScrollbar.style.zIndex=-2;this.pScrollbar.style.visibility="hidden"}else{if(BX.browser.IsIE()&&!BX.browser.IsIE9()){this.pScrollbar.style.minWidth="18px"}}try{this.GetCharWidth()}catch(v){return}this.pollDelayed=new t();this.highlight=new t();this.oDoc=new c([new n([new f("")])]);this.focused=false;this.LoadSyntax();this.oSel={from:{line:0,ch:0},to:{line:0,ch:0},inverted:false};this.lastClick=false;this.lastDoubleClick=false;this._lastScrollTop=0;this._lastStoppedKey=null;this.suppressEdits=false;this.callbacks=null;this.arChanges=[];this.displayOffset=0;this.showingFrom=0;this.showingTo=0;this.lastSizeC=0;this.bracketHighlighted=null;this.maxLine=this.GetLine(0);this.updateMaxLine=false;this.maxLineChanged=true;this._tabCache={};this.pollingFast=false;this.goalColumn=null;this.Action(this.SetValue,this)(this.pTA.value||"");this.updateInput=false;this.oHistory=new g();BX.bind(this.pScroller,"mousedown",this.Action(this.OnMouseDown,this));BX.bind(this.pScroller,"dblclick",this.Action(this.OnDoubleClick,this));BX.bind(this.pLinesCont,"selectstart",BX.PreventDefault);BX.bind(this.pScroller,"scroll",BX.proxy(this.OnScrollMain,this));BX.bind(this.pScrollbar,"scroll",BX.proxy(this.OnScrollBar,this));BX.bind(this.pScrollbar,"mousedown",function(){if(w.highlightMode&&w.focused){setTimeout(w.FocusInput,0)}});BX.bind(this.pInput,"keyup",this.Action(this.OnKeyUp,this));BX.bind(this.pInput,"input",BX.proxy(this.FastPoll,this));BX.bind(this.pInput,"keydown",this.Action(this.OnKeyDown,this));BX.bind(this.pInput,"keypress",this.Action(this.OnKeyPress,this));BX.bind(this.pInput,"focus",BX.proxy(this.OnFocus,this));BX.bind(this.pInput,"blur",BX.proxy(this.OnBlur,this));BX.bind(this.pScroller,"paste",function(){w.FocusInput();w.FastPoll()});BX.bind(this.pInput,"paste",BX.proxy(this.FastPoll,this));BX.bind(this.pInput,"cut",this.Action(function(){w.ReplaceSelection("")},this));setTimeout(BX.proxy(this.OnFocus,this),20);if(this.theme!="dark"){this.theme="dark";this.SwitchTheme()}if(!this.highlightMode){this.highlightMode=true;this.SwitchHightlightMode()}var u=this.pTA.form;if(u){BX.addCustomEvent(u,"onAutoSavePrepare",function(){if(u&&u.BXAUTOSAVE){try{BX.addCustomEvent(this,"OnAfterActionSelectionChanged",function(){u.BXAUTOSAVE.Init()});BX.addCustomEvent(u,"onAutoSave",function(y,z){if(w.highlightMode){w.Save()}z[w.pTA.name]=w.GetTAValue()});BX.addCustomEvent(u,"onAutoSaveRestore",function(y,z){if(w.highlightMode){w.Action(w.SetValue,w)(z[w.pTA.name])}else{w.pTA.value=z[w.pTA.name];w.CheckLineSelection()}})}catch(x){}}});BX.bind(u,"reset",function(){if(w.highlightMode){w.Action(w.SetValue,w)("");w.FocusInput();w.OnFocus()}})}},BuildSceleton:function(){var u=this;this.pDiv=this.pTA.parentNode.appendChild(BX.create("DIV",{props:{className:"bxce bxce-hls"}}));this.pWarning=this.pDiv.appendChild(BX.create("DIV",{props:{className:"bxce-warning-cont"},text:this.MESS.HighlightWrongwarning,style:{display:"none"}}));this.pInnerContHL=this.pDiv.appendChild(BX.create("DIV",{props:{className:"bxce-inner-hl"}}));this.pBaseContTA=this.pDiv.appendChild(BX.create("DIV",{props:{className:"bxce-base-cont"},style:{display:"none"}}));this.pBaseContTA.onclick=function(v){BX.focus(u.pTA)};this.pContTA=this.pBaseContTA.appendChild(BX.create("DIV",{props:{className:"bxce-cont"}}));this.pLineNumTABgTA=this.pBaseContTA.appendChild(BX.create("DIV",{props:{className:"bxce-line-num-bg"}}));this.pLineNumTA=this.pContTA.appendChild(BX.create("DIV",{props:{className:"bxce-line-num bxce-font"}}));this.pContTA.appendChild(this.pTA);this.pTA.className="bxce-ta";this.pTA.style.display="none";this.pTA.removeAttribute("cols");this.pTA.removeAttribute("rows");this.pTA.setAttribute("spellcheck",false);this.pTA.setAttribute("hidefocus",true);this.pTA.setAttribute("autocomplete","off");this.pTA.setAttribute("autocorrect","off");this.pTA.setAttribute("autocapitalize","off");this.pTA.setAttribute("wrap","off");this.pTA.onkeyup=BX.proxy(this.TextOnKeyup,this);this.pTA.onkeydown=BX.proxy(this.TextOnKeydown,this);this.pTA.onmousedown=BX.proxy(this.TextOnMousedown,this);this.pInputCont=this.pInnerContHL.appendChild(BX.create("DIV",{props:{className:"bxce-inp-cont"}}));this.pInput=this.pInputCont.appendChild(BX.create("TEXTAREA",{props:{className:"bxce-inp"}}));this.pInput.setAttribute("wrap","off");this.pInput.setAttribute("autocorrect","off");this.pInput.setAttribute("autocapitalize","off");this.pScrollbar=this.pInnerContHL.appendChild(BX.create("DIV",{props:{className:"bxce-scrollbar"}}));this.pScrollbarInner=this.pScrollbar.appendChild(BX.create("DIV",{props:{className:"bxce-scrollbar-inner"}}));this.pScroller=this.pInnerContHL.appendChild(BX.create("DIV",{props:{className:"bxce-scroller",tabIndex:-1}}));this.pSizeCont=this.pScroller.appendChild(BX.create("DIV",{props:{className:"bxce-size-cont",tabIndex:-1}}));this.pMover=this.pSizeCont.appendChild(BX.create("DIV",{props:{className:"bxce-inner-size-cont"}}));this.pLineNum=this.pMover.appendChild(BX.create("DIV",{props:{className:"bxce-hl-line-num"}}));this.pLineNumText=this.pLineNum.appendChild(BX.create("DIV",{props:{className:"bxce-hl-line-num-text"}}));this.pHighlight=this.pMover.appendChild(BX.create("DIV",{props:{className:"bxce-highlight"}}));this.pLinesCont=this.pHighlight.appendChild(BX.create("DIV",{props:{className:"bxce-lines-cnt"}}));this.pMeasure=this.pLinesCont.appendChild(BX.create("DIV",{props:{className:"bxce-liner-cont"}}));this.pCursor=this.pLinesCont.appendChild(BX.create("PRE",{props:{className:"bxce-cursor"},text:"\u00a0"}));this.pWidthForcer=this.pLinesCont.appendChild(BX.create("PRE",{props:{className:"bxce-cursor"},style:{visibility:"hidden"},text:"\u00a0"}));this.pSelectionDiv=this.pLinesCont.appendChild(BX.create("DIV",{props:{className:"bxce-sel-cont"}}));this.pLineDiv=this.pLinesCont.appendChild(BX.create("DIV"));this.pFootCont=this.pDiv.appendChild(BX.create("DIV",{props:{className:"bxce-foot-cont"}}));this.pFastLineInp=this.pFootCont.appendChild(BX.create("SPAN",{props:{className:"bxce-go-to-line-cont"}})).appendChild(BX.create("INPUT",{props:{className:"bxce-go-to-line",title:this.MESS.GoToLine}}));this.pFastLineInp.onfocus=function(){setTimeout(function(){u.pFastLineInp.select()},10)};this.pFootCont.onclick=function(){setTimeout(function(){u.pFastLineInp.select()},10)};this.pFastLineInp.onkeydown=BX.proxy(this.FastGoToLine,this);this.pCurPosCont=this.pFootCont.appendChild(BX.create("SPAN",{props:{className:"bxce-info-cur-cont"},html:this.MESS.Line+":"}));this.pInfoCurLine=this.pCurPosCont.appendChild(BX.create("SPAN",{props:{className:"bxce-info-cur-line",title:this.MESS.LineTitle}}));this.pCurPosCont.appendChild(document.createTextNode(this.MESS.Char+":"));this.pInfoCurChar=this.pCurPosCont.appendChild(BX.create("SPAN",{props:{className:"bxce-info-cur-char",title:this.MESS.CharTitle}}));this.pTotalCont=this.pFootCont.appendChild(BX.create("SPAN",{props:{className:"bxce-info-total-cont"},html:this.MESS.Total+"  "+this.MESS.Lines+":"}));this.pInfoTotLines=this.pTotalCont.appendChild(BX.create("SPAN",{props:{className:"bxce-info-total-line"}}));this.pModeToggle=this.pFootCont.appendChild(BX.create("A",{props:{href:"javascript:void(0)",className:"bxce-mode-link"+(this.highlightMode?" bxce-mode-link-on":""),title:this.MESS.EnableHighlightTitle},html:'<span class="bxce-mode-txt">'+this.MESS.EnableHighlight+"</span><i></i>"}));this.pModeToggle.onclick=BX.proxy(this.SwitchHightlightMode,this);this.pThemeToggle=this.pFootCont.appendChild(BX.create("A",{props:{href:"javascript:void(0)",className:"bxce-theme-toggle"},html:'<i></i><span class="bxce-theme-toggle-text">'+this.MESS.LightTheme+"</span>"}));this.pThemeToggle.onclick=BX.proxy(this.SwitchTheme,this);this.pThemeToggleText=this.pThemeToggle.childNodes[1];this.AdjustSceletonSize()},Action:function(u,v){var w=this;if(v==undefined){v=this}return function(){if(!w.actionCount++){w.OnBeforeAction()}try{var x=u.apply(v,arguments)}finally{if(!--w.actionCount){w.OnAfterAction()}}return x}},OnBeforeAction:function(){BX.onCustomEvent(this,"OnBeforeAction");this.updateInput=null;this.userSelChange=null;this.textChanged=null;this.changes=[];this.arChanges=[];this.selectionChanged=false;this.callbacks=[]},OnAfterAction:function(){if(this.updateMaxLine){this.ComputeMaxLength()}if(this.maxLineChanged){var u=this.pWidthForcer.offsetWidth,y=this.MeasureLine(this.maxLine,this.maxLine.text.length).left;if(!BX.browser.IsIE()||BX.browser.IsIE9()){this.pWidthForcer.style.left=y+"px";this.pLinesCont.style.minWidth=(y+u)+"px"}this.maxLineChanged=false}var w,v;if(this.selectionChanged){var x=this.CalculateCursorCoords();w=this.CalculateScrollPos(x.x,x.y,x.x,x.yBot)}if(this.arChanges.length||w&&w.scrollTop!=null){v=this.UpdateDisplay(this.arChanges,true,w&&w.scrollTop)}if(!v){if(this.selectionChanged){this.UpdateSelection()}if(this.lineNumDirty){this.UpdateLineNum()}}if(w){this.ScrollCursorIntoView()}if(this.selectionChanged){this.RestartBlink()}if(this.focused&&(this.updateInput===true||(this.updateInput!==false&&this.selectionChanged))){this.ResetInput(this.userSelChange)}if(this.selectionChanged){BX.onCustomEvent(this,"OnAfterActionSelectionChanged");setTimeout(this.Action(this.CheckMatchingBrackets,this),20)}this.SetStatusBarInfo(this.oSel.to);BX.onCustomEvent(this,"OnAfterAction")},CheckMatchingBrackets:function(){if(this.bracketHighlighted){this.bracketHighlighted();this.bracketHighlighted=null}if(this.PosEq(this.oSel.from,this.oSel.to)){this.MatchBrackets()}},MatchBrackets:function(){var L,w=this.oSel.inverted?this.oSel.from:this.oSel.to,D=this.GetLine(w.line),x=w.ch-1;var B=(x>=0&&this.arBrackets[D.text.charAt(x)])||this.arBrackets[D.text.charAt(++x)];if(!B){return}var J=this,O,K,E=B.charAt(0),C=B.charAt(1)==">",N=C?1:-1,I=D.styles;for(O=x+1,K=0;K<I.length;K+=2){if((O-=I[K].length)<=0){L=I[K+1];break}}var y=[D.text.charAt(x)],H=/[(){}[\]]/;function G(aa,V,W){if(!aa.text){return}var Z=aa.styles,U=C?0:aa.text.length-1,X;for(var R=C?0:Z.length-2,T=C?Z.length:-2;R!=T;R+=2*N){var Y=Z[R];if(Z[R+1]!=L){U+=N*Y.length;continue}for(var Q=C?0:Y.length-1,P=C?Y.length:-1;Q!=P;Q+=N,U+=N){if(U>=V&&U<W&&H.test(X=Y.charAt(Q))){var S=J.arBrackets[X];if(S.charAt(1)==">"==C){y.push(X)}else{if(y.pop()!=S.charAt(0)){return{pos:U,match:false}}else{if(!y.length){return{pos:U,match:true}}}}}}}}var M,z,F;for(K=w.line,M=C?Math.min(K+100,this.oDoc.size):Math.max(-1,K-100);K!=M;K+=N){D=this.GetLine(K);z=K==w.line;F=G(D,z&&C?x+1:0,z&&!C?x:D.text.length);if(F){break}}if(!F){F={pos:null,match:false}}var A=F.match?"bxce-hl-bracket":"bxce-non-hl-bracket",u=this.HightlightFrag({line:w.line,ch:x},{line:w.line,ch:x+1},A),v=F.pos!=null&&this.HightlightFrag({line:K,ch:F.pos},{line:K,ch:F.pos+1},A);this.bracketHighlighted=this.Action(function(){u.Clear();if(v){v.Clear()}},this)},SetStatusBarInfo:function(u){if(this.highlightMode||u.nbLine==undefined){this.pInfoCurLine.innerHTML=u.line+1;this.pInfoCurChar.innerHTML=u.ch;this.pInfoTotLines.innerHTML=this.oDoc.size;this.pFastLineInp.value=u.line+1}else{this.pInfoCurLine.innerHTML=u.linePos;this.pInfoCurChar.innerHTML=u.carretPos;this.pInfoTotLines.innerHTML=u.nbLine;this.pFastLineInp.value=u.linePos}},FastGoToLine:function(v){if(!v){v=window.event}var u=v.which||v.keyCode;if(u==13){this.GoToLine(this.pFastLineInp.value);return BX.PreventDefault(v)}},GoToLine:function(w){w=parseInt(w,10);if(isNaN(w)){return}if(this.highlightMode){w--;if(w<0){w=0}if(w>=this.oDoc.size){w=this.oDoc.size-1}this.OnBeforeAction();this.SetCursor(w,0,true);this.OnAfterAction();setTimeout(BX.proxy(this.FocusInput,this),20)}else{if(w<0){w=0}var A=0,x,u=(BX.browser.IsIE()?0:1),z=this.GetTAValue(),v=z.split("\n"),y=v.length;if(w>y){A=z.length}else{for(x=0;x<w-1;x++){A+=v[x].length+u}}this.SelectTA(A,0);this.MoveLineSelection();if(BX.browser.IsChrome()||BX.browser.IsSafari()){if(this.pLineNumTA.childNodes[w-1]){this.pLineNumTA.childNodes[w-1].scrollIntoView(false)}}return A}},SelectTA:function(x,u){BX.focus(this.pTA);var w=this.pTA.value.length;if(x<0){x=0}if(x>w){x=w}var v=x+u;if(v>w){v=w}if(BX.browser.IsIE()){this.SetIETASelection(x,v)}else{this.pTA.setSelectionRange(x,v)}},SetIETASelection:function(z,w){var y=this.GetTAValue().replace(/\r/g,""),u=y.substr(0,z).split("\n").length-1,v=y.substr(0,w).split("\n").length-1,x=document.selection.createRange();z+=u;w+=v;x.moveToElementText(this.pTA);x.setEndPoint("EndToStart",x);x.moveStart("character",z-u);x.moveEnd("character",w-v-(z-u));x.select()},MoveLineSelection:function(u){if(this.checkLineTimeout){this.checkLineTimeout=clearTimeout(this.checkLineTimeout)}if(u===true){this.checkLineTimeout=setTimeout(BX.proxy(this.MoveLineSelection,this),5)}else{this.CheckLineSelection(false)}},SwitchTheme:function(){if(this.theme=="dark"){this.theme="light";BX.addClass(this.pDiv,"bxce--light");this.pThemeToggleText.innerHTML=this.MESS.DarkTheme}else{BX.removeClass(this.pDiv,"bxce--light");this.theme="dark";this.pThemeToggleText.innerHTML=this.MESS.LightTheme}if(this.highlightMode){if(!this.focused){this.FocusInput();this.OnFocus()}}else{BX.focus(this.pTA)}this.SaveUserOption("theme",this.theme)},SwitchHightlightMode:function(){this.highlightMode=!this.highlightMode;if(this.__warnTimeout){this.__warnTimeout=clearTimeout(this.__warnTimeout)}if(this.highlightMode&&!this.IsValidBrowser()){var x=this;this.pWarning.style.display="";this.__warnTimeout=setTimeout(function(){x.pWarning.style.display="none"},4000)}else{this.pWarning.style.display="none"}if(this.highlightMode){this.pInnerContHL.style.display="";this.pBaseContTA.style.display="none";this.pTA.style.display="none";BX.addClass(this.pModeToggle,"bxce-mode-link-on");BX.addClass(this.pDiv,"bxce-hls");if(!BX.browser.IsSafari()&&!BX.browser.IsChrome()){this.pScroller.setAttribute("draggable",true)}this.Action(this.SetValue,this)(this.pTA.value||"");if(!this.focused){this.FocusInput();this.OnFocus()}}else{this.Save();var u=this.pHighlight.offsetWidth-60,v=this.pHighlight.offsetHeight;this.pTA.style.width=u+"px";this.pContTA.style.width=u+"px";this.pTA.style.height=v+"px";this.pInnerContHL.style.display="none";this.pTA.style.display="";this.pBaseContTA.style.display="";BX.focus(this.pTA);setTimeout(BX.proxy(this.ManageSize,this),100);BX.removeClass(this.pModeToggle,"bxce-mode-link-on");BX.removeClass(this.pDiv,"bxce-hls");if(!BX.browser.IsSafari()&&!BX.browser.IsChrome()){this.pScroller.removeAttribute("draggable")}}this.SaveUserOption("highlight",this.highlightMode?1:0)},IsValidBrowser:function(){return !BX.browser.IsIE()||BX.browser.IsDoctype()},SaveUserOption:function(u,v){if(this.saveSettings){BX.userOptions.save("fileman","code_editor",u,v)}},SetValue:function(u){var v={line:0,ch:0};this.UpdateLines(v,{line:this.oDoc.size-1,ch:this.GetLine(this.oDoc.size-1).text.length},this.ExplodeLines(u),v,v);this.updateInput=true},GetValue:function(v){var u=[];this.oDoc.Iteration(0,this.oDoc.size,function(w){u.push(w.text)});return u.join(v||"\n")},GetTAValue:function(){return this.pTA.value},SetTAValue:function(u){if(u==undefined){u=this.GetTAValue()}else{u=u.replace(/\r/g,"")}this.pTA.value=u},Save:function(){this.pTA.value=this.GetValue()},AdjustSceletonSize:function(u,y){var C=this,B=u,v=y;if(!u||!y||u<=0||y<=0){if(this.arConfig.width){u=parseInt(this.arConfig.width)}if(this.arConfig.height){y=parseInt(this.arConfig.height)}if(this.pDiv.parentNode&&!u){u=parseInt(this.pDiv.parentNode.offsetWidth)-(BX.browser.IsIE()?10:2)}if(this.pDiv.parentNode&&!y){y=parseInt(this.pDiv.parentNode.offsetHeight)-2}if(!u||isNaN(u)||y<100){u=900}if(!y||isNaN(y)||y<100){y=400}}if(u<=0||y<=0){return setTimeout(function(){C.AdjustSceletonSize(B,v)},300)}u=parseInt(u);y=parseInt(y);var z=u,x=20,A=y-x;this.pScroller.style.height=A+"px";this.pLineNumTABgTA.style.height=A+"px";this.pBaseContTA.style.height=A+"px";this.pBaseContTA.style.width=z+"px";this.pDiv.style.width=u+"px";this.pDiv.style.height=y+"px"},Resize:function(u,v){u=parseInt(u);v=parseInt(v);this.AdjustSceletonSize(u,v);this.UpdateDisplay(true);if(BX.browser.IsChrome()){var x=this;setTimeout(function(){x.UpdateDisplay(true)},300)}},HasSelection:(window.getSelection?function(v){var u=false;try{u=v.selectionStart!=v.selectionEnd}catch(w){}return u}:function(v){var u=false;try{u=v.ownerDocument.selection.createRange()}catch(w){}if(!u||u.parentElement()!=v){u=false}else{if(u){u=u.compareEndPoints("StartToEnd",u)!=0}}return u}),ExplodeLines:("\n\nb".split(/\n/).length==3?function(u){return u.split(/\r\n?|\n/)}:function(y){var w,z,v,A=0,x=[],u=y.length;while(A<=u){w=y.indexOf("\n",A);if(w==-1){w=y.length}z=y.slice(A,y.charAt(w-1)=="\r"?w-1:w);v=z.indexOf("\r");if(v!=-1){x.push(z.slice(0,v));A+=v+1}else{x.push(z);A=w+1}}return x}),HightlightFrag:function(B,A,v){B=this.ClipPos(B);A=this.ClipPos(A);var z=this;var y=this.GetHighlighter();if(!this.PosLess(B,A)){return y}function x(C,F,E,D){z.GetLine(C).addMark(new p(F,E,D,y))}if(B.line==A.line){x(B.line,B.ch,A.ch,v)}else{x(B.line,B.ch,null,v);for(var u=B.line+1,w=A.line;u<w;++u){x(u,null,null,v)}x(A.line,null,A.ch,v)}this.arChanges.push({from:B.line,to:A.line+1});return y},GetHighlighter:function(){var u={set:[]};u.Clear=this.Action(function(){var z,w,x,A,y=Infinity,v=-Infinity;for(z=0;z<u.set.length;++z){w=u.set[z];if(!w.marked||!w.parent){continue}A=e(w);y=Math.min(y,A);v=Math.max(v,A);w.marked=[]}if(y!=Infinity){this.arChanges.push({from:y,to:v+1})}},this);return u},GetCursor:function(u){if(u==undefined){u=this.oSel.inverted}return this.CopyPos(u?this.oSel.from:this.oSel.to)},SetCursor:function(u,w,v){var x=this.ClipPos({line:u,ch:w||0});if(v){this.SetSelectionUser(x,x)}else{this.SetSelection(x,x)}},ClipLine:function(u){return Math.max(0,Math.min(u,this.oDoc.size-1))},ClipPos:function(x){var u=x;if(x.line<0){u={line:0,ch:0}}else{if(x.line>=this.oDoc.size){u={line:this.oDoc.size-1,ch:this.GetLine(_this.oDoc.size-1).text.length}}else{var v=x.ch,w=this.GetLine(x.line).text.length;if(v==null||v>w){u={line:x.line,ch:w}}else{if(v<0){u={line:x.line,ch:0}}}}}return u},GetLine:function(u){return this.GetLineAt(this.oDoc,u)},GetLineAt:function(u,y){while(!u.lines){var w,x,v;for(w=0;;++w){x=u.children[w];if(!x||!x.GetSize){break}v=x.GetSize();if(y<v){u=x;break}y-=v}}return u.lines[y]},InitSyntax:function(v,u){if(arguments.length>2){this.arSyntaxControl=[];for(var w=2;w<arguments.length;++w){this.arSyntaxControl.push(arguments[w])}}this.arSyntaxes[v]=u},LoadSyntax:function(){this.oSyntax=s[this.syntaxName](!!this.arConfig.forceSyntax);this.oDoc.Iteration(0,this.oDoc.size,function(u){u.statusAfter=null});this.work=[0];this.StartWorker()},StartWorker:function(u){if(!this.work.length){return}this.highlight.set(u,this.Action(this.HighlightWorker))},HighlightWorker:function(){var D=this,w,u,A,z,v,C,B,x,y=+new Date+this.timeout;while(this.work.length){w=this.GetLine(this.showingFrom).statusAfter?this.work.pop():this.showingFrom;if(w>=this.oDoc.size){continue}u=this.FindStartLine(w);A=u&&this.GetLine(u-1).statusAfter;if(A){A=this.OnSyntaxCopyState(this.oSyntax,A)}else{A=this.OnSyntaxStartState(this.oSyntax)}z=0;v=this.oSyntax.compareStates;C=false;B=u;x=false;this.oDoc.Iteration(B,this.oDoc.size,function(F){var G=F.statusAfter;if(+new Date>y){D.work.push(B);D.StartWorker(D.delay);if(C){D.arChanges.push({from:w,to:B+1})}return(x=true)}var H=F.highlight(D.oSyntax,A,D.tabSize);if(H){C=true}F.statusAfter=D.OnSyntaxCopyState(D.oSyntax,A);var E=null;if(v){var I=G&&v(G,A);E=!!I}if(E==null){if(H!==false||!G){z=0}else{if(++z>3&&(!D.oSyntax.Indent||D.oSyntax.Indent(G,"")==D.oSyntax.Indent(A,""))){E=true}}}if(E){return true}B++});if(x){return}if(C){this.arChanges.push({from:w,to:B+1})}}},OnSyntaxStartState:function(w,v,u){return w.startStatus?w.startStatus(v,u):true},OnSyntaxCopyState:function(v,u){if(u===true){return u}if(v.copyStatus){return v.copyStatus(u)}var w={};for(var y in u){var x=u[y];if(x instanceof Array){x=x.concat([])}w[y]=x}return w},FindStartLine:function(A){var z,w,v,x=A-40;for(v=A;v>x;--v){if(v==0){return 0}var u=this.GetLine(v-1);if(u.statusAfter){return v}var y=u.indentation(this.tabSize);if(w==null||z>y){w=v-1;z=y}}return w},GetStateBefore:function(w){var v=this.FindStartLine(w),u=v&&this.GetLine(v-1).statusAfter;if(u){u=this.OnSyntaxCopyState(this.oSyntax,u)}else{u=this.OnSyntaxStartState(this.oSyntax)}this.oDoc.Iteration(v,w,function(x){x.highlight(_this.oSyntax,u,_this.tabSize);x.statusAfter=_this.OnSyntaxCopyState(_this.oSyntax,u)});if(v<w){this.arChanges.push({from:v,to:w})}if(w<this.oDoc.size&&!this.GetLine(w).statusAfter){this.work.push(w)}return u},UpdateDisplay:function(D,z,w){if(!this.pScroller.clientWidth){this.showingFrom=this.showingTo=this.displayOffset=0;return}var x=this.VisibleLines(w);if(D!==true&&D.length==0&&x.from>this.showingFrom&&x.to<this.showingTo){return this.UpdateVerticalScroll(w)}var F=Math.max(x.from-100,0),G=Math.min(this.oDoc.size,x.to+100);if(this.showingFrom<F&&F-this.showingFrom<20){F=this.showingFrom}if(this.showingTo>G&&this.showingTo-G<20){G=Math.min(this.oDoc.size,this.showingTo)}var E=D===true?[]:this.GetUnchanged([{from:this.showingFrom,to:this.showingTo,domStart:0}],D);var y=0;for(var A=0;A<E.length;++A){var B=E[A];if(B.from<F){B.domStart+=(F-B.from);B.from=F}if(B.to>G){B.to=G}if(B.from>=B.to){E.splice(A--,1)}else{y+=B.to-B.from}}if(y==G-F&&F==this.showingFrom&&G==this.showingTo){return this.UpdateVerticalScroll(w)}E.sort(function(I,H){return I.domStart-H.domStart});var v=this.TextHeight(),C=this.pLineNum.style.display;this.pLineDiv.style.display="none";this.PatchDisplay(F,G,E);this.pLineDiv.style.display=this.pLineNum.style.display="";var u=F!=this.showingFrom||G!=this.showingTo||this.lastSizeC!=this.pScroller.clientHeight+v;if(u){this.lastSizeC=this.pScroller.clientHeight+v}this.showingFrom=F;this.showingTo=G;this.displayOffset=this.HeightAtLine(this.oDoc,F);if(this.pLineDiv.childNodes.length!=this.showingTo-this.showingFrom){throw new Error("BAD PATCH! "+JSON.stringify(E)+" size="+(this.showingTo-this.showingFrom)+" nodes="+this.pLineDiv.childNodes.length)}this.pLineNum.style.display=C;if(u||this.lineNumDirty){this.UpdateLineNum()}this.UpdateVerticalScroll(w);this.UpdateSelection();return true},VisibleLines:function(w){var u=this.TextHeight(),v=(w!=null?w:this.pScrollbar.scrollTop)-this.PaddingTop();return{from:this.LineAtHeight(this.oDoc,Math.max(0,Math.floor(v/u))),to:this.LineAtHeight(this.oDoc,Math.ceil((v+this.pScroller.clientHeight)/u))}},TextHeight:function(){var w=50;if(!this._measurePre){this._measurePre=BX.create("PRE");for(var v=0;v<w;++v){this._measurePre.appendChild(document.createTextNode("W"));if(v<w-1){this._measurePre.appendChild(BX.create("br"))}}}var u=this.pLineDiv.clientHeight;if(u!=this._cachedHeightFor){this._cachedHeightFor=u;BX.cleanNode(this.pMeasure);this.pMeasure.appendChild(this._measurePre.cloneNode(true));this._cachedHeight=this.pMeasure.firstChild.offsetHeight/w||1;BX.cleanNode(this.pMeasure)}return this._cachedHeight},UpdateLinesNoUndo:function(I,y,P,u,Q){if(this.suppressEdits){return}var C,J=this,O=false,x=this.maxLine.text.length;this.oDoc.Iteration(I.line,y.line+1,function(R){if(!R.hidden&&R.text.length==x){O=true;return true}});if(I.line!=y.line||P.length>1){this.lineNumDirty=true}var F=y.line-I.line,E=this.GetLine(I.line),v=this.GetLine(y.line);if(I.ch==0&&y.ch==0&&P[P.length-1]==""){C=[];var D=null;if(I.line){D=this.GetLine(I.line-1);D.fixMarkEnds(v)}else{v.fixMarkStarts()}for(var L=0,N=P.length-1;L<N;++L){C.push(f.inheritMarks(P[L],D))}if(F){this.oDoc.Remove(I.line,F,this.callbacks)}if(C.length){this.oDoc.Insert(I.line,C)}}else{if(E==v){if(P.length==1){E.Replace(I.ch,y.ch,P[0])}else{v=E.split(y.ch,P[P.length-1]);E.Replace(I.ch,null,P[0]);E.fixMarkEnds(v);C=[];for(var L=1,N=P.length-1;L<N;++L){C.push(f.inheritMarks(P[L],E))}C.push(v);this.oDoc.Insert(I.line+1,C)}}else{if(P.length==1){E.Replace(I.ch,null,P[0]);v.Replace(null,y.ch,"");E.append(v);this.oDoc.Remove(I.line+1,F,this.callbacks)}else{C=[];E.Replace(I.ch,null,P[0]);v.Replace(null,y.ch,P[P.length-1]);E.fixMarkEnds(v);for(var L=1,N=P.length-1;L<N;++L){C.push(f.inheritMarks(P[L],E))}if(F>1){this.oDoc.Remove(I.line+1,F-1,this.callbacks)}this.oDoc.Insert(I.line+1,C)}}}this.oDoc.Iteration(I.line,I.line+P.length,function(S){var R=S.text;if(!S.hidden&&R.length>x){J.maxLine=S;x=R.length;J.maxLineChanged=true;O=false}});if(O){this.updateMaxLine=true}var w=[],B=P.length-F-1;for(var L=0,H=J.work.length;L<H;++L){var M=J.work[L];if(M<I.line){w.push(M)}else{if(M>y.line){w.push(M+B)}}}var K=I.line+Math.min(P.length,500);this.HighlightLines(I.line,K);w.push(K);this.work=w;this.StartWorker(100);this.arChanges.push({from:I.line,to:y.line+1,diff:B});var A={from:I,to:y,text:P};if(this.textChanged){for(var z=this.textChanged;z.next;z=z.next){}z.next=A}else{this.textChanged=A}function G(R){return R<=Math.min(y.line,y.line+B)?R:R+B}this.SetSelection(this.ClipPos(u),this.ClipPos(Q),G(this.oSel.from.line),G(this.oSel.to.line))},UpdateLines:function(z,y,x,v,u){if(this.suppressEdits){return}if(this.oHistory){var w=[];this.oDoc.Iteration(z.line,y.line+1,function(A){w.push(A.text)});this.oHistory.addChange(z.line,x.length,w);while(this.oHistory.done.length>this.undoDepth){this.oHistory.done.shift()}}this.UpdateLinesNoUndo(z,y,x,v,u)},HighlightLines:function(x,v){var w=this,u=this.GetStateBefore(x);this.oDoc.Iteration(x,v,function(y){y.highlight(w.oSyntax,u,w.tabSize);y.statusAfter=w.OnSyntaxCopyState(w.oSyntax,u)})},SetSelectionUser:function(w,v){var u=this.shiftSelecting&&this.ClipPos(this.shiftSelecting);if(u){if(this.PosLess(u,w)){w=u}else{if(this.PosLess(v,u)){v=u}}}this.SetSelection(w,v);this.userSelChange=true},SetSelection:function(B,A,u,z){this.goalColumn=null;if(u==null){u=this.oSel.from.line;z=this.oSel.to.line}if(this.PosEq(this.oSel.from,B)&&this.PosEq(this.oSel.to,A)){return}if(this.PosLess(A,B)){var x=A;A=B;B=x}if(B.line!=u){var y=this.SkipHidden(B,u,this.oSel.from.ch);if(!y){this.SetLineHidden(B.line,false)}else{B=y}}if(A.line!=z){A=this.SkipHidden(A,z,this.oSel.to.ch)}if(this.PosEq(B,A)||this.PosEq(B,this.oSel.to)){this.oSel.inverted=false}else{if(this.PosEq(A,this.oSel.from)){this.oSel.inverted=true}}if(this.PosEq(this.oSel.from,this.oSel.to)){var w=this.oSel.inverted?B:A;if(w.line!=this.oSel.from.line&&this.oSel.from.line<this.oDoc.size){var v=this.GetLine(this.oSel.from.line);if(/^\s+$/.test(v.text)){setTimeout(this.Action(function(){if(v.parent&&/^\s+$/.test(v.text)){var C=e(v);this.ReplaceRange("",{line:C,ch:0},{line:C,ch:v.text.length})}},this),10)}}}this.oSel.from=B;this.oSel.to=A;this.selectionChanged=true},PosEq:function(v,u){return v.line==u.line&&v.ch==u.ch},PosLess:function(v,u){return v.line<u.line||(v.line==u.line&&v.ch<u.ch)},CopyPos:function(u){return{line:u.line,ch:u.ch}},GetCharWidth:function(){if(this.pScroller.clientWidth==this._cachedWidthFor){return this._cachedWidth}this._cachedWidthFor=this.pScroller.clientWidth;var u=BX.create("SPAN",{text:" x"});BX.cleanNode(this.pMeasure);this.pMeasure.appendChild(BX.create("PRE",{children:[u]}));this._cachedWidth=u.offsetWidth||10;return this._cachedWidth},RestartBlink:function(){if(this._blinkerInterval){this._blinkerInterval=clearInterval(this._blinkerInterval)}var v=this.pCursor,u=true;v.style.visibility="";this._blinkerInterval=setInterval(function(){v.style.visibility=(u=!u)?"":"hidden"},this.cursorInterval)},ReadInput:function(){if(!this.focused||this.HasSelection(this.pInput)){return false}var v=this.pInput.value;if(v==this.prevInput){return false}this.shiftSelecting=null;var w=0,u=Math.min(this.prevInput.length,v.length);while(w<u&&this.prevInput[w]==v[w]){++w}if(w<this.prevInput.length){this.oSel.from={line:this.oSel.from.line,ch:this.oSel.from.ch-(this.prevInput.length-w)}}this.ReplaceSelection(v.slice(w),"end");if(v.length>1000){this.pInput.value=this.prevInput=""}else{this.prevInput=v}return true},ResetInput:function(u){if(!this.PosEq(this.oSel.from,this.oSel.to)){this.prevInput="";this.pInput.value=this.GetSelection();if(this.focused){if(BX.browser.IsIOS()){this.pInput.selectionStart=0;this.pInput.selectionEnd=this.pInput.value.length}else{this.pInput.select()}}}else{if(u){this.prevInput=this.pInput.value=""}}},FocusInput:function(){BX.focus(this.pInput)},SetShift:function(u){if(u){this.shiftSelecting=this.shiftSelecting||(this.oSel.inverted?this.oSel.to:this.oSel.from)}else{this.shiftSelecting=null}},MakeTab:function(v){var x,u=this.tabSize-v%this.tabSize;if(this._tabCache[u]){return this._tabCache[u]}for(x="",i=0;i<u;++i){x+=" "}this._tabCache[u]={element:BX.create("TT",{text:x,props:{className:"bxce-tabspan"}}),width:u};return this._tabCache[u]},ComputeMaxLength:function(){this.maxLine=this.GetLine(0);this.maxLineChanged=true;var v=this,u=this.maxLine.text.length;this.oDoc.Iteration(1,this.oDoc.size,function(x){var w=x.text;if(!x.hidden&&w.length>u){u=w.length;v.maxLine=x}});this.updateMaxLine=false},MeasureLine:function(u,w){if(w==0){return{top:0,left:0}}var z=u.getElement(BX.proxy(this.MakeTab,this),w,false);BX.cleanNode(this.pMeasure);this.pMeasure.appendChild(z);var v=z.anchor,y=v.offsetTop,x=v.offsetLeft;return{top:y,left:x}},ScrollCursorIntoView:function(){var x=this.CalculateCursorCoords();this.ScrollIntoView(x.x,x.y,x.x,x.yBot);if(!this.focused){return}var v=this.pSizeCont.getBoundingClientRect(),u=null;if(x.y+v.top<0){u=true}else{if(x.y+v.top+this.TextHeight()>(window.innerHeight||document.documentElement.clientHeight)){u=false}}if(u!=null){var w=this.pCursor.style.display=="none";if(w){this.pCursor.style.display="";this.pCursor.style.left=x.x+"px";this.pCursor.style.top=(x.y-this.displayOffset)+"px"}this.pCursor.scrollIntoView(u);if(w){this.pCursor.style.display="none"}}},CalculateCursorCoords:function(){var u=this.LocalCoords(this.oSel.inverted?this.oSel.from:this.oSel.to);return{x:u.x,y:u.y,yBot:u.yBot}},ScrollIntoView:function(v,x,u,w){var y=this.CalculateScrollPos(v,x,u,w);if(y.scrollLeft!=null){this.pScroller.scrollLeft=y.scrollLeft}if(y.scrollTop!=null){this.pScrollbar.scrollTop=this.pScroller.scrollTop=y.scrollTop}},CalculateScrollPos:function(x,E,v,C){var A=this.PaddingLeft(),J=this.PaddingTop();E+=J;C+=J;x+=A;v+=A;var G=this.pScroller.clientHeight,y=this.pScrollbar.scrollTop,I={},w=this.NeedsScrollbar()||Infinity,u=E<J+10,B=C+J>w-10,F=this.pScroller.clientWidth,H=this.pScroller.scrollLeft,D=this.pLineNum.clientWidth,z=x<D+A+10;if(E<y){I.scrollTop=u?0:Math.max(0,E)}else{if(C>y+G){I.scrollTop=(B?w:C)-G}}if(x<H+D||z){if(z){x=0}I.scrollLeft=Math.max(0,x-10-D)}else{if(v>F+H-3){I.scrollLeft=v+10-F}}return I},LocalCoords:function(A,w){var u,v=this.TextHeight(),z=v*(this.HeightAtLine(this.oDoc,A.line)-(w?this.displayOffset:0));if(A.ch==0){u=0}else{u=this.MeasureLine(this.GetLine(A.line),A.ch).left}return{x:u,y:z,yBot:z+v}},CoordsChar:function(H,G){var N=this,E=this.TextHeight(),B=this.GetCharWidth(),O=this.displayOffset+Math.floor(G/E);if(O<0){return{line:0,ch:0}}var I=this.LineAtHeight(this.oDoc,O);if(I>=this.oDoc.size){return{line:this.oDoc.size-1,ch:this.GetLine(this.oDoc.size-1).text.length}}var v=this.GetLine(I),K=v.text,F=0;if(H<=0&&F==0){return{line:I,ch:0}}var C=false;function P(x){var y=N.MeasureLine(v,x);return y.left}var M=0,L=0,w=K.length,u;var J=Math.min(w,Math.ceil((H+F*this.pScroller.clientWidth*0.9)/B));while(true){var D=P(J);if(D<=H&&J<w){J=Math.min(w,Math.ceil(J*1.2))}else{u=D;w=J;break}}if(H>u){return{line:I,ch:w}}J=Math.floor(w*0.8);D=P(J);if(D<H){M=J;L=D}while(true){if(w-M<=1){var A=H-L<u-H;return{line:I,ch:A?M:w,after:A}}var Q=Math.ceil((M+w)/2),z=P(Q);if(z>H){w=Q;u=z;if(C){u+=1000}}else{M=Q;L=z}}},UpdateVerticalScroll:function(v){var w=this;var u=this.NeedsScrollbar();this.pScrollbar.style.display=u?"block":"none";if(u){this.pScrollbarInner.style.height=this.pSizeCont.style.minHeight=u+"px";this.pScrollbar.style.height=this.pScroller.clientHeight+"px";if(v!=null){this.pScrollbar.scrollTop=this.pScroller.scrollTop=v;if(BX.browser.IsSafari()||BX.browser.IsChrome()){setTimeout(function(){if(w.pScrollbar.scrollTop!=v){return}w.pScrollbar.scrollTop=v+(v?-1:1);w.pScrollbar.scrollTop=v},0)}}}else{this.pSizeCont.style.minHeight=""}this.pMover.style.top=this.displayOffset*this.TextHeight()+"px"},NeedsScrollbar:function(){var u=this.oDoc.size*this.TextHeight()+2*this.PaddingTop();return u*0.99>this.pScroller.offsetHeight?u:false},PaddingTop:function(){return this.pLinesCont.offsetTop},PaddingLeft:function(){return this.pLinesCont.offsetLeft},PosFromMouse:function(A,z){var w=a(this.pScroller,true),u=A.clientX,B=A.clientY;if(!z&&(u-w.left>this.pScroller.clientWidth||B-w.top>this.pScroller.clientHeight)){return null}var v=a(this.pLinesCont,true);return this.CoordsChar(u-v.left,B-v.top)},LineAtHeight:function(A,y){var w=0;outer:do{for(var x=0,z=A.children.length;x<z;++x){var v=A.children[x],u=v.height;if(y<u){A=v;continue outer}y-=u;w+=v.GetSize()}return w}while(!A.lines);for(var x=0;x<A.lines.length;++x){var C=A.lines[x],B=C.height;if(y<B){break}y-=B}return w+x},HeightAtLine:function(u,A){var w=0;outer:do{for(var v=0,y=u.children.length;v<y;++v){var z=u.children[v],x=z.GetSize();if(A<x){u=z;continue outer}A-=x;w+=z.height}return w}while(!u.lines);for(var v=0;v<A;++v){w+=u.lines[v].height}return w},GetUnchanged:function(B,A){var z,w,C,y,x,u=A.length||0,v;for(x=0;x<u;++x){z=A[x];w=[];C=z.diff||0;for(v=0;v<B.length;++v){y=B[v];if(z.to<=y.from&&z.diff){w.push({from:y.from+C,to:y.to+C,domStart:y.domStart})}else{if(z.to<=y.from||z.from>=y.to){w.push(y)}else{if(z.from>y.from){w.push({from:y.from,to:z.from,domStart:y.domStart})}if(z.to<y.to){w.push({from:z.to+C,to:y.to+C,domStart:y.domStart+(z.to-y.from)})}}}}B=w}return B},PatchDisplay:function(E,F,D){function u(I){var H=I.nextSibling;I.parentNode.removeChild(I);return H}if(!D.length){BX.cleanNode(this.pLineDiv)}else{var x=0,z,G,y,C,w=this.pLineDiv.firstChild,v;for(z=0;z<D.length;++z){G=D[z];while(G.domStart>x){w=u(w);x++}for(y=0,C=G.to-G.from;y<C;++y){w=w.nextSibling;x++}}while(w){w=u(w)}}var B=this,A=D.shift(),y=E;w=this.pLineDiv.firstChild;this.oDoc.Iteration(E,F,function(H){var I;if(A&&A.to==y){A=D.shift()}if(!A||A.from>y){if(H.hidden){I=BX.create("PRE")}else{I=H.getElement(BX.proxy(B.MakeTab,B));if(H.className){I.className=H.className}if(H.bgClassName){I=BX.create("DIV",{children:[BX.create("PRE",{html:"\u00a0",props:{className:H.bgClassName},style:{position:"absolute",left:0,right:0,top:0,bottom:0,zIndex:-2}}),I],style:{position:"relative"}})}}B.pLineDiv.insertBefore(I,w)}else{w=w.nextSibling}++y})},UpdateLineNum:function(){var w=this.pMover.offsetHeight,F=this.pScroller.clientHeight,E=document.createDocumentFragment(),B=this.showingFrom,D;this.pLineNum.style.height=(w-F<2?F:w)+"px";this.oDoc.Iteration(this.showingFrom,Math.max(this.showingTo,this.showingFrom+1),function(G){if(G.hidden){E.appendChild(BX.create("PRE"))}else{var I=E.appendChild(BX.create("PRE",{html:B+1}));for(var H=1;H<G.height;++H){I.appendChild(BX.create("BR"));I.appendChild(document.createTextNode("\u00a0"))}D=B}++B});this.pLineNum.style.display="none";BX.cleanNode(this.pLineNumText);this.pLineNumText.appendChild(E);if(D!=null){var v="",y=this.pLineNumText.childNodes[D-this.showingFrom],A=String(this.oDoc.size).length,u=y.firstChild,x="";if(u){v=u.textContent||u.innerText||u.nodeValue||""}while(v.length+x.length<A){x+="\u00a0"}if(x){y.insertBefore(document.createTextNode(x),y.firstChild)}}this.pLineNum.style.display="";var z=parseInt(this.pLineNum.offsetWidth);if(z>=53){z=53}var C=Math.abs((parseInt(this.pLinesCont.style.marginLeft)||0)-z)>2;this.pLinesCont.style.marginLeft=z+"px";this.lineNumDirty=false;return C},UpdateSelection:function(){var x=this.PosEq(this.oSel.from,this.oSel.to),I=this.LocalCoords(this.oSel.from,true),C=x?I:this.LocalCoords(this.oSel.to,true),A=this.oSel.inverted?I:C,v=this.TextHeight(),u=a(this.pInnerContHL),w=a(this.pLineDiv);this.pInputCont.style.top=Math.max(0,Math.min(this.pScroller.offsetHeight,A.y+w.top-u.top))+"px";this.pInputCont.style.left=Math.max(0,Math.min(this.pScroller.offsetWidth,A.x+w.left-u.left))+"px";if(x){this.pCursor.style.top=A.y+"px";this.pCursor.style.left=A.x+"px";this.pCursor.style.display="";this.pSelectionDiv.style.display="none"}else{var F=I.y==C.y,H=document.createDocumentFragment(),D=this.pLinesCont.clientWidth||this.pLinesCont.offsetWidth,z=this.pLinesCont.clientHeight||this.pLinesCont.offsetHeight;function G(M,L,K,J){var N=H.appendChild(BX.create("DIV",{props:{className:"bxce-selected"},style:{position:"absolute",left:M+"px",top:L+"px",height:J+"px"}}));N.style.width=(K?(D-K-M):D)+"px"}if(this.oSel.from.ch&&I.y>=0){var E=F?D-C.x:0;G(I.x,I.y,E,v)}var y=Math.max(0,I.y+(this.oSel.from.ch?v:0));var B=Math.min(C.y,z)-y;if(B>0.2*v){G(0,y,0,B)}if((!F||!this.oSel.from.ch)&&C.y<z-0.5*v){G(0,C.y,D-C.x,v)}BX.cleanNode(this.pSelectionDiv);this.pSelectionDiv.appendChild(H);this.pCursor.style.display="none";this.pSelectionDiv.style.display=""}},OnScrollBar:function(u){if(this.pScrollbar.scrollTop!=this._lastScrollTop){this._lastScrollTop=this.pScroller.scrollTop=this.pScrollbar.scrollTop;this.UpdateDisplay([])}},OnScrollMain:function(u){if(this.pLineNum.style.left!=this.pScroller.scrollLeft+"px"){this.pLineNum.style.left=this.pScroller.scrollLeft+"px"}if(this.pScroller.scrollTop!=this._lastScrollTop){this._lastScrollTop=this.pScroller.scrollTop;if(this.pScrollbar.scrollTop!=this._lastScrollTop){this.pScrollbar.scrollTop=this._lastScrollTop}this.UpdateDisplay([])}},OnMouseDown:function(x){if(!x){x=window.event}if(!this.highlightMode){return}if(x.button&&x.button!==0){return}this.SetShift(x.shiftKey);var z,w=x.target||x.srcElement;for(z=w;z!=this.pInnerContHL;z=z.parentNode){if(z.parentNode==this.pSizeCont&&z!=this.pMover){return}}for(z=w;z!=this.pInnerContHL;z=z.parentNode){if(z.parentNode==this.pLineNumText){return BX.PreventDefault(x)}}var y=this.PosFromMouse(x);if(m(x)==2){if(y){this.SetCursor(y.line,y.ch,true)}setTimeout(BX.proxy(this.FocusInput,this),20);return BX.PreventDefault(x)}if(!y){if(w==this.pScroller){BX.PreventDefault(x)}return}if(!this.focused){this.OnFocus()}var u=+new Date;this._type="single";if(this.lastDoubleClick&&this.lastDoubleClick.time>u-400&&this.PosEq(this.lastDoubleClick.pos,y)){this._type="triple";BX.PreventDefault(x);setTimeout(BX.proxy(this.FocusInput,this),20);this.SelectLine(y.line)}else{if(this.lastClick&&this.lastClick.time>u-400&&this.PosEq(this.lastClick.pos,y)){this._type="double";this.LastDoubleClick={time:u,pos:y};BX.PreventDefault(x);var v=this.FindWordAt(y);this.SetSelectionUser(v.from,v.to)}else{this.lastClick={time:u,pos:y}}}this._selectingTimeout=null;this._last=y;this._start=y;BX.PreventDefault(x);if(this._type=="single"){this.SetCursor(y.line,y.ch,true)}this._startstart=this.oSel.from;this._startend=this.oSel.to;BX.bind(document,"mousemove",BX.proxy(this.OnMouseMove,this));BX.bind(document,"mouseup",BX.proxy(this._OnDone,this))},_DoSelect:function(v){if(this._type=="single"){this.SetSelectionUser(this._start,v)}else{if(this._type=="double"){var u=this.FindWordAt(v);if(this.PosLess(v,this._startstart)){this.SetSelectionUser(u.from,this._startend)}else{this.SetSelectionUser(this._startstart,u.to)}}else{if(this._type=="triple"){if(this.PosLess(v,this._startstart)){this.SetSelectionUser(this._startend,this.ClipPos({line:v.line,ch:0}))}else{this.SetSelectionUser(this._startstart,this.ClipPos({line:v.line+1,ch:0}))}}}}},OnMouseMove:function(u){this.OnBeforeAction();if(this._selectingTimeout){this._selectingTimeout=clearTimeout(this._selectingTimeout)}BX.PreventDefault(u);if(!BX.browser.IsIE()&&!m(u)){this._OnDone(u)}else{this._OnExtend(u)}this.OnAfterAction()},_OnDone:function(u){if(this._selectingTimeout){this._selectingTimeout=clearTimeout(this._selectingTimeout)}var v=this.PosFromMouse(u);if(v){this._DoSelect(v)}BX.PreventDefault(u);this.FocusInput();this.updateInput=true;this.ResetInput(this.userSelChange);BX.unbind(document,"mousemove",BX.proxy(this.OnMouseMove,this));BX.unbind(document,"mouseup",BX.proxy(this._OnDone,this))},_OnExtend:function(u){var x=this,w=this.PosFromMouse(u,true);if(w&&!this.PosEq(w,this._last)){if(!this.focused){this.OnFocus()}this._last=w;this._DoSelect(w);this.updateInput=false;var v=this.VisibleLines();if(w.line>=v.to||w.line<v.from){this._selectingTimeout=setTimeout(this.Action(function(){x._OnExtend(u)},this),150)}}},OnDoubleClick:function(u){return BX.PreventDefault(u)},DoHandleBinding:function(w,u){if(typeof w=="string"){w=this.GetCommand(w);if(!w){return false}}var v=this.shiftSelecting;try{if(u){this.suppressEdits=null}w()}catch(x){throw x;return false}finally{this.shiftSelecting=v;this.suppressEdits=false}return true},HandleKeyBinding:function(y){var z=this,u=this.keyNames[y.keyCode],x=false;if(u==null||y.altGraphKey){return false}if(y.altKey){u="Alt-"+u}if(y.ctrlKey){u="Ctrl-"+u}if(y.metaKey){u="Cmd-"+u}var w=false;function v(){w=true}if(y.shiftKey){x=this.LookupKey("Shift-"+u,function(A){return z.DoHandleBinding(A,true)},v)||this.LookupKey(u,function(A){if(typeof A=="string"&&/^go[A-Z]/.test(A)){return z.DoHandleBinding(A)}},v)}else{x=this.LookupKey(u,BX.proxy(this.DoHandleBinding,this),v)}if(w){x=false}if(x){BX.PreventDefault(y);this.RestartBlink();if(BX.browser.IsIE()){y.oldKeyCode=y.keyCode;y.keyCode=0}}return x},HandleCharBinding:function(w,u){var x=this;var v=this.LookupKey("'"+u+"'",function(y){return x.DoHandleBinding(y,true)});if(v){BX.PreventDefault(w);x.RestartBlink()}return v},OnKeyDown:function(w){if(!this.focused){this.OnFocus()}if(BX.browser.IsIE()&&w.keyCode==27){w.returnValue=false}if(this.pollingFast&&this.ReadInput()){this.pollingFast=false}var u=w.keyCode;this.SetShift(u==16||w.shiftKey);var v=this.HandleKeyBinding(w);if(BX.browser.IsOpera()){this._lastStoppedKey=v?u:null;if(!v&&u==88&&w.ctrlKey){this.ReplaceSelection("")}}},OnKeyPress:function(x){if(this.pollingFast){this.ReadInput()}var w=x.keyCode,u=x.charCode;if(BX.browser.IsOpera()&&w==this._lastStoppedKey){this._lastStoppedKey=null;return BX.PreventDefault(x)}if(BX.browser.IsOpera()&&(!x.which||x.which<10)&&this.HandleKeyBinding(x)){return}var v=String.fromCharCode(u==null?w:u);if(this.oSyntax.magicSym&&this.oSyntax.magicSym.indexOf(v)>-1){setTimeout(this.Action(function(){this.IndentLine(this.oSel.to.line,"smart")},this),75)}if(this.HandleCharBinding(x,v)){return}this.FastPoll()},OnKeyUp:function(u){if(u.keyCode==16){this.shiftSelecting=null}},OnFocus:function(){if(!this.focused){this.focused=true;BX.addClass(this.pScroller,"bxce-focused");this.ResetInput(true)}this.SlowPoll();this.RestartBlink()},OnBlur:function(){this.Save();var u=this;if(this.focused){this.focused=false;if(this.bracketHighlighted){this.Action(function(){if(this.bracketHighlighted){this.bracketHighlighted();this.bracketHighlighted=null}},this)}BX.removeClass(this.pScroller,"bxce-focused")}if(this._blinkerInterval){this._blinkerInterval=clearInterval(this._blinkerInterval)}setTimeout(function(){if(!u.focused){u.shiftSelecting=null}},150)},ReplaceRange:function(v,z,y){var x=this;z=this.ClipPos(z);y=y?this.ClipPos(y):z;v=this.ExplodeLines(v);function w(C){if(x.PosLess(C,z)){return C}if(!x.PosLess(y,C)){return u}var A=C.line+v.length-(y.line-z.line)-1;var B=C.ch;if(C.line==y.line){B+=v[v.length-1].length-(y.ch-(y.line==z.line?z.ch:0))}return{line:A,ch:B}}var u;this.ReplaceRange1(v,z,y,function(A){u=A;return{from:w(x.oSel.from),to:w(x.oSel.to)}});return u},ReplaceSelection:function(u,v){var w=this;this.ReplaceRange1(this.ExplodeLines(u),this.oSel.from,this.oSel.to,function(x){if(v=="end"){return{from:x,to:x}}else{if(v=="start"){return{from:w.oSel.from,to:w.oSel.from}}else{return{from:w.oSel.from,to:x}}}})},ReplaceRange1:function(x,z,y,u){var w=x.length==1?x[0].length+z.ch:x[x.length-1].length,v=u({line:z.line+x.length-1,ch:w});this.UpdateLines(z,y,x,v.from,v.to)},GetRange:function(z,y,x){var v=z.line,u=y.line;if(v==u){return this.GetLine(v).text.slice(z.ch,y.ch)}var w=[this.GetLine(v).text.slice(z.ch)];this.oDoc.Iteration(v+1,u,function(A){w.push(A.text)});w.push(this.GetLine(u).text.slice(0,y.ch));return w.join(x||"\n")},GetSelection:function(u){return this.GetRange(this.oSel.from,this.oSel.to,u)},SlowPoll:function(){if(!this.pollingFast){this.pollDelayed.set(this.pollInterval,BX.proxy(this.OnSlowPoolRun,this))}},OnSlowPoolRun:function(){if(!this.highlightMode){return BX.DoNothing}this.OnBeforeAction();this.ReadInput();if(this.focused){this.SlowPoll()}this.OnAfterAction()},FastPoll:function(){var w=this,u=false;this.pollingFast=true;function v(){w.OnBeforeAction();var x=w.ReadInput();if(!x&&!u){u=true;w.pollDelayed.set(60,v)}else{w.pollingFast=false;w.SlowPoll()}w.OnAfterAction()}this.pollDelayed.set(20,v)},ChangeLine:function(v,x){var w=v,u=v;if(typeof v=="number"){u=this.GetLine(this.ClipLine(v))}else{w=this.LineNo(v)}if(w==null){return null}if(x(u,w)){this.arChanges.push({from:w,to:w+1})}else{return null}return u},SetLineHidden:function(v,u){var w=this;return this.ChangeLine(v,function(x,A){if(x.hidden!=u){x.hidden=u;if(u&&x.text.length==this.maxLine.text.length){this.updateMaxLine=true}else{if(!u&&x.text.length>this.maxLine.text.length){this.maxLine=x;this.updateMaxLine=false}}w.UpdateLineHeight(x,u?0:1);var z=this.oSel.from.line,y=this.oSel.to.line;if(u&&(z==A||y==A)){var C=z==A?w.SkipHidden({line:z,ch:0},z,0):this.oSel.from;var B=y==A?w.SkipHidden({line:y,ch:0},y,0):this.oSel.to;if(!B){return}w.SetSelection(C,B)}return(w.lineNumDirty=true)}})},UpdateLineHeight:function(v,u){this.lineNumDirty=true;var w=u-v.height;for(var x=v;x;x=x.parent){x.height+=w}},SkipHidden:function(A,v,w){var z=this;function y(D){var F=A.line+D,C=D==1?z.oDoc.size:-1;while(F!=C){var B=getLine(F);if(!B.hidden){var E=A.ch;if(x||E>w||E>B.text.length){E=B.text.length}return{line:F,ch:E}}F+=D}}var u=this.GetLine(A.line),x=A.ch==u.text.length&&A.ch!=w;if(!u.hidden){return A}if(A.line>=v){return y(1)||y(-1)}else{return y(-1)||y(1)}},SelectLine:function(u){this.SetSelectionUser({line:u,ch:0},this.ClipPos({line:u+1,ch:0}))},IndentSelected:function(u){if(this.PosEq(this.oSel.from,this.oSel.to)){return this.IndentLine(this.oSel.from.line,u)}var w=this.oSel.to.line-(this.oSel.to.ch?0:1);for(var v=this.oSel.from.line;v<=w;++v){this.IndentLine(v,u)}},IndentLine:function(v,C){if(!C){C="add"}if(C=="smart"){if(!this.oSyntax.Indent){C="prev"}else{var w=this.GetStateBefore(v)}}var D=this.GetLine(v),y=D.indentation(this.tabSize),u=D.text.match(/^\s*/)[0],A;if(C=="smart"){A=this.oSyntax.Indent(w,D.text.slice(u.length),D.text)}if(C=="prev"){A=v?this.GetLine(v-1).indentation(this.tabSize):0}else{if(C=="add"){A=y+this.indentUnit}else{if(C=="subtract"){A=y-this.indentUnit}}}A=Math.max(0,A);var x,B="",z=0;for(x=Math.floor(A/this.tabSize);x;--x){z+=this.tabSize;B+="\t"}while(z<A){++z;B+=" "}if(B!=u){this.ReplaceRange(B,{line:v,ch:0},{line:v,ch:u.length})}},FindPosH:function(x,C){var B=this,y=this.oSel.inverted?this.oSel.from:this.oSel.to,D=y.line,u=y.ch,A=this.GetLine(D);function v(){var E,F,G;for(E=D+x,G=x<0?-1:B.oDoc.size;E!=G;E+=x){F=B.GetLine(E);if(!F.hidden){D=E;A=F;return true}}return false}function z(E){if(u==(x<0?0:A.text.length)){if(!E&&v()){u=x<0?A.text.length:0}else{return false}}else{u+=x}return true}if(C=="char"){z()}else{if(C=="column"){z(true)}else{if(C=="word"){var w=false;for(;;){if(x<0){if(!z()){break}}if(b(A.text.charAt(u))){w=true}else{if(w){if(x<0){x=1;z()}break}}if(x>0&&!z()){break}}}}}return{line:D,ch:u}},MoveH:function(u,v){var w=u<0?this.oSel.from:this.oSel.to;if(this.shiftSelecting||this.PosEq(this.oSel.from,this.oSel.to)){w=this.FindPosH(u,v)}this.SetCursor(w.line,w.ch,true)},DeleteH:function(u,v){if(!this.PosEq(this.oSel.from,this.oSel.to)){this.ReplaceRange("",this.oSel.from,this.oSel.to)}else{if(u<0){this.ReplaceRange("",this.FindPosH(u,v),this.oSel.to)}else{this.ReplaceRange("",this.oSel.from,this.FindPosH(u,v))}}this.userSelChange=true},MoveV:function(v,x){var u,y,w,z=this.LocalCoords(this.oSel.inverted?this.oSel.from:this.oSel.to,true);if(this.goalColumn!=null){z.x=this.goalColumn}if(x=="page"){u=Math.min(this.pScroller.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=this.CoordsChar(z.x,z.y+u*v)}else{if(x=="line"){w=this.TextHeight();y=this.CoordsChar(z.x,z.y+0.5*w+v*w)}}if(x=="page"){this.pScrollbar.scrollTop+=this.LocalCoords(y,true).y-z.y}this.SetCursor(y.line,y.ch,true);this.goalColumn=z.x},FindWordAt:function(z){var x=this.GetLine(z.line).text,y=z.ch,w=z.ch;if(x){if(z.after===false||w==x.length){--y}else{++w}var v=x.charAt(y),u=b(v)?b:/\s/.test(v)?function(A){return/\s/.test(A)}:function(A){return !/\s/.test(A)&&!b(A)};while(y>0&&u(x.charAt(y-1))){--y}while(w<x.length&&u(x.charAt(w))){++w}}return{from:{line:z.line,ch:y},to:{line:z.line,ch:w}}},InitKeyEngine:function(){this.Map={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goHome",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharRight",Backspace:"delCharLeft",Tab:"tab","Shift-Tab":"indentLess",Enter:"newlineAndIndent",Insert:"toggleOverwrite"};if(BX.browser.IsMac()){this.Map["Cmd-A"]="selectAll";this.Map["Cmd-D"]="deleteLine";this.Map["Cmd-Z"]="undo";this.Map["Cmd-Up"]="goDocStart";this.Map["Cmd-End"]="goDocEnd";this.Map["Cmd-Down"]="goDocEnd";this.Map["Alt-Left"]="goWordLeft";this.Map["Alt-Right"]="goWordRight";this.Map["Cmd-Left"]="goLineStart";this.Map["Cmd-Right"]="goLineEnd";this.Map["Alt-Backspace"]="delWordLeft";this.Map["Ctrl-Alt-Backspace"]="delWordRight";this.Map["Alt-Delete"]="delWordRight"}else{this.Map["Ctrl-A"]="selectAll";this.Map["Ctrl-D"]="deleteLine";this.Map["Ctrl-Z"]="undo";this.Map["Ctrl-Home"]="goDocStart";this.Map["Alt-Up"]="goDocStart";this.Map["Ctrl-End"]="goDocEnd";this.Map["Ctrl-Down"]="goDocEnd";this.Map["Ctrl-Left"]="goWordLeft";this.Map["Ctrl-Right"]="goWordRight";this.Map["Alt-Left"]="goLineStart";this.Map["Alt-Right"]="goLineEnd";this.Map["Ctrl-Backspace"]="delWordLeft";this.Map["Ctrl-Delete"]="delWordRight"}this.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};var u;for(u=0;u<10;u++){this.keyNames[u+48]=String(u)}for(u=65;u<=90;u++){this.keyNames[u]=String.fromCharCode(u)}for(u=1;u<=12;u++){this.keyNames[u+111]=this.keyNames[u+63235]="F"+u}},LookupKey:function(u,x,v){var w=this.Map[u];if(w===false){if(v&&typeof v=="function"){v()}return true}return w!=null&&x(w)},GetCommand:function(u){return{selectAll:BX.proxy(function(){this.DoSelection({line:0,ch:0},{line:this.oDoc.size-1})},this),killLine:BX.proxy(function(){var x=this.GetCursor(true),w=this.GetCursor(false),v=!this.PosEq(x,w);if(!v&&this.GetLineText(x.line).length==x.ch){this.ReplaceRange("",x,{line:x.line+1,ch:0})}else{this.ReplaceRange("",x,v?w:{line:x.line})}},this),deleteLine:BX.proxy(function(){var v=this.GetCursor().line;this.ReplaceRange("",{line:v,ch:0},{line:v})},this),goCharLeft:BX.proxy(function(){this.MoveH(-1,"char")},this),goCharRight:BX.proxy(function(){this.MoveH(1,"char")},this),goColumnLeft:BX.proxy(function(){this.MoveH(-1,"column")},this),goColumnRight:BX.proxy(function(){this.MoveH(-1,"column")},this),goDocStart:BX.proxy(function(){this.SetCursor(0,0,true)},this),goDocEnd:BX.proxy(function(){this.DoSelection({line:this.oDoc.size-1},null,true)},this),goLineStart:BX.proxy(function(){this.SetCursor(this.GetCursor().line,0,true)},this),goHome:BX.proxy(function(){var x=this.GetCursor(),w=this.GetLineText(x.line),v=Math.max(0,w.search(/\S/));this.SetCursor(x.line,x.ch<=v&&x.ch?0:v,true)},this),goLineEnd:BX.proxy(function(){this.DoSelection({line:this.GetCursor().line},null,true)},this),goLineUp:BX.proxy(function(){this.MoveV(-1,"line")},this),goLineDown:BX.proxy(function(){this.MoveV(1,"line")},this),goPageUp:BX.proxy(function(){this.MoveV(-1,"page")},this),goPageDown:BX.proxy(function(){this.MoveV(1,"page")},this),goWordLeft:BX.proxy(function(){this.MoveH(-1,"word")},this),goWordRight:BX.proxy(function(){this.MoveH(1,"word")},this),delCharLeft:BX.proxy(function(){this.DeleteH(-1,"char")},this),delCharRight:BX.proxy(function(){this.DeleteH(1,"char")},this),delWordLeft:BX.proxy(function(){this.DeleteH(-1,"word")},this),delWordRight:BX.proxy(function(){this.DeleteH(1,"word")},this),indentLess:BX.proxy(function(){this.IndentSelection("subtract")},this),tab:BX.proxy(function(){if(this.PosEq(this.oSel.from,this.oSel.to)){this.ReplaceSelection("\t","end")}else{this.IndentSelection("add")}},this),undo:BX.proxy(this.Undo,this),enter:BX.proxy(function(){this.ReplaceSelection("\n","end");this.IndentLine(this.GetCursor().line)},this)}[u]},IndentSelection:function(u){this.OnBeforeAction();this.IndentSelected(u);this.OnAfterAction()},DoSelection:function(y,x,v){this.OnBeforeAction();var w=this.ClipPos(y),u=this.ClipPos(x||y);if(v){this.SetSelectionUser(w,u)}else{this.SetSelection(w,u)}this.OnAfterAction()},GetLineText:function(u){if(u>=0&&u<this.oDoc.size){return this.GetLine(u).text}return""},CheckLinesHeight:function(u,y,v){var z=u.split("\n"),w,B,x,C=false,A;v=z.length-1;y=0;for(w=y;w<=v;w++){if(B=this.pLineNumTA.childNodes[w]){x=this.GetLineHeight(z[w]);A=parseInt(B.style.height);if(x>this.lineHeight||B.style.height!=""){B.style.height=z[w]?x+"px":"";if(A!=x){C=true}}}}return C},BuildLineNum:function(v){v=parseInt(v);if(v!==this.lineNums){if(v<1){v=1}if(this.lineNums<v){for(var u=this.lineNums+1;u<=v;u++){this.pLineNumTA.appendChild(BX.create("DIV",{html:u}))}this.lineNums=v}}},TextOnKeydown:function(v){if(!v){v=window.event}var u=v.which||v.keyCode;if(u==9){this.OnTab(v,this.ShiftPressed(v));return BX.PreventDefault(v)}},TextOnKeyup:function(v,u){if(!v){v=window.event}if(!u){u=v.which||v.keyCode}if(!{17:true,18:true,9:true,27:true}[u]){this.CheckLineSelection()}},TextOnMousedown:function(u){this.MoveLineSelection(true)},ShiftPressed:function(u){if(window.event){return !!window.event.shiftKey}return !!(u.shiftKey||u.modifiers>3)},OnTab:function(D,v){if(this.bDisableTab){return}if(BX.browser.IsIE()){this.bDisableTab=true}var A,w,G,B,x="\t",H=this.GetTASelection(),F=H.start,E=H.end,u=this.GetTAValue().replace(/\r/g,""),z=u.substring(F,E),I=F,y=E;if(!v){if(z==""){u=u.substr(0,F)+x+u.substr(E);I=F+1;y=I}else{F=u.substr(0,F).lastIndexOf("\n")+1;if(F<=0){F=0}w=u.substr(E);G=u.substr(0,F);B=u.substring(F,E).split("\n");z=x+B.join("\n"+x);u=G+z+w;I=F;y=u.indexOf("\n",G.length+z.length);if(y==-1){y=u.length}}}else{if(z==""){if(F<=0){F=1}if(u.substring(F-1,F)==x){u=u.substr(0,F-1)+u.substr(E);I=y=F-1}}else{F=u.substr(0,F).lastIndexOf("\n")+1;w=u.substr(E);G=u.substr(0,F);B=u.substring(F,E).split("\n");z="";for(A=0;A<B.length;A++){for(j=0,l=this.tabSymTA.length;j<l;j++){if(B[A].charAt(0)==x){B[A]=B[A].substr(1);j=l}}z+=B[A];if(A<B.length-1){z+="\n"}}u=G+z+w;I=F;y=u.indexOf("\n",G.length+z.length);if(y==-1){y=u.length}}}this.SetTAValue(u);if(BX.browser.IsIE()){var C=this;this.SetIETASelection(I,y);setTimeout(function(){C.bDisableTab=false},80)}else{this.pTA.selectionStart=I;this.pTA.selectionEnd=y}this.CheckLineSelection(true)},CheckLineSelection:function(v){if(this.highlightMode){return}var u=this.GetSelectionInfo();if(v!==false||u.source!=this.curSel.source){this.ManageSize(false)}this.curSel=u},ManageSize:function(v){if(this.highlightMode){return false}var x,y;y=parseInt(this.pTA.scrollHeight,10);this.curSel=this.GetSelectionInfo();if(!isNaN(y)&&y>=0){this.pContTA.style.height=(y+2)+"px";this.pTA.style.height=(y+2)+"px"}x=this.pTA.scrollWidth;if(BX.browser.IsChrome()){x+=18}if(parseInt(this.pTA.style.width)<x){this.pTA.style.width=x+"px";this.pContTA.style.width=x+"px"}if(v!==false){this.CheckLineSelection(true)}if(this.curSel.nbLine>=0){this.BuildLineNum(this.curSel.nbLine);var u=this.GetLinePos(this.curSel.nbLine);if(u.top+u.height<y&&this.curSel.nbLine<this.lineNums){var w=parseInt(u.top+u.height);if(!isNaN(w)&&w>=0){this.pContTA.style.height=(w+2)+"px";this.pTA.style.height=(w+2)+"px"}}}this.pTA.scrollTop="0px";this.pTA.scrollLeft="0px"},GetSelectionInfo:function(){if(!this.curSel){this.curSel={}}var w=this.GetTASelection(),B=w.start,v=w.end,A;var y={selectionStart:B,selectionEnd:v,source:this.GetTAValue().replace(/\r/g,""),linePos:1,lineNb:1,carretPos:0,curLine:"",cursorIndex:0,direction:this.curSel.direction},u=y.source.split("\n"),x=u.length,z=y.source.length-(x-1);if(z<0){z=0}y.nbLine=x;y.nbChar=z;if(B>0){A=y.source.substr(0,B);y.carretPos=B-A.lastIndexOf("\n");y.linePos=A.split("\n").length}else{y.carretPos=1}if(y.linePos<1){y.linePos=1}if(v>B){y.lineNb=y.source.substring(B,v).split("\n").length}y.cursorIndex=B;y.curLine=u[y.linePos-1];if(y.selectionStart==this.curSel.selectionStart){if(y.selectionEnd>this.curSel.selectionEnd){y.direction="down"}else{y.direction=this.curSel.direction}}else{if(y.selectionStart==this.curSel.selectionEnd&&y.selectionEnd>this.curSel.selectionEnd){y.direction="down"}else{y.direction="up"}}this.SetStatusBarInfo(y);return y},GetTASelection:function(){var A=0,v=0;try{if(BX.browser.IsIE9()||this.pTA.selectionStart!=undefined){A=this.pTA.selectionStart;v=this.pTA.selectionEnd}else{if(BX.browser.IsIE()){var x="\001";var w=document.selection.createRange();var u=w.text.replace(/\r/g,"");var y=w.duplicate();if(u!=""){w.collapse()}y.moveToElementText(this.pTA);w.text=x;v=A=y.text.replace(/\r/g,"").indexOf(x);w.moveStart("character",-1);w.text="";if(u!=""){v+=u.length}}else{A=this.pTA.selectionStart;v=this.pTA.selectionEnd}}}catch(z){A=0;v=0}return{start:A,end:v}},GetLinePos:function(v){var x=this.pLineNumTA.childNodes[v-1],w=x?x.offsetTop:this.lineHeight*(v-1),u=x?x.offsetHeight:this.lineHeight;return{top:parseInt(w)||0,height:parseInt(u)||0}},Undo:function(){this.UndoRedo(this.oHistory.done,this.oHistory.undone)},UndoRedo:function(z,A){if(!z.length){return}var w,x,C,u,y,B=z.pop(),v=[];for(w=B.length-1;w>=0;w-=1){x=B[w];C=[];u=x.start+x.added;y={line:x.start+x.old.length-1,ch:this.GetUndoChar(C[C.length-1],x.old[x.old.length-1])};this.UpdateLinesNoUndo({line:x.start,ch:0},{line:u-1,ch:this.GetLine(u-1).text.length},x.old,y,y)}this.updateInput=true;A.push(v)},GetUndoChar:function(x,w){if(!w){return 0}if(!x){return w.length}for(var v=x.length,u=w.length;v>=0&&u>=0;--v,--u){if(x.charAt(v)!=w.charAt(u)){break}}return u+1}};function q(u,v){this.pos=this.start=0;this.string=u;this.tabSize=v||8}q.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(u){var w=this.string.charAt(this.pos),v=(typeof u=="string")?(w==u):(w&&(u.test?u.test(w):u(w)));if(v){++this.pos;return w}},eatWhile:function(u){var v=this.pos;while(this.eat(u)){}return this.pos>v},eatSpace:function(){var u=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>u},skipToEnd:function(){this.pos=this.string.length},skipTo:function(u){var v=this.string.indexOf(u,this.pos);if(v>-1){this.pos=v;return true}},backUp:function(u){this.pos-=u},column:function(){return r(this.string,this.start,this.tabSize)},indentation:function(){return r(this.string,null,this.tabSize)},match:function(x,v,u){var w;if(typeof x=="string"){var y=function(z){return u?z.toLowerCase():z};if(y(this.string).indexOf(y(x),this.pos)==this.pos){if(v!==false){this.pos+=x.length}return true}}else{if(x!==null){w=this.string.slice(this.pos).match(x);if(w&&v!==false){this.pos+=w[0].length}}}return w},current:function(){return this.string.slice(this.start,this.pos)}};function f(v,u){this.styles=u||[v,null];this.text=v;this.height=1}f.inheritMarks=function(y,B){var x=new f(y),u=B&&B.marked;if(u){for(var w=0;w<u.length;++w){if(u[w].to==null&&u[w].style){var v=x.marked||(x.marked=[]),A=u[w],z=A.dup();v.push(z);z.attach(x)}}}return x};f.prototype={Replace:function(y,x,B){var C=[],w=this.marked,z=x==null?this.text.length:x;h(0,y,this.styles,C);if(B){C.push(B,null)}h(z,this.text.length,this.styles,C);this.styles=C;this.text=this.text.slice(0,y)+B+this.text.slice(z);this.statusAfter=null;if(w){var A=B.length-(z-y);for(var v=0;v<w.length;++v){var u=w[v];u.clipTo(y==null,y||0,x==null,z,A);if(u.isDead()){u.detach(this);w.splice(v--,1)}}}},split:function(B,z){var x=[z,null],v=this.marked;h(B,this.text.length,this.styles,x);var w=new f(z+this.text.slice(B),x);if(v){for(var y=0;y<v.length;++y){var A=v[y];var u=A.split(B,z.length);if(u){if(!w.marked){w.marked=[]}w.marked.push(u);u.attach(w);if(u==A){v.splice(y--,1)}}}}return w},append:function(v){var A=this.text.length,u=v.marked,y=this.marked;this.text+=v.text;h(0,v.text.length,v.styles,this.styles);if(y){for(var z=0;z<y.length;++z){if(y[z].to==null){y[z].to=A}}}if(u&&u.length){if(!y){this.marked=y=[]}outer:for(var z=0;z<u.length;++z){var B=u[z];if(!B.from){for(var x=0;x<y.length;++x){var w=y[x];if(w.to==A&&w.sameSet(B)){w.to=B.to==null?null:B.to+A;if(w.isDead()){w.detach(this);u.splice(z--,1)}continue outer}}}y.push(B);B.attach(this);B.from+=A;if(B.to!=null){B.to+=A}}}},fixMarkEnds:function(v){var u=this.marked,z=v.marked;if(!u){return}outer:for(var y=0;y<u.length;++y){var B=u[y],A=B.to==null;if(A&&z){for(var x=0;x<z.length;++x){var w=z[x];if(!w.sameSet(B)||w.from!=null){continue}if(B.from==this.text.length&&w.to==0){z.splice(x,1);u.splice(y--,1);continue outer}else{A=false;break}}}if(A){B.to=this.text.length}}},fixMarkStarts:function(){var u=this.marked;if(!u){return}for(var v=0;v<u.length;++v){if(u[v].from==null){u[v].from=0}}},addMark:function(u){u.attach(this);if(this.marked==null){this.marked=[]}this.marked.push(u);this.marked.sort(function(w,v){return(w.from||0)-(v.from||0)})},highlight:function(x,y,A){var D=new q(this.text,A),E=this.styles,B=0;var z=false,v=E[0],C;if(this.text==""&&x.blankLine){x.blankLine(y)}while(!D.eol()){var u=x.HandleChar(D,y);var w=this.text.slice(D.start,D.pos);D.start=D.pos;if(B&&E[B-1]==u){E[B-2]+=w}else{if(w){if(!z&&(E[B+1]!=u||(B&&E[B-2]!=C))){z=true}E[B++]=w;E[B++]=u;C=v;v=E[B]}}if(D.pos>5000){E[B++]=this.text.slice(D.pos);E[B++]=null;break}}if(E.length!=B){E.length=B;z=true}if(B&&E[B-2]!=C){z=true}return z||(E.length<5&&this.text.length<10?null:false)},getTokenAt:function(w,v,z,y){var x,u=this.text,A=new q(u,z);while(A.pos<y&&!A.eol()){A.start=A.pos;x=w.HandleChar(A,v)}return{start:A.start,end:A.pos,string:A.current(),className:x||null,status:v}},indentation:function(u){return r(this.text,null,u)},getElement:function(V,u,x){var P=this;var B=true,z=0,O=/[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g;var H=BX.create("PRE");function Q(ae,ai,ag){if(!ai){return}if(B&&BX.browser.IsIE()&&ai.charAt(0)==" "){ai="\u00a0"+ai.slice(1)}B=false;if(!O.test(ai)){z+=ai.length;var ah=document.createTextNode(ai)}else{var ah=document.createDocumentFragment(),aj=0;while(true){O.lastIndex=aj;var ac=O.exec(ai);var ad=ac?ac.index-aj:ai.length-aj;if(ad){ah.appendChild(document.createTextNode(ai.slice(aj,aj+ad)));z+=ad}if(!ac){break}aj+=ad+1;if(ac[0]=="\t"){var af=V(z);ah.appendChild(af.element.cloneNode(true));z+=af.width}else{ah.appendChild(BX.create("TT",{props:{className:"bxce-invalidchar",title:"\\u"+ac[0].charCodeAt(0).toString(16)},html:"\u2022"}));z+=1}}}if(ag){ae.appendChild(BX.create("TT",{props:{className:ag}})).appendChild(ah)}else{ae.appendChild(ah)}}var U=Q;if(u!=null){var M=0,C=H.anchor=BX.create("SPAN");U=function(ad,ag,ae){var ac=ag.length;if(u>=M&&u<M+ac){if(u>M){Q(ad,ag.slice(0,u-M),ae);if(x){ad.appendChild(BX.create("WBR"))}}ad.appendChild(C);var af=u-M;Q(C,BX.browser.IsOpera()?ag.slice(af,af+1):ag.slice(af),ae);if(BX.browser.IsOpera()){Q(ad,ag.slice(af+1),ae)}u--;M+=ac}else{M+=ac;Q(ad,ag,ae);if(M==u&&M==Y){BX.adjust(C,{text:P.GetEolHtml()});ad.appendChild(C)}else{if(M>u+10&&/\s/.test(ag)){U=function(){}}}}}}var L=this.styles,D=this.text,I=this.marked;var Y=D.length;function y(ac){if(!ac){return null}return"bxce-"+ac.replace(/ +/g," bxce-")}if(!D&&u==null){U(H," ")}else{if(!I||!I.length){for(var T=0,E=0;E<Y;T+=2){var K=L[T],X=L[T+1],N=K.length;if(E+N>Y){K=K.slice(0,Y-E)}E+=N;U(H,K,y(X))}}else{var A=0,T=0,G="",X,ab=0;var aa=I[0].from||0,S=[],Z=0;var W=function(){var ac;while(Z<I.length&&((ac=I[Z]).from==A||ac.from==null)){if(ac.style!=null){S.push(ac)}++Z}aa=Z<I.length?I[Z].from:Infinity;for(var ad=0;ad<S.length;++ad){var ae=S[ad].to;if(ae==null){ae=Infinity}if(ae==A){S.splice(ad--,1)}else{aa=Math.min(ae,aa)}}};var J=0;while(A<Y){if(aa==A){W()}var F=Math.min(Y,aa);while(true){if(G){var w=A+G.length;var v=X;for(var R=0;R<S.length;++R){v=(v?v+" ":"")+S[R].style}U(H,w>F?G.slice(0,F-A):G,v);if(w>=F){G=G.slice(F-A);A=F;break}A=w}G=L[T++];X=y(L[T++])}}}}return H},cleanUp:function(){this.parent=null;if(this.marked){for(var u=0,v=this.marked.length;u<v;++u){this.marked[u].detach(this)}}},GetEolHtml:function(){if(this._eolHtml!=undefined){return this._eolHtml}this._eolHtml=" ";if(BX.browser.IsFirefox()||BX.browser.IsIE()){this._eolHtml="\u200b"}else{if(BX.browser.IsOpera()){this._eolHtml=""}}return this._eolHtml}};function h(A,B,u,C){for(var y=0,z=0,x=0;z<B;y+=2){var v=u[y],w=z+v.length;if(x==0){if(w>A){C.push(v.slice(A-z,Math.min(v.length,B-z)),u[y+1])}if(w>=A){x=1}}else{if(x==1){if(w>B){C.push(v.slice(0,B-z),u[y+1])}else{C.push(v,u[y+1])}}}z=w}}function n(v){this.lines=v;this.parent=null;for(var w=0,x=v.length,u=0;w<x;++w){v[w].parent=this;u+=v[w].height}this.height=u}n.prototype={GetSize:function(){return this.lines.length},Remove:function(u,A,y){for(var x=u,z=u+A;x<z;++x){var v=this.lines[x];this.height-=v.height;v.cleanUp();if(v.handlers){for(var w=0;w<v.handlers.length;++w){y.push(v.handlers[w])}}}this.lines.splice(u,A)},Collapse:function(u){u.splice.apply(u,[u.length,0].concat(this.lines))},SetHeight:function(v,w,u){this.height+=u;this.lines=this.lines.slice(0,v).concat(w).concat(this.lines.slice(v));for(var x=0,y=w.length;x<y;++x){w[x].parent=this}},_Iteration:function(u,x,w){for(var v=u+x;u<v;++u){if(w(this.lines[u])){return true}}}};function c(x){this.children=x;var w,v=0,u=0;for(w=0;w<x.length;++w){v+=x[w].GetSize();u+=x[w].height;x[w].parent=this}this.size=v;this.height=u;this.parent=null}c.prototype={GetSize:function(){return this.size},Remove:function(u,B,x){this.size-=B;var w,A,z,y;for(w=0;w<this.children.length;++w){A=this.children[w],z=A.GetSize();if(u<z){y=Math.min(B,z-u),oldHeight=A.height;A.Remove(u,y,x);this.height-=oldHeight-A.height;if(z==y){this.children.splice(w--,1);A.parent=null}if((B-=y)==0){break}u=0}else{u-=z}}if(this.size-B<25){var v=[];this.Collapse(v);this.children=[new n(v)];this.children[0].parent=this}},Collapse:function(u){for(var v=0,w=this.children.length;v<w;++v){this.children[v].Collapse(u)}},Insert:function(v,w){var u=0;for(var x=0,y=w.length;x<y;++x){u+=w[x].height}this.SetHeight(v,w,u)},SetHeight:function(v,w,u){this.size+=w.length;this.height+=u;var z,B,y,x,A;for(z=0;z<this.children.length;++z){B=this.children[z];y=B.GetSize();if(v<=y){B.SetHeight(v,w,u);if(B.lines&&B.lines.length>50){while(B.lines.length>50){x=B.lines.splice(B.lines.length-25,25);A=new n(x);B.height-=A.height;this.children.splice(z+1,0,A);A.parent=this}this.CheckSpill()}break}v-=y}},CheckSpill:function(){if(this.children.length<=10){return}var u,v,x,w=this;do{u=w.children.splice(w.children.length-5,5);v=new c(u);if(!w.parent){x=new c(w.children);x.parent=w;w.children=[x,v];w=x}else{w.size-=v.size;w.height-=v.height;w.parent.children.splice(o(w.parent.children,w)+1,0,v)}v.parent=w.parent}while(w.children.length>10);w.parent.CheckSpill()},Iteration:function(w,v,u){this._Iteration(w,v-w,u)},_Iteration:function(u,z,y){var w,x,v;for(w=0;w<this.children.length;++w){v=this.children[w].GetSize();if(u<v){x=Math.min(z,v-u);if(this.children[w]._Iteration(u,x,y)){return true}if((z-=x)==0){break}u=0}else{u-=v}}}};function e(u){if(u.parent==null){return null}var z=u.parent,y=o(z.lines,u);for(var v=z.parent;v;z=v,v=v.parent){for(var w=0,x=v.children.length;;++w){if(v.children[w]==z){break}y+=v.children[w].GetSize()}}return y}function g(){this.time=0;this.done=[];this.undone=[];this.compound=0;this.closed=false}g.prototype={addChange:function(u,z,v){this.undone.length=0;var w=+new Date,B=this.done[this.done.length-1],C=B&&B[B.length-1];var y=w-this.time;if(this.compound&&B&&!this.closed){B.push({start:u,added:z,old:v})}else{if(y>400||!C||this.closed||C.start>u+v.length||C.start+C.added<u){this.done.push([{start:u,added:z,old:v}]);this.closed=false}else{var A=Math.max(0,C.start-u),D=Math.max(0,(u+v.length)-(C.start+C.added));for(var x=A;x>0;--x){C.old.unshift(v[x-1])}for(var x=D;x>0;--x){C.old.push(v[v.length-x])}if(A){C.start=u}C.added+=z-(v.length-A-D)}}this.time=w},startCompound:function(){if(!this.compound++){this.closed=true}},endCompound:function(){if(!--this.compound){this.closed=true}}};function m(v){var u=v.which;if(u==null){if(v.button&1){u=1}else{if(v.button&2){u=3}else{if(v.button&4){u=2}}}}if(BX.browser.IsMac()&&v.ctrlKey&&u==1){u=3}return u}function t(){this.id=null}t.prototype={set:function(u,v){clearTimeout(this.id);this.id=setTimeout(v,u)}};function r(v,u,x){x=4;if(u==null){u=v.search(/[^\s\u00a0]/);if(u==-1){u=v.length}}for(var w=0,y=0;w<u;++w){if(v.charAt(w)=="\t"){y+=x-(y%x)}else{++y}}return y}function a(w,u){try{var v=w.getBoundingClientRect();v={top:v.top,left:v.left}}catch(y){v={top:0,left:0}}if(!u){if(window.pageYOffset==null){var x=document.documentElement||document.body.parentNode;if(x.scrollTop==null){x=document.body}v.top+=x.scrollTop;v.left+=x.scrollLeft}else{v.top+=window.pageYOffset;v.left+=window.pageXOffset}}return v}function o(v,w){if(v.indexOf){return v.indexOf(w)}if(v.length){for(var u=0;u<v.length;++u){if(v[u]==w){return u}}}return -1}function b(u){return/\w/.test(u)||u.toUpperCase()!=u.toLowerCase()}var s={};function d(w,u){if(u===true){return u}if(w.copyStatus){return w.copyStatus(u)}var v={},y;for(y in u){var x=u[y];if(x instanceof Array){x=x.concat([])}v[y]=x}return v}function k(u){var w={},v;for(v=0;v<u.length;++v){w[u[v]]=true}return w}s.html=function(){var J=4,Q={autoSelfClosers:k(["area","base","br","col","command","embed","frame","hr","img","input","keygen","link","meta","param","source","track","wbr"]),implicitlyClosed:k(["dd","li","optgroup","option","p","rp","rt","tbody","td","tfoot","th","tr"]),contextGrabbers:{dd:k(["dd","dt"]),dt:k(["dd","dt"]),li:k(["li"]),option:k(["option","optgroup"]),optgroup:k(["optgroup"]),p:k(["address","article","aside","blockquote","dir","div","dl","fieldset","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","menu","nav","ol","p","pre","section","table","ul"]),rp:k(["rp","rt"]),rt:k(["rp","rt"]),tbody:k(["tbody","tfoot"]),td:k(["td","th"]),tfoot:k(["tbody"]),th:k(["td","th"]),thead:k(["tbody","tfoot"]),tr:k(["tr"])},doNotIndent:k(["pre"]),allowUnquoted:true,allowMissing:true},y,A;function L(V,R){function S(X){R.tokenize=X;return X(V,R)}var T=V.next(),W,U;if(T=="<"){if(V.eat("!")){if(V.eat("[")){return V.match("CDATA[")?S(z("atom","]]>")):null}else{if(V.match("--")){return S(z("comment","-->"))}else{if(V.match("DOCTYPE",true,true)){V.eatWhile(/[\w\._\-]/);return S(G(1))}else{return null}}}}else{if(V.eat("?")){V.eatWhile(/[\w\._\-]/);R.tokenize=z("meta","?>");return"meta"}else{A=V.eat("/")?"closeTag":"openTag";V.eatSpace();y="";while((W=V.eat(/[^\s\u00a0=<>\"\'\/?]/))){y+=W}R.tokenize=H;return"tag"}}}else{if(T=="&"){if(V.eat("#")){U=V.eat("x")?(V.eatWhile(/[a-fA-F\d]/)&&V.eat(";")):(V.eatWhile(/[\d]/)&&V.eat(";"))}else{U=V.eatWhile(/[\w\.\-:]/)&&V.eat(";")}return U?"atom":"error"}else{V.eatWhile(/[^&<]/);return null}}}function H(T,R){var S=T.next();if(S==">"||(S=="/"&&T.eat(">"))){R.tokenize=L;A=S==">"?"endTag":"selfcloseTag";return"tag"}else{if(S=="="){A="equals";return null}else{if(/[\'\"]/.test(S)){R.tokenize=P(S);return R.tokenize(T,R)}else{T.eatWhile(/[^\s\u00a0=<>\"\'\/?]/);return"word"}}}}function P(R){return function(T,S){while(!T.eol()){if(T.next()==R){S.tokenize=H;break}}return"string"}}function z(S,R){return function(U,T){while(!U.eol()){if(U.match(R)){T.tokenize=L;break}U.next()}return S}}function G(R){return function(U,S){var T;while((T=U.next())!=null){if(T=="<"){S.tokenize=G(R+1);return S.tokenize(U,S)}else{if(T==">"){if(R==1){S.tokenize=L;break}else{S.tokenize=G(R-1);return S.tokenize(U,S)}}}}return"meta"}}var D,B;function u(){for(var R=arguments.length-1;R>=0;R--){D.cc.push(arguments[R])}}function x(){u.apply(null,arguments);return true}function C(R,T){var S=Q.doNotIndent.hasOwnProperty(R)||(D.context&&D.context.noIndent);D.context={prev:D.context,tagName:R,indent:D.indented,startOfLine:T,noIndent:S}}function N(){if(D.context){D.context=D.context.prev}}function v(R){if(R=="openTag"){D.tagName=y;return x(E,w(D.startOfLine))}else{if(R=="closeTag"){var S=false;if(D.context){if(D.context.tagName!=y){if(Q.implicitlyClosed.hasOwnProperty(D.context.tagName.toLowerCase())){N()}S=!D.context||D.context.tagName!=y}}else{S=true}if(S){B="error"}return x(K(S))}}return x()}function w(R){return function(S){if(S=="selfcloseTag"||(S=="endTag"&&Q.autoSelfClosers.hasOwnProperty(D.tagName.toLowerCase()))){I(D.tagName.toLowerCase());return x()}if(S=="endTag"){I(D.tagName.toLowerCase());C(D.tagName,R);return x()}return x()}}function K(R){return function(S){if(R){B="error"}if(S=="endTag"){N();return x()}B="error";return x(arguments.callee)}}function I(S){var R;while(true){if(!D.context){return}R=D.context.tagName.toLowerCase();if(!Q.contextGrabbers.hasOwnProperty(R)||!Q.contextGrabbers[R].hasOwnProperty(S)){return}N()}}function E(R){if(R=="word"){B="attribute";return x(F,E)}if(R=="endTag"||R=="selfcloseTag"){return u()}B="error";return x(E)}function F(R){if(R=="equals"){return x(O,E)}if(!Q.allowMissing){B="error"}return(R=="endTag"||R=="selfcloseTag")?u():x()}function O(R){if(R=="string"){return x(M)}if(R=="word"&&Q.allowUnquoted){B="string";return x()}B="error";return(R=="endTag"||R=="selfCloseTag")?u():x()}function M(R){return R=="string"?x(M):u()}return{startStatus:function(){return{tokenize:L,cc:[],indented:0,startOfLine:true,tagName:null,context:null}},HandleChar:function(U,R){if(U.sol()){R.startOfLine=true;R.indented=U.indentation()}if(U.eatSpace()){return null}B=A=y=null;var T=R.tokenize(U,R);R.type=A;if((T||A)&&T!="comment"){D=R;while(true){var S=R.cc.pop()||v;if(S(A||T)){break}}}R.startOfLine=false;return B||T},Indent:function(R,S,U){var T=R.context;if((R.tokenize!=H&&R.tokenize!=L)||T&&T.noIndent){return U?U.match(/^(\s*)/)[0].length:0}if(T&&/^<\//.test(S)){T=T.prev}while(T&&!T.startOfLine){T=T.prev}if(T){return T.indent+J}else{return 0}},compareStates:function(U,S){if(U.indented!=S.indented||U.tokenize!=S.tokenize){return false}for(var T=U.context,R=S.context;;T=T.prev,R=R.prev){if(!T||!R){return T==R}if(T.tagName!=R.tagName||T.indent!=R.indent){return false}}},magicSym:"/"}};s.js=function(){var P=4;var af={};var J=function(){function ao(at){return{type:at,style:"keyword"}}var am=ao("keyword a"),al=ao("keyword b"),ar=ao("keyword c"),ap=ao("var"),an=ao("operator"),aq={type:"atom",style:"atom"};return{"if":am,"while":am,"with":am,"else":al,"do":al,"try":al,"finally":al,"return":ar,"break":ar,"continue":ar,"new":ar,"delete":ar,"throw":ar,"var":ap,"const":ap,let:ap,"function":ao("function"),"catch":ao("catch"),"for":ao("for"),"switch":ao("switch"),"case":ao("case"),"default":ao("default"),"in":an,"typeof":an,"instanceof":an,"true":aq,"false":aq,"null":aq,"undefined":aq,"NaN":aq,"Infinity":aq}}();var ag=/[+\-*&%=<>!?|]/;function aj(an,al,am){al.tokenize=am;return am(an,al)}function A(ao,al){var an=false,am;while((am=ao.next())!=null){if(am==al&&!an){return false}an=!an&&am=="\\"}return an}var ak,I;function V(an,am,al){ak=an;I=al;return am}function E(aq,am){var al,an=aq.next();if(an=='"'||an=="'"){al=aj(aq,am,T(an))}else{if(/[\[\]{}\(\),;\:\.]/.test(an)){al=V(an)}else{if(an=="0"&&aq.eat(/x/i)){aq.eatWhile(/[\da-f]/i);al=V("number","number")}else{if(/\d/.test(an)||an=="-"&&aq.eat(/\d/)){aq.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/);al=V("number","number")}else{if(an=="/"){if(aq.eat("*")){al=aj(aq,am,y)}else{if(aq.eat("/")){aq.skipToEnd();al=V("comment","comment")}else{if(am.reAllowed){A(aq,"/");aq.eatWhile(/[gimy]/);al=V("regexp","string-2")}else{aq.eatWhile(ag);al=V("operator",null,aq.current())}}}}else{if(an=="#"){aq.skipToEnd();al=V("error","error")}else{if(ag.test(an)){aq.eatWhile(ag);al=V("operator",null,aq.current())}else{aq.eatWhile(/[\w\$_]/);var ap=aq.current(),ao=J.propertyIsEnumerable(ap)&&J[ap];al=ao&&am.kwAllowed?V(ao.type,ao.style||ao.type,ap):V("variable","variable",ap)}}}}}}}return al}function T(al){return function(an,am){if(!A(an,al)){am.tokenize=E}return V("string","string")}}function y(ao,am){var al=false,an;while(an=ao.next()){if(an=="/"&&al){am.tokenize=E;break}al=(an=="*")}return V("comment","comment")}var D={atom:true,number:true,variable:true,string:true,regexp:true};function N(aq,am,al,ap,an,ao){this.indented=aq;this.column=am;this.type=al;this.prev=an;this.info=ao;if(ap!=null){this.align=ap}}function Q(al,an){for(var am=al.localVars;am;am=am.next){if(am.name==an){return true}}}function Y(al,an,am,ap,aq){var ar=al.cc;O.status=al;O.stream=aq;O.marked=null,O.cc=ar;if(!al.lexical.hasOwnProperty("align")){al.lexical.align=true}while(true){var ao=ar.length?ar.pop():S;if(ao(am,ap)){while(ar.length&&ar[ar.length-1].lex){ar.pop()()}if(O.marked){return O.marked}if(am=="variable"&&Q(al,ap)){return"variable-2"}return an}}}var O={status:null,column:null,marked:null,cc:null};function u(){for(var al=arguments.length-1;al>=0;al--){O.cc.push(arguments[al])}}function aa(){u.apply(null,arguments);return true}function F(an){var al=O.status;if(al.context){O.marked="def";for(var am=al.localVars;am;am=am.next){if(am.name==an){return}}al.localVars={name:an,next:al.localVars}}}var X={name:"this",next:{name:"arguments"}};function M(){if(!O.status.context){O.status.localVars=X}O.status.context={prev:O.status.context,vars:O.status.localVars}}function L(){O.status.localVars=O.status.context.vars;O.status.context=O.status.context.prev}function C(am,an){var al=function(){var ao=O.status;ao.lexical=new N(ao.indented,O.stream.column(),am,null,ao.lexical,an)};al.lex=true;return al}function Z(){var al=O.status;if(al.lexical.prev){if(al.lexical.type==")"){al.indented=al.lexical.indented}al.lexical=al.lexical.prev}}Z.lex=true;function v(am){return function al(an){if(an==am){return aa()}else{if(am==";"){return u()}else{return aa(arguments.callee)}}}}function S(al){if(al=="var"){return aa(C("vardef"),ac,v(";"),Z)}if(al=="keyword a"){return aa(C("form"),R,S,Z)}if(al=="keyword b"){return aa(C("form"),S,Z)}if(al=="{"){return aa(C("}"),G,Z)}if(al==";"){return aa()}if(al=="function"){return aa(B)}if(al=="for"){return aa(C("form"),v("("),C(")"),z,v(")"),Z,S,Z)}if(al=="variable"){return aa(C("stat"),W)}if(al=="switch"){return aa(C("form"),R,C("}","switch"),v("{"),G,Z,Z)}if(al=="case"){return aa(R,v(":"))}if(al=="default"){return aa(v(":"))}if(al=="catch"){return aa(C("form"),M,v("("),K,v(")"),S,Z,L)}return u(C("stat"),R,v(";"),Z)}function R(al){if(D.hasOwnProperty(al)){return aa(ae)}if(al=="function"){return aa(B)}if(al=="keyword c"){return aa(U)}if(al=="("){return aa(C(")"),U,v(")"),Z,ae)}if(al=="operator"){return aa(R)}if(al=="["){return aa(C("]"),ah(R,"]"),Z,ae)}if(al=="{"){return aa(C("}"),ah(H,"}"),Z,ae)}return aa()}function U(al){if(al.match(/[,;\}\)\]]/)){return u()}return u(R)}function ae(al,am){if(al=="operator"&&/\+\+|--/.test(am)){return aa(ae)}if(al=="operator"&&am=="?"){return aa(R,v(":"),R)}if(al==";"){return}if(al=="("){return aa(C(")"),ah(R,")"),Z,ae)}if(al=="."){return aa(ai,ae)}if(al=="["){return aa(C("]"),R,v("]"),Z,ae)}}function W(al){if(al==":"){return aa(Z,S)}return u(ae,v(";"),Z)}function ai(al){if(al=="variable"){O.marked="property";return aa()}}function H(al){if(al=="variable"){O.marked="property"}if(D.hasOwnProperty(al)){return aa(v(":"),R)}}function ah(an,al){function am(ap){if(ap==","){return aa(an,am)}if(ap==al){return aa()}return aa(v(al))}return function ao(ap){if(ap==al){return aa()}else{return u(an,am)}}}function G(al){if(al=="}"){return aa()}return u(S,G)}function ac(al,am){if(al=="variable"){F(am);return aa(ab)}return aa()}function ab(al,am){if(am=="="){return aa(R,ab)}if(al==","){return aa(ac)}}function z(al){if(al=="var"){return aa(ac,x)}if(al==";"){return u(x)}if(al=="variable"){return aa(ad)}return u(x)}function ad(al,am){if(am=="in"){return aa(R)}return aa(ae,x)}function x(al,am){if(al==";"){return aa(w)}if(am=="in"){return aa(R)}return aa(R,v(";"),w)}function w(al){if(al!=")"){aa(R)}}function B(al,am){if(al=="variable"){F(am);return aa(B)}if(al=="("){return aa(C(")"),M,ah(K,")"),Z,S,L)}}function K(al,am){if(al=="variable"){F(am);return aa()}}return{startStatus:function(al){return{tokenize:E,reAllowed:true,kwAllowed:true,cc:[],lexical:new N((al||0)-P,0,"block",false),localVars:af.localVars,context:af.localVars&&{vars:af.localVars},indented:0}},HandleChar:function(an,al){if(an.sol()){if(!al.lexical.hasOwnProperty("align")){al.lexical.align=false}al.indented=an.indentation()}if(an.eatSpace()){return null}var am=al.tokenize(an,al);if(ak=="comment"){return am}al.reAllowed=!!(ak=="operator"||ak=="keyword c"||ak.match(/^[\[{}\(,;:]$/));al.kwAllowed=ak!=".";return Y(al,am,ak,I,an)},Indent:function(al,am){if(al.tokenize!=E){return 0}var ar=am&&am.charAt(0),ap=al.lexical;if(ap.type=="stat"&&ar=="}"){ap=ap.prev}var aq=ap.type,ao=ar==aq,an=ap.indented+(ao?0:P);if(aq=="vardef"){an=ap.indented+4}else{if(aq=="form"&&ar=="{"){an=ap.indented}else{if(aq=="stat"||aq=="form"){an=ap.indented+P}else{if(ap.info=="switch"&&!ao){an=ap.indented+(/^(?:case|default)\b/.test(am)?P:2*P)}else{if(ap.align){an=ap.column+(ao?0:1)}}}}}return an},magicSym:":{}"}};s.sql=function(){var x=4,C,u=new RegExp("^(?:str|lang|langmatches|datatype|bound|sameterm|isiri|isuri|isblank|isliteral|union|a)$","i"),w=new RegExp("^(?:ACCESSIBLE|ALTER|AS|BEFORE|BINARY|BY|CASE|CHARACTER|COLUMN|CONTINUE|CROSS|CURRENT_TIMESTAMP|DATABASE|DAY_MICROSECOND|DEC|DEFAULT|DESC|DISTINCT|DOUBLE|EACH|ENCLOSED|EXIT|FETCH|FLOAT8|FOREIGN|GRANT|HIGH_PRIORITY|HOUR_SECOND|IN|INNER|INSERT|INT2|INT8|INTO|JOIN|KILL|LEFT|LINEAR|LOCALTIME|LONG|LOOP|MATCH|MEDIUMTEXT|MINUTE_SECOND|NATURAL|NULL|OPTIMIZE|OR|OUTER|PRIMARY|RANGE|READ_WRITE|REGEXP|REPEAT|RESTRICT|RIGHT|SCHEMAS|SENSITIVE|SHOW|SPECIFIC|SQLSTATE|SQL_CALC_FOUND_ROWS|STARTING|TERMINATED|TINYINT|TRAILING|UNDO|UNLOCK|USAGE|UTC_DATE|VALUES|VARCHARACTER|WHERE|WRITE|ZEROFILL|ALL|AND|ASENSITIVE|BIGINT|BOTH|CASCADE|CHAR|COLLATE|CONSTRAINT|CREATE|CURRENT_TIME|CURSOR|DAY_HOUR|DAY_SECOND|DECLARE|DELETE|DETERMINISTIC|DIV|DUAL|ELSEIF|EXISTS|FALSE|FLOAT4|FORCE|FULLTEXT|HAVING|HOUR_MINUTE|IGNORE|INFILE|INSENSITIVE|INT1|INT4|INTERVAL|ITERATE|KEYS|LEAVE|LIMIT|LOAD|LOCK|LONGTEXT|MASTER_SSL_VERIFY_SERVER_CERT|MEDIUMINT|MINUTE_MICROSECOND|MODIFIES|NO_WRITE_TO_BINLOG|ON|OPTIONALLY|OUT|PRECISION|PURGE|READS|REFERENCES|RENAME|REQUIRE|REVOKE|SCHEMA|SELECT|SET|SPATIAL|SQLEXCEPTION|SQL_BIG_RESULT|SSL|TABLE|TINYBLOB|TO|TRUE|UNIQUE|UPDATE|USING|UTC_TIMESTAMP|VARCHAR|WHEN|WITH|YEAR_MONTH|ADD|ANALYZE|ASC|BETWEEN|BLOB|CALL|CHANGE|CHECK|CONDITION|CONVERT|CURRENT_DATE|CURRENT_USER|DATABASES|DAY_MINUTE|DECIMAL|DELAYED|DESCRIBE|DISTINCTROW|DROP|ELSE|ESCAPED|EXPLAIN|FLOAT|FOR|FROM|GROUP|HOUR_MICROSECOND|IF|INDEX|INOUT|INT|INT3|INTEGER|IS|KEY|LEADING|LIKE|LINES|LOCALTIMESTAMP|LONGBLOB|LOW_PRIORITY|MEDIUMBLOB|MIDDLEINT|MOD|NOT|NUMERIC|OPTION|ORDER|OUTFILE|PROCEDURE|READ|REAL|RELEASE|REPLACE|RETURN|RLIKE|SECOND_MICROSECOND|SEPARATOR|SMALLINT|SQL|SQLWARNING|SQL_SMALL_RESULT|STRAIGHT_JOIN|THEN|TINYTEXT|TRIGGER|UNION|UNSIGNED|USE|UTC_TIME|VARBINARY|VARYING|WHILE|XOR|FULL|COLUMNS|MIN|MAX|STDEV|COUNT)$","i"),y=/[*+\-<>=&|]/;function v(J,E){var H=J.next();C=null;if(H=="$"||H=="?"){J.match(/^[\w\d]*/);return"variable-2"}else{if(H=="<"&&!J.match(/^[\s\u00a0=]/,false)){J.match(/^[^\s\u00a0>]*>?/);return"atom"}else{if(H=='"'||H=="'"){E.tokenize=D(H);return E.tokenize(J,E)}else{if(H=="`"){E.tokenize=A(H);return E.tokenize(J,E)}else{if(/[{}\(\),\.;\[\]]/.test(H)){C=H;return null}else{if(H=="-"){var F=J.next();if(F=="-"){J.skipToEnd();return"comment"}}else{if(y.test(H)){J.eatWhile(y);return null}else{if(H==":"){J.eatWhile(/[\w\d\._\-]/);return"atom"}else{J.eatWhile(/[_\w\d]/);if(J.eat(":")){J.eatWhile(/[\w\d_\-]/);return"atom"}var I=J.current(),G;if(u.test(I)){return null}else{if(w.test(I)){return"keyword"}else{return"variable"}}}}}}}}}}}function D(E){return function(I,F){var H=false,G;while((G=I.next())!=null){if(G==E&&!H){F.tokenize=v;break}H=!H&&G=="\\"}return"string"}}function A(E){return function(I,F){var H=false,G;while((G=I.next())!=null){if(G==E&&!H){F.tokenize=v;break}H=!H&&G=="\\"}return"variable-2"}}function z(E,G,F){E.context={prev:E.context,indent:E.indent,col:F,type:G}}function B(E){E.indent=E.context.indent;E.context=E.context.prev}return{startStatus:function(E){return{tokenize:v,context:null,indent:0,col:0}},HandleChar:function(G,E){if(G.sol()){if(E.context&&E.context.align==null){E.context.align=false}E.indent=G.indentation()}if(G.eatSpace()){return null}var F=E.tokenize(G,E);if(F!="comment"&&E.context&&E.context.align==null&&E.context.type!="pattern"){E.context.align=true}if(C=="("){z(E,")",G.column())}else{if(C=="["){z(E,"]",G.column())}else{if(C=="{"){z(E,"}",G.column())}else{if(/[\]\}\)]/.test(C)){while(E.context&&E.context.type=="pattern"){B(E)}if(E.context&&C==E.context.type){B(E)}}else{if(C=="."&&E.context&&E.context.type=="pattern"){B(E)}else{if(/atom|string|variable/.test(F)&&E.context){if(/[\}\]]/.test(E.context.type)){z(E,"pattern",G.column())}else{if(E.context.type=="pattern"&&!E.context.align){E.context.align=true;E.context.col=G.column()}}}}}}}}return F},Indent:function(F,G){var J=G&&G.charAt(0),I=F.context;if(/[\]\}]/.test(J)){while(I&&I.type=="pattern"){I=I.prev}}var H=I&&J==I.type,E=I.indent+(H?0:x);if(!I){E=0}else{if(I.type=="pattern"){E=I.col}else{if(I.align){E=I.col+(H?0:1)}}}return E}}};s.phpcore=function(){var y=4,x=k(["echo","include","require","include_once","require_once","for","foreach","as","endswitch","return","break","continue","null","__LINE__","__FILE__","var","default","function","class","new","&amp;new","this","__FUNCTION__","__CLASS__","__METHOD__","PHP_VERSION","E_ERROR","E_WARNING","E_PARSE","E_NOTICE","E_CORE_ERROR","E_CORE_WARNING","E_COMPILE_ERROR","E_COMPILE_WARNING","E_USER_ERROR","E_USER_WARNING","E_USER_NOTICE","E_ALL","abstract","array"]),u=k(["catch","do","else","elseif","for","foreach","if","switch","try","while","endwhile","endif","case"]),z=k(["true","false","null","TRUE","FALSE","NULL"]),H={"$":function(J,I){J.eatWhile(/[\w\$_]/);return"variable-2"},"<":function(K,I){if(K.match(/<</)){K.eatWhile(/[\w\.]/);var J=K.current().slice(3);I.tokenize=function(M,L){if(M.match(J)){L.tokenize=null}else{M.skipToEnd()}return"string"};return I.tokenize(K,I)}return false},"#":function(J,I){while(!J.eol()&&!J.match("?>",false)){J.next()}return"comment"},"/":function(J,I){if(J.eat("/")){while(!J.eol()&&!J.match("?>",false)){J.next()}return"comment"}return false}},A=true,v=/[+\-*&%=<>!?|\/]/,E;function w(M,J){var K=M.next();if(H[K]){var I=H[K](M,J);if(I!==false){return I}}if(K=='"'||K=="'"){J.tokenize=G(K);return J.tokenize(M,J)}if(/[\[\]{}\(\),;\:\.]/.test(K)){E=K;return null}if(/\d/.test(K)){M.eatWhile(/[\w\.]/);return"number"}if(K=="/"){if(M.eat("*")){J.tokenize=C;return C(M,J)}if(M.eat("/")){M.skipToEnd();return"comment"}}if(v.test(K)){M.eatWhile(v);return"operator"}M.eatWhile(/[\w\$_]/);var L=M.current();if(x.propertyIsEnumerable(L)){if(u.propertyIsEnumerable(L)){E="newstatement"}return"keyword"}if(z.propertyIsEnumerable(L)){return"atom"}return"variable"}function G(I){return function(N,K){var M=false,L,J=false;while((L=N.next())!=null){if(L==I&&!M){J=true;break}M=!M&&L=="\\"}if(J||!(M||A)){K.tokenize=null}return"string"}}function C(L,J){var I=false,K;while(K=L.next()){if(K=="/"&&I){J.tokenize=null;break}I=(K=="*")}return"comment"}function F(M,J,I,L,K){this.indented=M;this.column=J;this.type=I;this.align=L;this.prev=K}function B(I,J,K){return I.context=new F(I.indented,J,K,null,I.context)}function D(I){var J=I.context.type;if(J==")"||J=="]"||J=="}"){I.indented=I.context.indented}return I.context=I.context.prev}return{startStatus:function(I){return{tokenize:null,context:new F((I||0)-y,0,"top",false),indented:0,startOfLine:true}},HandleChar:function(L,J){var I=J.context;if(L.sol()){if(I.align==null){I.align=false}J.indented=L.indentation();J.startOfLine=true}if(L.eatSpace()){return null}E=null;var K=(J.tokenize||w)(L,J);if(K=="comment"||K=="meta"){return K}if(I.align==null){I.align=true}if((E==";"||E==":")&&I.type=="statement"){D(J)}else{if(E=="{"){B(J,L.column(),"}")}else{if(E=="["){B(J,L.column(),"]")}else{if(E=="("){B(J,L.column(),")")}else{if(E=="}"){while(I.type=="statement"){I=D(J)}if(I.type=="}"){I=D(J)}while(I.type=="statement"){I=D(J)}}else{if(E==I.type){D(J)}else{if(I.type=="}"||I.type=="top"||(I.type=="statement"&&E=="newstatement")){B(J,L.column(),"statement")}}}}}}}J.startOfLine=false;return K},Indent:function(J,K){if(J.tokenize!=w&&J.tokenize!=null){return 0}var I=J.context,L=K&&K.charAt(0);if(I.type=="statement"&&L=="}"){I=I.prev}if(I.type=="statement"){return I.indented+(L=="{"?0:y)}else{if(I.align){return I.column+(L==I.type?0:1)}else{return I.indented+(L==I.type?0:y)}}},magicSym:"{}"}};s.css=function(){var w=4,y;var x=k(["above","absolute","activeborder","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","auto","avoid","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break-all","break-word","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","compact","condensed","contain","content","content-box","context-menu","continuous","copy","cover","crop","cross","crosshair","currentcolor","cursive","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ew-resize","expanded","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-table","inset","inside","intrinsic","invert","italic","justify","kannada","katakana","katakana-iroha","khmer","landscape","lao","large","larger","left","level","lighter","line-through","linear","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","navy","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","overlay","overline","padding","padding-box","painted","paused","persian","plus-darker","plus-lighter","pointer","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radio","read-only","read-write","read-write-plaintext-only","relative","repeat","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","round","row-resize","rtl","run-in","running","s-resize","sans-serif","scroll","scrollbar","se-resize","semi-condensed","semi-expanded","separate","serif","show","sidama","single","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","white","wider","window","windowframe","windowtext","x-large","x-small","xor","xx-large","xx-small","yellow"]);function A(C,D){y=D;return C}function B(E,C){var D=E.next();if(D=="@"){E.eatWhile(/[\w\\\-]/);return A("meta",E.current())}else{if(D=="/"&&E.eat("*")){C.tokenize=u;return u(E,C)}else{if(D=="<"&&E.eat("!")){C.tokenize=v;return v(E,C)}else{if(D=="="){return A(null,"compare")}else{if((D=="~"||D=="|")&&E.eat("=")){return A(null,"compare")}else{if(D=='"'||D=="'"){C.tokenize=z(D);return C.tokenize(E,C)}else{if(D=="#"){E.eatWhile(/[\w\\\-]/);return A("atom","hash")}else{if(D=="!"){E.match(/^\s*\w*/);return A("keyword","important")}else{if(/\d/.test(D)){E.eatWhile(/[\w.%]/);return A("number","unit")}else{if(/[,.+>*\/]/.test(D)){return A(null,"select-op")}else{if(/[;{}:\[\]\(\)]/.test(D)){return A(null,D)}else{E.eatWhile(/[\w\\\-]/);return A("variable","variable")}}}}}}}}}}}}function u(F,D){var C=false,E;while((E=F.next())!=null){if(C&&E=="/"){D.tokenize=B;break}C=(E=="*")}return A("comment","comment")}function v(F,C){var E=0,D;while((D=F.next())!=null){if(E>=2&&D==">"){C.tokenize=B;break}E=(D=="-")?E+1:0}return A("comment","comment")}function z(C){return function(G,D){var F=false,E;while((E=G.next())!=null){if(E==C&&!F){break}F=!F&&E=="\\"}if(!F){D.tokenize=B}return A("string","string")}}return{startStatus:function(C){return{tokenize:B,baseIndent:C||0,stack:[]}},HandleChar:function(F,C){if(F.eatSpace()){return null}var E=C.tokenize(F,C);var D=C.stack[C.stack.length-1];if(y=="hash"&&D!="rule"){E="string-2"}else{if(E=="variable"){if(D=="rule"){E=x[F.current()]?"keyword":"number"}else{if(!D||D=="@media{"){E="tag"}}}}if(D=="rule"&&/^[\{\};]$/.test(y)){C.stack.pop()}if(y=="{"){if(D=="@media"){C.stack[C.stack.length-1]="@media{"}else{C.stack.push("{")}}else{if(y=="}"){C.stack.pop()}else{if(y=="@media"){C.stack.push("@media")}else{if(D=="{"&&y!="comment"){C.stack.push("rule")}}}}return E},Indent:function(C,D){var E=C.stack.length;if(/^\}/.test(D)){E-=C.stack[C.stack.length-1]=="rule"?2:1}return C.baseIndent+E*w},magicSym:"}"}};s.php=function(z){var x={},y=s.html(),w=s.js(),u=s.css(),A=s.phpcore();function v(G,B){var D,E=B.syntax=="php";if(!E&&z){B.curSyntax=A;B.curState=B.php;B.syntax="php"}if(G.sol()&&B.pending!='"'){B.pending=null}if(B.curSyntax==y){if(G.match(/^<\?\w*/)){B.curSyntax=A;B.curState=B.php;B.curClose="?>";B.syntax="php";return"meta"}if(B.pending=='"'){while(!G.eol()&&G.next()!='"'){}D="string"}else{if(B.pending&&G.pos<B.pending.end){G.pos=B.pending.end;D=B.pending.style}else{D=y.HandleChar(G,B.curState)}}B.pending=null;var F=G.current(),C=F.search(/<\?/);if(C!=-1){if(D=="string"&&/\"$/.test(F)&&!/\?>/.test(F)){B.pending='"'}else{B.pending={end:G.pos,style:D}}G.backUp(F.length-C)}else{if(D=="tag"&&G.current()==">"&&B.curState.context){if(/^script$/i.test(B.curState.context.tagName)){B.curSyntax=w;B.curState=w.startStatus(y.Indent(B.curState,""));B.curClose=/^<\/\s*script\s*>/i;B.syntax="js"}else{if(/^style$/i.test(B.curState.context.tagName)){B.curSyntax=u;B.curState=u.startStatus(y.Indent(B.curState,""));B.curClose=/^<\/\s*style\s*>/i;B.syntax="css"}}}}return D}else{if((!E||B.php.tokenize==null)&&G.match(B.curClose,E)){B.curSyntax=y;B.curState=B.html;B.curClose=null;B.syntax="html";return E?"meta":v(G,B)}else{return B.curSyntax.HandleChar(G,B.curState)}}}return{startStatus:function(){var B=y.startStatus();return{html:B,php:A.startStatus(),curSyntax:x.startOpen?A:y,curState:x.startOpen?A.startStatus():B,curClose:x.startOpen?/^\?>/:null,syntax:x.startOpen?"php":"html",pending:null}},copyStatus:function(B){var D=B.html,E=d(y,D),G=B.php,C=d(A,G),F;if(B.curState==D){F=E}else{if(B.curState==G){F=C}else{F=d(B.curSyntax,B.curState)}}return{html:E,php:C,curSyntax:B.curSyntax,curState:F,curClose:B.curClose,syntax:B.syntax,pending:B.pending}},HandleChar:v,Indent:function(B,C){if((B.curSyntax!=A&&/^\s*<\//.test(C))||(B.curSyntax==A&&/^\?>/.test(C))){return y.Indent(B.html,C)}return B.curSyntax.Indent(B.curState,C)},magicSym:"/{}:"}};function p(x,w,v,u){this.from=x;this.to=w;this.style=v;this.marker=u}p.prototype={attach:function(u){this.marker.set.push(u)},detach:function(v){var u=o(this.marker.set,v);if(u>-1){this.marker.set.splice(u,1)}},split:function(x,u){if(this.to<=x&&this.to!=null){return null}var w=this.from<x||this.from==null?null:this.from-x+u,v=this.to==null?null:this.to-x+u;return new p(w,v,this.style,this.marker)},dup:function(){return new p(null,null,this.style,this.marker)},clipTo:function(v,y,u,x,w){if(v&&x>this.from&&(x<this.to||this.to==null)){this.from=null}else{if(this.from!=null&&this.from>=y){this.from=Math.max(x,this.from)+w}}if(u&&(y<this.to||this.to==null)&&(y>this.from||this.from==null)){this.to=null}else{if(this.to!=null&&this.to>y){this.to=x<this.to?this.to+w:y}}},isDead:function(){return this.from!=null&&this.to!=null&&this.from>=this.to},sameSet:function(u){return this.marker==u.marker}}})();