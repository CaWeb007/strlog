this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(a){var c=function(){function f(){babelHelpers.classCallCheck(this,f);this.enabled=null;this.expireList=null;this.expireInterval=null}babelHelpers.createClass(f,[{key:"isEnabled",value:function g(){if(this.enabled!==null){return this.enabled}this.enabled=false;if(typeof window.localStorage!=="undefined"){try{window.localStorage.setItem("__bx_test_ls_feature__","ok");if(window.localStorage.getItem("__bx_test_ls_feature__")==="ok"){window.localStorage.removeItem("__bx_test_ls_feature__");this.enabled=true}}catch(l){}}if(this.enabled&&!this.expireInterval){try{var k=window.localStorage.getItem("bx-messenger-localstorage-expire");if(k){this.expireList=JSON.parse(k)}}catch(l){}clearInterval(this.expireInterval);this.expireInterval=setInterval(this._checkExpireInterval.bind(this),60000)}return this.enabled}},{key:"set",value:function j(q,o,n,p){var l=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;if(!this.isEnabled()){return false}var m=null;if(l){m=new Date(new Date().getTime()+l*1000)}var k=JSON.stringify({value:p,expire:m});if(window.localStorage.getItem(this._getKey(q,o,n))!==k){window.localStorage.setItem(this._getKey(q,o,n),k)}if(l){if(!this.expireList){this.expireList={}}this.expireList[this._getKey(q,o,n)]=m;window.localStorage.setItem("bx-messenger-localstorage-expire",JSON.stringify(this.expireList))}return true}},{key:"get",value:function e(p,n,m,l){if(!this.isEnabled()){return typeof l!=="undefined"?l:null}var k=window.localStorage.getItem(this._getKey(p,n,m));if(k===null){return typeof l!=="undefined"?l:null}try{k=JSON.parse(k);if(k&&typeof k.value!=="undefined"){if(!k.expire||new Date(k.expire)>new Date()){k=k.value}else{window.localStorage.removeItem(this._getKey(p,n,m));if(this.expireList){delete this.expireList[this._getKey(p,n,m)]}return typeof l!=="undefined"?l:null}}else{return typeof l!=="undefined"?l:null}}catch(o){return typeof l!=="undefined"?l:null}return k}},{key:"remove",value:function d(m,l,k){if(!this.isEnabled()){return false}if(this.expireList){delete this.expireList[this._getKey(m,l,k)]}return window.localStorage.removeItem(this._getKey(m,l,k))}},{key:"_getKey",value:function i(m,l,k){return"bx-messenger-"+m+"-"+l+"-"+k}},{key:"_checkExpireInterval",value:function h(){if(!this.expireList){return true}var m=new Date();var l=0;for(var k in this.expireList){if(!this.expireList.hasOwnProperty(k)){continue}if(new Date(this.expireList[k])<=m){window.localStorage.removeItem(k);delete this.expireList[k]}else{l++}}if(l){window.localStorage.setItem("bx-messenger-localstorage-expire",JSON.stringify(this.expireList))}else{this.expireList=null;window.localStorage.removeItem("bx-messenger-localstorage-expire")}return true}}]);return f}();var b=new c();a.LocalStorage=b}((this.BX.Messenger.Lib=this.BX.Messenger.Lib||{})));