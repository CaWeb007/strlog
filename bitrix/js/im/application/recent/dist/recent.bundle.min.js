this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};(function(s,g,h,t,c,e,m,l){h.Vue.component("bx-im-component-recent",{props:{hasDialog:false},data:function r(){return{}},created:function j(){},computed:babelHelpers.objectSpread({},t.Vuex.mapState({recent:function q(u){return u.recent.collection.general},pinned:function a(u){return u.recent.collection.pinned}}),{recentData:function p(){return[].concat(babelHelpers.toConsumableArray(this.recent),babelHelpers.toConsumableArray(this.pinned))}}),methods:{getController:function o(){return this.$root.$bitrixController},getStore:function n(){return this.$root.$bitrixController.store},onScroll:function k(u){if(this.oneScreenRemaining(u)){this.getController().recent.loadMore()}},onClick:function f(u){if(this.hasDialog){h.Vue.event.$emit("openMessenger",u)}else{this.getController().recent.openOldDialog(u)}},onRightClick:function d(u){this.getController().recent.openOldContextMenu(u)},oneScreenRemaining:function i(u){return u.target.scrollTop+u.target.clientHeight>=u.target.scrollHeight-u.target.clientHeight}},template:'\n\t\t<div class="recent-wrap">\n\t\t\t<bx-im-view-list-recent\n\t\t\t\t:recentData="recentData"\n\t\t\t\t@scroll="onScroll"\n\t\t\t\t@click="onClick"\n\t\t\t\t@rightClick="onRightClick"\n\t\t\t/>\n\t\t</div>\n\t'});var b=function(){function y(){var E=this;var D=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,y);this.inited=false;this.initPromise=new BX.Promise();this.params=D;this.template=null;this.rootNode=this.params.node||document.createElement("div");this.isMessenger=D.hasDialog===true;this.templateTemp=null;this.rootNodeTemp=this.params.nodeTemp||document.createElement("div");this.eventBus=new h.VueVendorV2();this.initCore().then(function(F){return E.initParams(F)}).then(function(){return E.initComponent()}).then(function(){return E.initComplete()})}babelHelpers.createClass(y,[{key:"initCore",value:function z(){var D=this;return new Promise(function(F,E){g.Core.ready().then(function(G){D.controller=G;F()})})}},{key:"initParams",value:function x(D){return new Promise(function(F,E){return F()})}},{key:"initComponent",value:function C(){var D=this;return this.controller.createVue(this,{el:this.rootNode,template:'<bx-im-component-recent :hasDialog="'.concat(this.isMessenger,'"/>')}).then(function(E){D.template=E;return new Promise(function(G,F){return G()})})}},{key:"initComplete",value:function w(){this.inited=true;this.initPromise.resolve(this);return this.requestData()}},{key:"requestData",value:function v(){this.controller.recent.drawPlaceholders();this.controller.recent.getRecentData();return new Promise(function(E,D){return E()})}},{key:"ready",value:function A(){if(this.inited){var D=new BX.Promise();D.resolve(this);return D}return this.initPromise}},{key:"emit",value:function B(D){var E=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.eventBus.$emit(D,E);return true}},{key:"listen",value:function u(D,E){if(typeof E!=="function"){return false}this.eventBus.$on(D,E);return true}}]);return y}();s.RecentApplication=b}((this.BX.Messenger.Application=this.BX.Messenger.Application||{}),BX.Messenger.Application,BX,BX,window,BX.Messenger.Lib,BX.Messenger.Const,BX.Messenger.Lib));