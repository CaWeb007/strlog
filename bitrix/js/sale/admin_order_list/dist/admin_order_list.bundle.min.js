this.BX=this.BX||{};(function(a){var b=function b(){babelHelpers.classCallCheck(this,b)};var d=function(g){babelHelpers.inherits(p,g);function p(){var v;var u;babelHelpers.classCallCheck(this,p);for(var r=arguments.length,s=new Array(r),t=0;t<r;t++){s[t]=arguments[t]}u=babelHelpers.possibleConstructorReturn(this,(v=babelHelpers.getPrototypeOf(p)).call.apply(v,[this].concat(s)));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"dialog",null);return u}babelHelpers.createClass(p,[{key:"initialize",value:function i(r){this._settings=r?r:{};this._restEntityInfo=BX.prop.getObject(this._settings,"restEntityInfo",{});this._form=BX.prop.getElementNode(this._settings,"form");this.entityId=BX.prop.getInteger(this._restEntityInfo,"entityId",0);this.entityTypeId=BX.prop.getInteger(this._restEntityInfo,"entityTypeId",0)}},{key:"confirmToOpenNewOrder",value:function l(v,u,r){this.dialog=new BX.PopupWindow("adm-sale-order-alert-dialog",null,{autoHide:false,draggable:true,offsetLeft:0,offsetTop:0,bindOptions:{forceBindPosition:false},closeByEsc:true,closeIcon:true,titleBar:v,contentColor:"white",content:BX.create("span",{html:BX.util.htmlspecialchars(u).replace(/\n/g,"<br>\n"),style:{backgroundColor:"white"}})});var t=[new BX.PopupWindowButton({text:BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_REGISTRY_CREATE"),className:"popup-window-button-accept",events:{click:function s(){window.open(r);BX.delegate(this.onPopupClose,this);BX.Sale.AdminIntegrationOrderList.closeApplication()}}}),new BX.PopupWindowButton({text:BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_REGISTRY_CLOSE"),className:"popup-window-button-link-cancel",events:{click:function s(){BX.delegate(this.onPopupClose,this);BX.Sale.AdminIntegrationOrderList.closeApplication()}}})];this.dialog.setButtons(t);this.dialog.show()}},{key:"popup",value:function f(t,s){this.dialog=new BX.PopupWindow("adm-sale-order-alert-dialog",null,{autoHide:false,draggable:true,offsetLeft:0,offsetTop:0,bindOptions:{forceBindPosition:false},closeByEsc:true,closeIcon:true,titleBar:t,contentColor:"white",content:BX.create("span",{html:BX.util.htmlspecialchars(s).replace(/\n/g,"<br>\n"),style:{backgroundColor:"white"}})});var r=[new BX.PopupWindowButton({text:BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_REGISTRY_CLOSE"),className:"popup-window-button-link-cancel",events:{click:BX.delegate(this.onPopupClose,this)}})];this.dialog.setButtons(r);this.dialog.show()}},{key:"onPopupClose",value:function n(){this.dialog.close();this.dialog.destroy()}},{key:"getSendedOrders",value:function h(){var u=[];var s=[];s=this.getCheckedCheckBoxList(this._form);for(var r=0;r<s.length;r++){var v=BX.findParent(s[r],{tag:"TR"});if(!!v){var t=v.getElementsByTagName("span");if(!!t){for(var w=0;w<t.length;w++){if(t[w].id=="IS_SYNC_B24_"+s[r].value){if(t[w].innerText==BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_REGISTRY_SEND_YES")){u.push(s[r].value)}}}}}}return u}},{key:"getCheckedCheckBoxList",value:function m(t){var r=t.elements.length;var u=[];for(var s=0;s<r;s++){if(t.elements[s].tagName.toUpperCase()=="INPUT"&&t.elements[s].type.toUpperCase()=="CHECKBOX"&&t.elements[s].name.toUpperCase()=="ID[]"&&t.elements[s].checked==true){u.push(t.elements[s])}}return u}},{key:"sendOrdersToRestApplication",value:function j(){var r=this._form;var s=this.getCheckedCheckBoxList(this._form);if(BX("tbl_sale_order_check_all")&&r){if(s.length==0){this.popup(BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_TITLE"),BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_SELECTION_NEEDED"))}else{var t=this.getSendedOrders();if(tbl_sale_order.num_checked>3){this.popup(BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_TITLE"),BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_SELECTION_MORE_THREE"))}else{if(t.length>0){this.popup(BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_TITLE"),BX.message("SALE_O_CONTEXT_B_IS_SYNC_B24_REGISTRY_SENDED")+": "+t.toString())}else{this.redirect()}}}}}},{key:"getValuesCheckedCheckBox",value:function o(t){var r=this.getCheckedCheckBoxList(t);var u=[];for(var s=0;s<r.length;s++){u.push(r[s].value)}return u}},{key:"redirect",value:function k(){var r="sale_app_rest_sender.php";r=BX.Uri.addParam(r,{orderIds:this.getValuesCheckedCheckBox(this._form),entityId:this.entityId,entityTypeId:this.entityTypeId,IFRAME:"Y"});document.location.href=r}},{key:"closeApplication",value:function q(){BX24.closeApplication()}}]);return p}(b);var c=new b();var e=new d();a.AdminOrderList=c;a.AdminIntegrationOrderList=e}((this.BX.Sale=this.BX.Sale||{})));