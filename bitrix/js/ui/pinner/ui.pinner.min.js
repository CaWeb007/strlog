(function(){BX.namespace("BX.UI");BX.UI.Pinner=function(b,a){this.node=b;this.options=a||{};if(typeof(this.options.pinTop)==="undefined"&&typeof(this.options.pinBottom)==="undefined"){this.options.pinTop=true;this.options.pinBottom=true}else{this.options.pinTop=!!this.options.pinTop;this.options.pinBottom=!!this.options.pinBottom}this.options.fixTop=!!this.options.fixTop;this.options.fixBottom=!!this.options.fixBottom;this.options.initialWidth=b.style.width;this.init()};BX.UI.Pinner.prototype={node:null,options:{},timeout:0,classUi:"ui-pinner",classTop:"ui-pinner-top",classBottom:"ui-pinner-bottom",classFullWidth:"ui-pinner-full-width",init:function(){var d=this.node;var c=this.options;if(!c.anchorTop){var b=document.createElement("div");d.parentNode.insertBefore(b,d);c.anchorTop=b}if(!c.anchorBottom){var a=document.createElement("div");d.parentNode.insertBefore(a,d.nextSibling);c.anchorBottom=a}BX.bind(window,"scroll",BX.throttle(this.onChange.bind(this),200));BX.bind(window,"resize",BX.throttle(this.onChange.bind(this),this.timeout));this.onChange()},onChange:function(){var c=this.node;var a=this.options;var b;if(this.options.fixBottom||(this.options.pinTop&&this.isNodeOnScreenBottom(a.anchorBottom))){this.applyNodeWidth();BX.removeClass(c,this.classTop);BX.addClass(c,this.classUi);BX.addClass(c,this.classBottom);b=BX.pos(c);a.anchorBottom.style.height=0;a.anchorBottom.style.height=b.height+"px"}else{if(this.options.fixTop||(this.options.pinTop&&this.isNodeOnScreenTop(a.anchorTop))){this.applyNodeWidth();BX.removeClass(c,this.classBottom);BX.addClass(c,this.classUi);BX.addClass(c,this.classTop);b=BX.pos(c);a.anchorTop.style.height=0;a.anchorTop.style.height=b.height+"px"}else{BX.removeClass(c,this.classTop);BX.removeClass(c,this.classBottom);BX.removeClass(c,this.classUi);c.style.width=a.initialWidth?a.initialWidth:null;a.anchorTop.style.height=0;a.anchorBottom.style.height=0}}},applyNodeWidth:function(){if(this.options.fullWidth){BX.addClass(this.node,this.classFullWidth);return}var a=this.options.anchorTop||this.options.anchorBottom;var b=a.getBoundingClientRect();this.node.style.width=b.width+"px"},isNodeOnScreenTop:function(a){var b=this.getCoordinates(a);return b.top<b.windowTop&&b.bottom<b.windowBottom},isNodeOnScreenBottom:function(a){var b=this.getCoordinates(a);return(b.bottom>b.windowBottom&&b.top>b.windowTop)||document.documentElement.scrollHeight-a.scrollHeight<40},getCoordinates:function(b){var a=b.getBoundingClientRect();var d=a.top+window.pageYOffset;var c=window.pageYOffset||document.documentElement.scrollTop;return{windowTop:c,windowBottom:c+document.documentElement.clientHeight,top:d,bottom:d+b.offsetHeight,left:a.left+window.pageXOffset,width:a.width}}}})();