BX.namespace("BX.UI");if(typeof BX.UI.EntityValidator==="undefined"){BX.UI.EntityValidator=function(){this._settings={};this._editor=null;this._data=null};BX.UI.EntityValidator.prototype={initialize:function(a){this._settings=a?a:{};this._editor=BX.prop.get(this._settings,"editor",null);this._data=BX.prop.getObject(this._settings,"data",{});this.doInitialize()},doInitialize:function(){},release:function(){},getData:function(){return this._data},getDataStringParam:function(b,a){return BX.prop.getString(this._data,b,a)},getErrorMessage:function(){return BX.prop.getString(this._settings,"message","")},validate:function(a){return true},processControlChange:function(a){}}}if(typeof BX.UI.EntityPersonValidator==="undefined"){BX.UI.EntityPersonValidator=function(){BX.UI.EntityPersonValidator.superclass.constructor.apply(this)};BX.extend(BX.UI.EntityPersonValidator,BX.UI.EntityValidator);BX.UI.EntityPersonValidator.prototype.doInitialize=function(){this._nameField=this._editor.getControlById(this.getDataStringParam("nameField",""));if(this._nameField){this._nameField.addValidator(this)}this._lastNameField=this._editor.getControlById(this.getDataStringParam("lastNameField",""));if(this._lastNameField){this._lastNameField.addValidator(this)}};BX.UI.EntityPersonValidator.prototype.release=function(){if(this._nameField){this._nameField.removeValidator(this)}if(this._lastNameField){this._lastNameField.removeValidator(this)}};BX.UI.EntityPersonValidator.prototype.validate=function(b){var e=this._nameField.isActive();var a=this._lastNameField.isActive();if(!e&&!a){return true}var d=e?this._nameField.getRuntimeValue():this._nameField.getValue();var c=a?this._lastNameField.getRuntimeValue():this._lastNameField.getValue();if(d!==""||c!==""){return true}if(d===""&&e){b.addError(BX.UI.EntityValidationError.create({field:this._nameField}));this._nameField.showError(this.getErrorMessage())}if(c===""&&a){b.addError(BX.UI.EntityValidationError.create({field:this._lastNameField}));this._lastNameField.showError(this.getErrorMessage())}return false};BX.UI.EntityPersonValidator.prototype.processFieldChange=function(a){if(a!==this._nameField&&a!==this._lastNameField){return}if(this._nameField){this._nameField.clearError()}if(this._lastNameField){this._lastNameField.clearError()}};BX.UI.EntityPersonValidator.create=function(b){var a=new BX.UI.EntityPersonValidator();a.initialize(b);return a}}if(typeof BX.UI.EntityValidationError==="undefined"){BX.UI.EntityValidationError=function(){this._settings={};this._field=null;this._message=""};BX.UI.EntityValidationError.prototype={initialize:function(a){this._settings=a?a:{};this._field=BX.prop.get(this._settings,"field",null);this._message=BX.prop.getString(this._settings,"message","")},getField:function(){return this._field},getMessage:function(){return this._message}};BX.UI.EntityValidationError.create=function(b){var a=new BX.UI.EntityValidationError();a.initialize(b);return a}}if(typeof BX.UI.EntityValidationResult==="undefined"){BX.UI.EntityValidationResult=function(){this._settings={};this._errors=[]};BX.UI.EntityValidationResult.prototype={initialize:function(a){this._settings=a?a:{}},getStatus:function(){return this._errors.length===0},addError:function(a){this._errors.push(a)},getErrors:function(){return this._errors},addResult:function(a){var d=a.getErrors();for(var b=0,c=d.length;b<c;b++){this._errors.push(d[b])}},getTopmostField:function(){var f=null;var e=null;for(var b=0,d=this._errors.length;b<d;b++){var c=this._errors[b].getField();if(!f){f=c;e=c.getPosition()["top"];continue}var g=c.getPosition();if(!g){continue}var a=c.getPosition()["top"];if(a<e){f=c;e=a}}return f}};BX.UI.EntityValidationResult.create=function(b){var a=new BX.UI.EntityValidationResult();a.initialize(b);return a}}if(typeof BX.UI.EntityAsyncValidator==="undefined"){BX.UI.EntityAsyncValidator=function(){this.promisesList=[];this.isValid=true};BX.UI.EntityAsyncValidator.prototype={addResult:function(a){if(a instanceof Promise||a instanceof BX.Promise){this.promisesList.push(a)}else{this.isValid=(this.isValid&&a)}},validate:function(){if(this.promisesList.length){return Promise.all(this.promisesList)}return this.isValid}};BX.UI.EntityAsyncValidator.create=function(){return new BX.UI.EntityAsyncValidator()}}if(typeof BX.UI.EntityTrackingSourceValidator==="undefined"){BX.UI.EntityTrackingSourceValidator=function(){BX.UI.EntityTrackingSourceValidator.superclass.constructor.apply(this)};BX.extend(BX.UI.EntityTrackingSourceValidator,BX.UI.EntityValidator);BX.UI.EntityTrackingSourceValidator.prototype.doInitialize=function(){this._trackingSourceField=this._editor.getControlById(this.getDataStringParam("fieldName",""));if(this._trackingSourceField){this._trackingSourceField.addValidator(this)}};BX.UI.EntityTrackingSourceValidator.prototype.release=function(){if(this._trackingSourceField){this._trackingSourceField.removeValidator(this)}};BX.UI.EntityTrackingSourceValidator.prototype.validate=function(b){var c=this._trackingSourceField.isActive();var d="";var a;if(!c||!(this._trackingSourceField.isRequired()||this._trackingSourceField.isRequiredByAttribute())){return true}if(c){if(this._trackingSourceField.hasOwnProperty("_innerWrapper")&&BX.Type.isDomNode(this._trackingSourceField._innerWrapper)){a=this._trackingSourceField._innerWrapper.querySelector("select[name="+this._trackingSourceField.getId().replace(/["\\]/g,"\\$&")+"]");if(a){d=a.value}}}else{d=this._trackingSourceField.getValue()}if(d!==""){return true}if(d===""&&c){b.addError(BX.UI.EntityValidationError.create({field:this._trackingSourceField}));this._trackingSourceField.showError(this._trackingSourceField.getMessage("requiredFieldError"))}return false};BX.UI.EntityTrackingSourceValidator.prototype.processFieldChange=function(a){if(a!==this._trackingSourceField){return}if(this._trackingSourceField){this._trackingSourceField.clearError()}};BX.UI.EntityTrackingSourceValidator.create=function(b){var a=new BX.UI.EntityTrackingSourceValidator();a.initialize(b);return a}};