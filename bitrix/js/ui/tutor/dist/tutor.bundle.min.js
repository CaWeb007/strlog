this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(J,n,K,H){var l=function(ai){babelHelpers.inherits(ac,ai);function ac(al){var am;babelHelpers.classCallCheck(this,ac);am=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(ac).call(this));am.setEventNamespace("BX.UI.Tutor.Step");al=n.Type.isPlainObject(al)?al:{};am.id=al.id||null;am.title=al.title||null;am.description=al.description||null;am.url=al.url||"";am.isCompleted=al.isCompleted||false;am.video=al.video||null;am.helpLink=al.helpLink||null;am.highlight=al.highlight||null;am.isActive=al.isActive===true;am.isShownForSlider=al.isShownForSlider||false;am.initOptions=al;am.videoObj=null;return am}babelHelpers.createClass(ac,[{key:"getTitle",value:function aa(){return this.title}},{key:"getVideoObj",value:function ae(){return this.videoObj}},{key:"getHighlightOptions",value:function Z(){return this.highlight}},{key:"getDescription",value:function ah(){return this.description}},{key:"getUrl",value:function ag(){return this.url}},{key:"getCompleted",value:function ak(){return this.isCompleted}},{key:"getVideo",value:function af(){return this.video}},{key:"getHelpLink",value:function W(){return this.helpLink}},{key:"getId",value:function X(){return this.id}},{key:"getInitOptions",value:function aj(){return this.initOptions}},{key:"activate",value:function ab(){this.isActive=true}},{key:"getShownForSlider",value:function ad(){return this.isShownForSlider}},{key:"deactivate",value:function Y(){this.isActive=false}}],[{key:"getFullEventName",value:function V(al){return al}}]);return ac}(n.Event.EventEmitter);function b(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-step-title"></div>\n\t\t\t\t']);W=function W(){return V};return V}function d(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-success ui-btn-round ui-btn-xs">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);W=function W(){return V};return V}function o(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round ui-btn-xs">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);V=function V(){return W};return W}function r(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round ui-btn-xs">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);V=function V(){return W};return W}function t(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup ui-tutor-popup-collapse" onclick="','">\n\t\t\t\t\t\t<div class="ui-tutor-popup-content">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-step-subject">',"</div>\n\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-collapse-btn">\n\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t"]);W=function W(){return V};return V}function v(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-informer" id="ui-tutor-informer"></div>\n\t\t\t\t']);W=function W(){return V};return V}function x(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-link">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);W=function W(){return V};return V}function z(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);V=function V(){return W};return W}function B(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup ui-tutor-popup-start">\n\t\t\t\t\t\t<div class="ui-tutor-popup-header">\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-icon"></span>\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title-wrap">\n\t\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title">','</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-content">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-title">','</div>\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-text">','</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-footer">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-btn">\n\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-icon-angle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t']);V=function V(){return W};return W}function E(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup" onclick="','">\n\t\t\t\t\t\t<div class="ui-tutor-popup-header">\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-icon"></span>\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title-wrap">\n\t\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title">','</span> \n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-content">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-text">','</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-icon-angle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t']);V=function V(){return W};return W}function k(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-btn"></div>\n\t\t\t\t']);V=function V(){return W};return W}var L=function(aC){babelHelpers.inherits(aS,aC);function aS(){var aZ;babelHelpers.classCallCheck(this,aS);aZ=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(aS).call(this));aZ.setEventNamespace("BX.UI.Tutor.Manager");return aZ}babelHelpers.createClass(aS,[{key:"setOptions",value:function ar(aZ,a1,a0){aZ=aZ||{};this.tutorialData=aZ.tutorialData||{};this.eventService=aZ.eventService||{};this.lastCheckTime=aZ.lastCheckTime||0;this.domain=aZ.domain||"";this.feedbackFormId=aZ.feedbackFormId||"";if(n.Type.isString(a1)&&a1.length>0){this.domain=a1}if(n.Type.isString(a0)&&a0.length>0){this.feedbackFormId=a0}}},{key:"showFeedbackForm",value:function ad(){if(this.feedbackFormId){this.feedBackForm=BX.UI.Feedback.Form.getById(this.feedbackFormId);if(this.feedBackForm){this.feedBackForm.openPanel()}}}},{key:"getDomain",value:function aQ(){return this.domain}},{key:"getCurrentTutorialData",value:function ak(){return this.tutorialData}},{key:"getCurrentEventService",value:function aH(){return this.eventService}},{key:"getCurrentLastCheckTime",value:function an(){return this.lastCheckTime}}],[{key:"getInstance",value:function aK(){return this.instance}},{key:"getScenarioInstance",value:function aG(){return this.scenarioInstance}},{key:"init",value:function aP(a0,a2,a1){var aZ=this.getInstance();if(!(aZ instanceof aS)){this.instance=new aS();aZ=this.getInstance();this.emit("onInitManager")}else{aZ=this.getInstance()}aZ.setOptions(a0,a2,a1);return aZ}},{key:"initScenario",value:function aM(a0){var aZ=this.getScenarioInstance();if(!(aZ instanceof O)){this.scenarioInstance=new O();aZ=this.getScenarioInstance();this.emit("onInitScenario")}else{aZ=this.getScenarioInstance()}aZ.setOptions(a0);return aZ}},{key:"showButton",value:function V(aZ){return this.getImButton(aZ)}},{key:"getRootImButton",value:function aU(){return document.getElementById("ui-tutor-btn-wrap")}},{key:"hasImButton",value:function au(){return !!this.getRootImButton()}},{key:"getImButton",value:function aj(a2){var a0=this;if(!this.layout.imButton){var aZ=this.getRootImButton();if(aZ){var a1=n.Tag.render(k());if(a2){n.Dom.addClass(aZ,"ui-tutor-btn-wrap-animate")}n.Dom.append(a1,aZ);n.Dom.addClass(aZ,"ui-tutor-btn-wrap-show");this.layout.imButton=aZ;n.Event.bind(this.layout.imButton,"click",function(){a0.emit("clickImButton")});var a3=document.querySelector(".bx-im-users-wrap");if(document.querySelector("#bx-im-btn-call")){a3.style.bottom="175px"}else{a3.style.bottom="120px"}}}return this.layout.imButton}},{key:"showSmallPopup",value:function ae(aZ){this.smallPopupText=aZ;this.getSmallPopup().style.display="block";this.smallPopupText="";if(n.Dom.hasClass(this.getSmallPopup(),"ui-tutor-popup-welcome-hide")){n.Dom.removeClass(this.getSmallPopup(),"ui-tutor-popup-welcome-hide")}}},{key:"hideSmallPopup",value:function X(a0){a0=a0===true;var aZ=function(){n.Dom.remove(this.getSmallPopup());if(this.hasOwnProperty("smallPopup")){delete this.smallPopup}this.emit("onCompleteHideSmallPopup")}.bind(this);n.Dom.removeClass(this.getSmallPopup(),"ui-tutor-popup-welcome-show");n.Dom.addClass(this.getSmallPopup(),"ui-tutor-popup-welcome-hide");if(a0){aZ()}else{setTimeout(aZ,300)}}},{key:"showWelcomePopup",value:function az(aZ){this.emit("onShowWelcomePopup");this.showSmallPopup(aZ)}},{key:"hideWelcomePopup",value:function aT(){this.emit("onBeforeHideWelcomePopup");this.hideSmallPopup();this.emit("onAfterHideWelcomePopup")}},{key:"showNoticePopup",value:function aD(aZ){this.emit("onShowNoticePopup");this.showSmallPopup(aZ)}},{key:"hideNoticePopup",value:function ag(){this.emit("onBeforeHideNoticePopup");this.hideSmallPopup();this.emit("onAfterHideNoticePopup")}},{key:"getSmallPopup",value:function aR(){var a0=this;var aZ=function aZ(){a0.emit("onClickSmallPopupBtn")};if(!this.smallPopup){this.smallPopup=n.Tag.render(E(),aZ.bind(this),n.Loc.getMessage("JS_UI_TUTOR_TITLE"),this.smallPopupText);this.emit("onCreateSmallPopupNode");n.Dom.addClass(this.smallPopup,"ui-tutor-popup-welcome-show");this.emit("onBeforeAppendSmallPopupNode");n.Dom.append(this.smallPopup,document.body);this.emit("onAfterAppendSmallPopupNode")}return this.smallPopup}},{key:"showStartPopup",value:function ao(a0,aZ){this.emit("onShowStartPopup");this.startTitle=a0;this.startText=aZ;n.Dom.addClass(this.getStartPopup(),"ui-tutor-popup-show");this.startPopup.style.display="flex";this.startTitle="";this.startText=""}},{key:"closeStartPopup",value:function aV(){n.Dom.remove(this.getStartPopup());delete this.startPopup}},{key:"getStartPopup",value:function W(){if(!this.startPopup){this.startPopup=n.Tag.render(B(),n.Loc.getMessage("JS_UI_TUTOR_TITLE"),this.startTitle,this.startText,this.getBeginBtn(),this.getDeferBtn());this.emit("onCreateStartPopupNode");n.Dom.append(this.startPopup,document.body);this.emit("onAfterAppendStartPopupNode")}return this.startPopup}},{key:"getBeginBtn",value:function aL(){var aZ=this;if(!this.beginBtn){this.beginBtn=n.Tag.render(z(),n.Loc.getMessage("JS_UI_TUTOR_BTN_BEGIN"));n.Event.bind(this.beginBtn,"click",function(){aZ.emit("clickBeginBtn")})}return this.beginBtn}},{key:"getDeferBtn",value:function aa(){var aZ=this;if(!this.deferBtn){this.deferBtn=n.Tag.render(x(),n.Loc.getMessage("JS_UI_TUTOR_CLOSE_POPUP_BTN"));n.Event.bind(this.deferBtn,"click",function(){aZ.emit("clickDeferBtn")})}return this.deferBtn}},{key:"getFullEventName",value:function ab(aZ){return aZ}},{key:"getInformer",value:function aI(){if(!this.informer){this.informer=n.Tag.render(v());var aZ=this.getImButton();if(this.isCollapsedShow){aZ=this.getCollapseBlock()}if(aZ){n.Dom.append(this.informer,aZ)}}return this.informer}},{key:"setCount",value:function aJ(aZ){this.emit("onBeforeSetCount");if(aZ<1){this.removeInformer();delete this.informer;this.isInformerShow=false}else{this.getInformer().textContent=aZ;this.isInformerShow=true}this.emit("onAfterSetCount")}},{key:"removeInformer",value:function aX(){if(this.isInformerShow){n.Dom.remove(this.getInformer())}}},{key:"showCollapsedBlock",value:function aA(a2,aZ,a3){aZ=aZ!==false;a3=a3!==false;this.emit("onBeforeShowCollapsedBlock");if(!this.isCollapsedShow){this.emit("onStartShowCollapsedBlock");if(!(a2 instanceof l)){a2=new l(a2)}this.collapsedStep=a2;var a0=this.getCollapseBlock();var a1=function a1(){a0.style.display="flex"};if(a3){setTimeout(a1.bind(this),300)}else{a1.call(this)}this.getCollapseTitle().innerHTML=a2.getTitle();if(this.isInformerShow){n.Dom.append(this.getInformer(),a0)}this.isCollapsedShow=true;this.emit("onShowCollapsedBlock")}if(aZ){this.showGuide()}else{this.checkButtonsState()}}},{key:"setCollapsedInvisible",value:function aW(){this.hideNode(this.getCollapseBlock())}},{key:"setCollapsedVisible",value:function Y(){this.showNode(this.getCollapseBlock())}},{key:"checkButtonsState",value:function ah(){this.emit("onCheckButtonsState");var aZ=this.collapsedStep;if(!aZ){return}if(aZ.getCompleted()){if(this.activeGuide){this.hideNode(this.getRepeatBtn())}else{this.showNode(this.getRepeatBtn())}this.hideNode(this.getCompletedBtn());this.hideNode(this.getStartBtn())}else{if(aZ.isActive){this.showNode(this.getCompletedBtn());if(this.activeGuide||!this.isShowRepeatWithCompleted){this.hideNode(this.getRepeatBtn())}else{this.showNode(this.getRepeatBtn())}this.hideNode(this.getStartBtn())}else{this.showNode(this.getStartBtn());this.hideNode(this.getRepeatBtn());this.hideNode(this.getCompletedBtn())}}}},{key:"showGuide",value:function aE(){this.emit("onBeforeShowGuide");var aZ=this.collapsedStep;if(!this.activeGuide&&aZ){this.emit("onStartShowGuide");this.activeGuide=new K.Guide({simpleMode:true,steps:[aZ.getHighlightOptions()]});this.activeGuide.subscribe(K.Guide.getFullEventName("onFinish"),this.finishGuide.bind(this));this.activeGuide.start();n.Dom.remove(this.activeGuide.getPopup().closeIcon);this.emit("showCollapseWithGuide");this.checkButtonsState()}}},{key:"closeGuide",value:function aw(){if(this.activeGuide instanceof K.Guide){this.activeGuide.close();this.emit("onAfterGuide")}}},{key:"getCollapseBlock",value:function ai(){if(!this.layout.collapseBlock){this.layout.collapseBlock=n.Tag.render(t(),this.clickCollapseBlockHandler.bind(this),n.Loc.getMessage("JS_UI_TUTOR_STEP_TITLE"),this.getCollapseTitle(),this.getStartBtn(),this.getRepeatBtn(),this.getCompletedBtn());this.emit("onCreateCollapsedBlockNode");n.Dom.append(this.layout.collapseBlock,document.body);this.emit("onAfterAppendCollapsedBlockNode")}return this.layout.collapseBlock}},{key:"getStartBtn",value:function aY(){var aZ=this;if(!this.startBtn){this.startBtn=n.Tag.render(r(),n.Loc.getMessage("JS_UI_TUTOR_BTN_START"));n.Event.bind(this.startBtn,"click",function(a0){a0.stopPropagation();aZ.emit("clickStartBtn")})}return this.startBtn}},{key:"getRepeatBtn",value:function aq(){var aZ=this;if(!this.repeatBtn){this.repeatBtn=n.Tag.render(o(),n.Loc.getMessage("JS_UI_TUTOR_BTN_REPEAT"));n.Event.bind(this.repeatBtn,"click",function(a0){a0.stopPropagation();aZ.emit("clickRepeatBtn")})}return this.repeatBtn}},{key:"getCompletedBtn",value:function al(){var aZ=this;if(!this.completedBtn){this.completedBtn=n.Tag.render(d(),n.Loc.getMessage("JS_UI_TUTOR_BTN_COMPLETED_SHORT"));n.Event.bind(this.completedBtn,"click",function(a0){a0.stopPropagation();aZ.emit("clickCompletedBtn")})}return this.completedBtn}},{key:"getCollapseTitle",value:function aF(){if(!this.layout.collapseTitle){this.layout.collapseTitle=n.Tag.render(b())}return this.layout.collapseTitle}},{key:"closeCollapsePopup",value:function at(aZ){this.closeCollapseEntity();this.emit("clickCloseCollapseBlock")}},{key:"clickCollapseBlockHandler",value:function ay(){this.emit("clickCollapseBlock")}},{key:"finishGuide",value:function ac(){delete this.activeGuide;this.checkButtonsState();this.emit("completeCloseGuide")}},{key:"closeCollapseEntity",value:function af(){this.emit("onBeforeHideCollapsedBlock");this.getCollapseBlock().style.display="none";this.getImButton().style.display="block";if(this.activeGuide instanceof K.Guide){this.activeGuide.close()}if(this.isInformerShow){n.Dom.append(this.getInformer(),this.getImButton())}delete this.collapsedStep;this.isCollapsedShow=false;this.emit("onHideCollapsedBlock")}},{key:"showLoader",value:function Z(){this.emit("onBeforeShowLoader");this.startTitle="";this.startText="";this.layout.loader=new H.Loader({target:this.getStartPopup(),size:85});this.layout.loader.show();this.getStartPopup().style.display="flex";n.Dom.addClass(this.getStartPopup(),"ui-tutor-popup-load");this.emit("onAfterShowLoader")}},{key:"hideLoader",value:function ap(){if(this.layout.loader){this.layout.loader.destroy();this.getStartPopup().style.display="none"}}},{key:"showCollapsedLoader",value:function am(){this.emit("onBeforeShowCollapsedLoader");this.layout.collapseLoader=new H.Loader({target:this.getCollapseBlock(),size:34});this.layout.collapseLoader.show();this.getCollapseBlock().style.display="flex";n.Dom.addClass(this.getCollapseBlock(),"ui-tutor-popup-collapse-load");this.emit("onAfterShowCollapsedLoader")}},{key:"hideCollapsedLoader",value:function av(){this.emit("onBeforeHideCollapsedLoader");if(this.layout.collapseLoader){this.layout.collapseLoader.destroy();n.Dom.removeClass(this.getCollapseBlock(),"ui-tutor-popup-collapse-load");this.getCollapseBlock().style.display="none"}this.emit("onAfterHideCollapsedLoader")}},{key:"showNode",value:function ax(aZ){aZ.style.display="block"}},{key:"hideNode",value:function aO(aZ){aZ.style.display="none"}},{key:"checkFollowLink",value:function aB(a1,a0){this.emit("onStartCheckFollowLink");a1=a1||this.collapsedStep;if(a1 instanceof l){a0=a0||{};if(!(window.location.pathname===a1.getUrl())){var aZ="onBeforeRedirectToActionPage";if(a0 instanceof O){n.Dom.addClass(a0.getStartBtn(),"ui-btn-wait");a0.fireCurrentStepEvent(aZ)}else{n.Dom.addClass(this.getStartBtn(),"ui-btn-wait");this.emit(aZ,{step:a1})}window.location=a1.getUrl()}else{if(a0 instanceof O){a0.showCollapseBlock(a1)}else{a1.activate();this.showCollapsedBlock(a1)}}}this.emit("onFinishCheckFollowLink")}},{key:"fireEvent",value:function aN(aZ){this.emit(aZ)}}]);return aS}(n.Event.EventEmitter);L.instance=null;L.scenarioInstance=null;L.activeGuide=null;L.isShowRepeatWithCompleted=true;L.layout={imButton:null,collapseBlock:null,collapseTitle:null};function p(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-arrow ui-tutor-popup-arrow-next"></div>\n\t\t\t\t']);V=function V(){return W};return W}function q(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-arrow ui-tutor-popup-arrow-prev"></div>\n\t\t\t\t']);V=function V(){return W};return W}function s(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-new-text">',"</div>\n\t\t\t\t"]);V=function V(){return W};return W}function u(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-finished-notice">',"</div>\n\t\t\t\t"]);V=function V(){return W};return W}function w(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-finished">\n\t\t\t\t\t\t<div class="ui-tutor-popup-finished-title">','</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-finished-icon"></div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-finished-text">',"</div>\n\t\t\t\t\t</div>\n\t\t\t\t"]);V=function V(){return W};return W}function y(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-help-link" onclick="','">\n\t\t\t\t\t\t<span class="ui-tutor-popup-help-link-text">',"</span>\n\t\t\t\t\t</span>\n\t\t\t\t"]);V=function V(){return W};return W}function A(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-video" data-step=',"></div>\n\t\t\t\t"]);W=function W(){return V};return V}function D(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-help">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t"]);W=function W(){return V};return V}function F(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t\t<span class="ui-tutor-popup-step-item" data-step=',' onclick="','">\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-step-item-number">',"</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t"]);W=function W(){return V};return V}function G(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-step-list"></div>\n\t\t\t\t']);V=function V(){return W};return W}function N(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<a class="ui-tutor-popup-support-link" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</a>\n\t\t\t\t"]);V=function V(){return W};return W}function P(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-step-decs"></div>\n\t\t\t\t']);V=function V(){return W};return W}function Q(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-step-title"></div>\n\t\t\t\t']);V=function V(){return W};return W}function R(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-completed">\n\t\t\t\t\t\t<div class="ui-tutor-popup-completed-icon"></div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-completed-text">',"</div>\n\t\t\t\t\t</div>\n\t\t\t\t"]);V=function V(){return W};return W}function S(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-link ui-btn-round" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);V=function V(){return W};return W}function T(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);V=function V(){return W};return W}function U(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-success ui-btn-round" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);V=function V(){return W};return W}function a(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-round" onclick="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);V=function V(){return W};return W}function e(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-defer-link">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t"]);e=function W(){return V};return V}function g(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-header-counter-number"></span>\n\t\t\t\t']);g=function W(){return V};return V}function j(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-header-counter-step">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</span>\n\t\t\t\t"]);j=function V(){return W};return W}function m(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-nav-item ui-tutor-popup-nav-item-next" onclick="','"></span>\n\t\t\t\t']);m=function V(){return W};return W}function C(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<span class="ui-tutor-popup-nav-item ui-tutor-popup-nav-item-prev" onclick="','"></span>\n\t\t\t\t']);C=function W(){return V};return V}function I(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-nav"></div>\n\t\t\t\t']);I=function W(){return V};return V}function M(){var V=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-btn">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t"]);M=function W(){return V};return V}function c(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-content-inner">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t"]);c=function V(){return W};return W}function f(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-footer">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t"]);f=function V(){return W};return W}function i(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup-content-block">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t"]);i=function V(){return W};return W}function h(){var W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div class="ui-tutor-popup ui-tutor-popup-step">\n\t\t\t\t\t\t<div class="ui-tutor-popup-header">\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-icon"></span>\n\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-title">\n\t\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-counter">\n\t\t\t\t\t\t\t\t\t',".\n\t\t\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class="ui-tutor-popup-header-subtitle">',"</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t",'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-content">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-step-wrap">\n\t\t\t\t\t\t\t<div class="ui-tutor-popup-step-inner">\n\t\t\t\t\t\t\t\t<div class="ui-tutor-popup-arrow-wrap"></div>\n\t\t\t\t\t\t\t\t<div class="ui-tutor-popup-step-list-wrap">\n\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-icon-close" onclick="','"></div>\n\t\t\t\t\t\t<div class="ui-tutor-popup-icon-angle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t']);h=function V(){return W};return W}var O=function(be){babelHelpers.inherits(aH,be);function aH(){var bv;var bu=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,aH);bv=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(aH).call(this));bv.setEventNamespace("BX.UI.Tutor.Scenario");bv.stepPopup=null;bv.arrowTimer=null;bv.guide=null;bv.loader=null;bv.arrowWrap=null;bv.prevArrow=null;bv.nextArrow=null;bv.currentStepIndex=0;bv.currentStep=null;bv.isAddedSteps=false;bv.hasArrows=false;bv.isLoading=true;bv.setOptions(bu);bv.btn=document.getElementById("ui-tutor-btn-wrap");bv.informer=document.getElementById("ui-tutor-informer");bv.layout={stepBlock:null,progress:null,counter:null,counterContainer:null,title:null,description:null,collapseBlock:null,collapseTitle:null,collapseDescription:null,content:null,contentInner:null,contentBlock:null,url:null,target:null,startBtn:null,nextBtn:null,repeatBtn:null,deferBtn:null,help:null,completedBtn:null,completedBlock:null,finishedBlock:null,supportLink:null};bv.sections=["settings","scenario","work"];bv.loadYoutubeApiScript();bv.subscribe("onYouTubeReady",function(){bv.setVideoItems()});return bv}babelHelpers.createClass(aH,[{key:"loadYoutubeApiScript",value:function bp(){var bx=function(){this.emit("onYouTubeReady",{scenario:this})}.bind(this);if(!window.YT){var bw=true;var bu=document.createElement("script");bu.src="https://www.youtube.com/iframe_api";var by=document.getElementsByTagName("script")[0];by.parentNode.insertBefore(bu,by);var bv=setInterval(function(){if(bw){if(window.YT&&n.Type.isFunction(window.YT.Player)){clearInterval(bv);bx()}}},200);setTimeout(function(){clearInterval(bv);bw=false},2000)}else{setTimeout(function(){bx()}.bind(this),100)}}},{key:"setOptions",value:function a0(bv){var by=this;this.fireCurrentStepEvent("onBeforeSetOptions",false);bv=n.Type.isPlainObject(bv)?bv:{};var bw=this.getCurrentStep();this.steps=[];if(Array.isArray(bv.steps)){bv.steps.forEach(function(bA){by.steps.push(new l(bA))})}if(bw instanceof l){var bx=this.findStepById(bw.getId());if(bx){bw=bx}}else{if(n.Type.isString(bv.currentStepId)&&bv.currentStepId.length>0){var bu=this.findStepById(bv.currentStepId);if(bu){bw=bu;if(bv.currentStepIsActive===true){bw.activate()}}}}if(!bw){var bz=this.getFirstUncompletedStep();if(bz){bw=bz}}if(!bw&&this.steps&&this.steps[0]){bw=this.steps[0]}this.setCurrentStep(bw);if(bv){this.isLoading=false}this.title=bv.title||"";this.supportLink=bv.supportLink||"";this.isFinished=bv.isFinished||false;this.fireCurrentStepEvent("onAfterSetOptions",false)}},{key:"setCurrentStep",value:function bl(bv){if(bv instanceof l){this.currentStep=bv;var bu=this.steps;if(n.Type.isArray(bu)){this.currentStepIndex=bu.indexOf(bv)}this.fireCurrentStepEvent("onStartStep")}}},{key:"start",value:function am(bu){this.emit("onStart",{scenario:this});if(bu){this.complexAnimation=true}this.showPopup(this.getStepPopup());this.toggleCompletedState();this.toggleNavBtn();this.setPopupData();if(this.isAddedSteps){this.hideFinalState()}if(!this.hasArrows){this.initArrows()}this.complexAnimation=false;this.fireCurrentStepEvent("onShowComplete")}},{key:"findStepById",value:function aj(bw){for(var bu=0;bu<this.steps.length;bu++){var bv=this.steps[bu];if(bv.getId()===bw){return bv}}return null}},{key:"getStepPopup",value:function ac(){var bv=this;var bu=function bu(){bv.emit("onClickOnCloseIcon",{scenario:bv})};if(!this.stepPopup){this.stepPopup=n.Tag.render(h(),n.Loc.getMessage("JS_UI_TUTOR_TITLE"),this.getCounterContainer(),this.title,this.getDeferLink(),this.getContentBlock(),this.getStepBlock(),bu.bind(this));this.fireCurrentStepEvent("onCreateStepPopupNode");n.Dom.append(this.stepPopup,document.body);this.fireCurrentStepEvent("onAfterAppendStepPopupNode")}return this.stepPopup}},{key:"getContentBlock",value:function bn(){if(!this.layout.contentBlock){this.layout.contentBlock=n.Tag.render(i(),this.getContentInner(),this.getFooter())}return this.layout.contentBlock}},{key:"getFooter",value:function br(){if(!this.layout.footer){this.layout.footer=n.Tag.render(f(),this.getNavigation(),this.getBtnContainer());if(L.getInstance().feedbackFormId){n.Dom.append(this.getSupportLink(),this.layout.footer)}}return this.layout.footer}},{key:"getContentInner",value:function aA(){if(!this.layout.contentInner){this.layout.contentInner=n.Tag.render(c(),this.getTitle(),this.getDescription(),this.getHelpBlock())}return this.layout.contentInner}},{key:"getBtnContainer",value:function ah(){if(!this.layout.btnContainer){this.layout.btnContainer=n.Tag.render(M(),this.getStartBtn(),this.getRepeatBtn(),this.getCompletedBtn())}return this.layout.btnContainer}},{key:"getNavigation",value:function aS(){if(!this.layout.navigation){this.layout.navigation=n.Tag.render(I());this.layout.backBtn=n.Tag.render(C(),this.clickOnBackBtn.bind(this));this.layout.nextBtn=n.Tag.render(m(),this.clickOnNextBtn.bind(this));n.Dom.append(this.layout.backBtn,this.layout.navigation);n.Dom.append(this.layout.nextBtn,this.layout.navigation)}return this.layout.navigation}},{key:"setInformer",value:function ai(bu){this.setInformerCount(this.steps.length-this.getCompletedSteps())}},{key:"setInformerExternal",value:function a2(bu){this.setInformerCount(bu)}},{key:"setInformerCount",value:function aR(bu){L.setCount(bu)}},{key:"closeStepPopup",value:function ba(bu,bv){if(!this.stepPopup){return}if(bu){bu.stopPropagation()}this.fireCurrentStepEvent("onCloseStepPopup");if(bv){this.complexAnimation=true}this.fadeAnimation(this.getStepPopup());setTimeout(function(){this.hideNode(this.getStepPopup())}.bind(this),310);this.complexAnimation=false}},{key:"getCompletedSteps",value:function ax(){var bv=0;for(var bu=0;bu<this.steps.length;bu+=1){if(this.steps[bu].isCompleted){bv+=1}}return bv}},{key:"setStepCounter",value:function aD(){this.getCounter().textContent=n.Loc.getMessage("JS_UI_TUTOR_COUNTER_NUMBER").replace("#NUMBER#",this.steps.indexOf(this.getCurrentStep())+1).replace("#NUMBER_TOTAL#",this.steps.length)}},{key:"getCounterContainer",value:function a3(){if(!this.layout.counterContainer){this.layout.counterContainer=n.Tag.render(j(),this.getCounter())}return this.layout.counterContainer}},{key:"getCounter",value:function aP(){if(!this.layout.counter){this.layout.counter=n.Tag.render(g())}return this.layout.counter}},{key:"getDeferLink",value:function ak(){if(!this.layout.deferLink){this.layout.deferLink=n.Tag.render(e(),n.Loc.getMessage("JS_UI_TUTOR_BTN_DEFER"));var bu=new BX.PopupMenuWindow({angle:true,offsetLeft:15,className:"ui-tutor-popup-defer-menu",bindElement:this.layout.deferLink,items:[{text:n.Loc.getMessage("JS_UI_TUTOR_DEFER_MENU_HOUR"),onclick:function(){this.emit("onDeferOneHour",{scenario:this});bu.close()}.bind(this)},{text:n.Loc.getMessage("JS_UI_TUTOR_DEFER_MENU_TOMORROW"),onclick:function(){this.emit("onDeferTomorrow",{scenario:this});bu.close()}.bind(this)},{text:n.Loc.getMessage("JS_UI_TUTOR_DEFER_MENU_WEEK"),onclick:function(){this.emit("onDeferWeek",{scenario:this});bu.close()}.bind(this)},{text:n.Loc.getMessage("JS_UI_TUTOR_DEFER_MENU_FOREVER"),onclick:function(){this.emit("onDeferForever",{scenario:this});bu.close()}.bind(this)}]});n.Event.bind(this.layout.deferLink,"click",function(){bu.show()})}return this.layout.deferLink}},{key:"getStartBtn",value:function a5(){if(!this.layout.startBtn){this.layout.startBtn=n.Tag.render(a(),this.clickStartHandler.bind(this),n.Loc.getMessage("JS_UI_TUTOR_BTN_START"))}return this.layout.startBtn}},{key:"getCompletedBtn",value:function av(){if(!this.layout.completedBtn){this.layout.completedBtn=n.Tag.render(U(),this.showSuccessState.bind(this),n.Loc.getMessage("JS_UI_TUTOR_BTN_COMPLETED"))}return this.layout.completedBtn}},{key:"getRepeatBtn",value:function aM(){if(!this.layout.repeatBtn){this.layout.repeatBtn=n.Tag.render(T(),this.repeatStep.bind(this),n.Loc.getMessage("JS_UI_TUTOR_BTN_REPEAT"))}return this.layout.repeatBtn}},{key:"getDeferBtn",value:function aN(){if(!this.layout.deferBtn){this.layout.deferBtn=n.Tag.render(S(),this.closeStepPopup.bind(this),n.Loc.getMessage("JS_UI_TUTOR_BTN_DEFER"))}return this.layout.deferBtn}},{key:"getCompletedBLock",value:function aw(){if(!this.layout.completedBlock){this.layout.completedBlock=n.Tag.render(R(),n.Loc.getMessage("JS_UI_TUTOR_STEP_COMPLETED"))}return this.layout.completedBlock}},{key:"getTitle",value:function aE(){if(!this.layout.title){this.layout.title=n.Tag.render(Q())}return this.layout.title}},{key:"getDescription",value:function bb(){if(!this.layout.description){this.layout.description=n.Tag.render(P())}return this.layout.description}},{key:"getSupportLink",value:function ae(){if(!this.layout.supportLink){this.layout.supportLink=n.Tag.render(N(),this.supportLinkHandler.bind(this),n.Loc.getMessage("JS_UI_TUTOR_BTN_SUPPORT"))}return this.layout.supportLink}},{key:"setInvisible",value:function aW(){this.hideNode(this.getStepPopup())}},{key:"setVisible",value:function au(){this.showNode(this.getStepPopup())}},{key:"supportLinkHandler",value:function bq(){this.emit("supportLinkClick");L.getInstance().showFeedbackForm()}},{key:"getStepBlock",value:function aY(){if(!this.layout.stepBlock){this.layout.stepBlock=n.Tag.render(G());this.layout.stepItems=[];for(var bu=0;bu<this.steps.length;bu+=1){var bv=n.Tag.render(F(),bu,this.switchStep.bind(this),bu+1);this.layout.stepItems.push(bv);n.Dom.append(bv,this.layout.stepBlock)}this.setStepItems()}return this.layout.stepBlock}},{key:"setStepItems",value:function V(){if(this.layout&&this.layout.stepItems){for(var bu=0;bu<this.steps.length;bu+=1){if(this.layout.stepItems[bu]){n.Dom.removeClass(this.layout.stepItems[bu],"ui-tutor-popup-step-item-current");if(bu===this.currentStepIndex){n.Dom.addClass(this.layout.stepItems[bu],"ui-tutor-popup-step-item-current")}if(this.steps[bu].isCompleted){n.Dom.addClass(this.layout.stepItems[bu],"ui-tutor-popup-step-item-completed")}}}}}},{key:"getHelpBlock",value:function ap(){if(!this.layout.help){this.layout.help=n.Tag.render(D(),this.getHelpLink())}return this.layout.help}},{key:"setVideoItems",value:function bt(){for(var bv=0;bv<this.steps.length;bv+=1){var bu=n.Tag.render(A(),bv);n.Dom.prepend(bu,this.getHelpBlock());if(window.YT&&n.Type.isObject(window.YT)&&n.Type.isFunction(window.YT.Player)&&this.steps[bv].video!==null){var bw={videoId:this.steps[bv].video,events:{onReady:function(bx){bx.target.mute();bx.target.pauseVideo();bx.target.setPlaybackQuality("hd720");if(+bx.target.getIframe().getAttribute("data-step")===this.currentStepIndex){n.Dom.addClass(bx.target.getIframe(),"ui-tutor-popup-video-show");bx.target.playVideo()}}.bind(this)},playerVars:{cc_load_policy:1,cc_lang_pref:"ru",rel:0}};this.fireCurrentStepEvent("onBeforeCreateVideo",true,{playerData:bw});this.steps[bv].videoObj=new YT.Player(bu,bw);this.fireCurrentStepEvent("onAfterCreateVideo")}}}},{key:"pauseCurrentVideo",value:function aK(){var bv=this.getCurrentStep();if(window.YT&&bv instanceof l){var bu=bv.getVideoObj();if(n.Type.isObject(bu)&&bu.pauseVideo){bu.pauseVideo()}}}},{key:"playCurrentVideo",value:function aB(){var bv=this.getCurrentStep();if(window.YT&&bv instanceof l){var bu=bv.getVideoObj();if(n.Type.isObject(bu)&&bu.playVideo){bu.playVideo()}}}},{key:"getHelpLink",value:function ab(){if(!this.layout.link){this.layout.link=n.Tag.render(y(),this.handleClickLinkHandler.bind(this),n.Loc.getMessage("JS_UI_TUTOR_ARTICLE_HELP_TOPIC"))}return this.layout.link}},{key:"handleClickLinkHandler",value:function aa(){this.emit("helpLinkClick")}},{key:"showPopup",value:function bi(bu){this.showAnimation(bu);bu.style.display="block"}},{key:"showNode",value:function bf(bu){bu.style.display="block"}},{key:"hideNode",value:function ag(bu){bu.style.display="none"}},{key:"removePopup",value:function bc(bu){n.Dom.remove(bu)}},{key:"clickOnNextBtn",value:function W(){this.fireCurrentStepEvent("onBeforeClickNavNextBtn");if(this.getCompletedSteps()===this.steps.length&&!this.isFinished){this.isAddedSteps=false;n.Dom.remove(this.getNewStepsSection());n.Dom.removeClass(this.getFinishedBlock(),"ui-tutor-popup-finished-new");this.showFinalState();return}if(this.getCompletedSteps()===this.steps.length&&this.currentStepIndex+1===this.steps.length){this.currentStepIndex=-1}n.Dom.removeClass(this.getStartBtn(),"ui-btn-wait");this.increaseCurrentIndex();this.showStep();this.toggleNavBtn();this.fireCurrentStepEvent("onAfterClickNavNextBtn")}},{key:"clickOnBackBtn",value:function ar(){this.fireCurrentStepEvent("onBeforeClickNavBackBtn");this.reduceCurrentIndex();this.toggleNavBtn();this.showStep();this.fireCurrentStepEvent("onAfterClickNavBackBtn")}},{key:"toggleNavBtn",value:function al(){n.Dom.removeClass(this.layout.backBtn,"ui-tutor-popup-nav-item-disabled");n.Dom.removeClass(this.layout.nextBtn,"ui-tutor-popup-nav-item-disabled");if(this.currentStepIndex===0){n.Dom.addClass(this.layout.backBtn,"ui-tutor-popup-nav-item-disabled")}if(this.currentStepIndex+1===this.steps.length){n.Dom.addClass(this.layout.nextBtn,"ui-tutor-popup-nav-item-disabled")}}},{key:"showStep",value:function aX(){if(this.clickOnCompletedBtn&&this.currentStepIndex===this.steps.length){var bu=this.getFirstUncompletedStep();if(bu){this.setCurrentStep(bu)}}this.scrollToStep();this.toggleCompletedState();this.setPopupData();this.clickOnCompletedBtn=false;this.fireCurrentStepEvent("onAfterShowStep")}},{key:"switchStep",value:function az(){this.fireCurrentStepEvent("onBeforeSwitchStep");this.setCurrentStep(this.steps[+window.event.target.getAttribute("data-step")]);this.fireCurrentStepEvent("onAfterSwitchStep");if(this.layout.finishedBlock){this.hideFinalState()}this.showStep();this.toggleNavBtn();this.fireCurrentStepEvent("onEndSwitchStep")}},{key:"getFirstUncompletedStep",value:function bs(){for(var bu=0;bu<this.steps.length;bu+=1){if(!this.steps[bu].isCompleted){return this.steps[bu]}}return null}},{key:"toggleCompletedState",value:function Y(){var bu=this.getCurrentStep();if(bu){if(bu.getCompleted()){this.showNode(this.getRepeatBtn());this.hideNode(this.getStartBtn());this.hideNode(this.getCompletedBtn())}else{if(bu.isActive){this.showNode(this.getCompletedBtn());this.hideNode(this.getStartBtn());this.showNode(this.getRepeatBtn())}else{this.showNode(this.getStartBtn());this.hideNode(this.getCompletedBtn());this.hideNode(this.getRepeatBtn())}}}}},{key:"setPopupData",value:function aU(){this.fireCurrentStepEvent("onBeforeSetPopupData");var bu=this.getCurrentStep();if(bu){this.getTitle().innerHTML=bu.getTitle();this.getDescription().innerHTML=bu.getDescription();L.getCollapseTitle().innerHTML=bu.getTitle();if(this.getCurrentStep().getVideo()&&window.YT){this.setCurrentVideo()}this.setStepCounter();this.setStepItems()}this.fireCurrentStepEvent("onAfterSetPopupData")}},{key:"setCurrentVideo",value:function bg(){this.fireCurrentStepEvent("onSetCurrentVideo");for(var bu=0;bu<this.steps.length;bu+=1){var bv=this.steps[bu].getVideoObj();if(window.YT&&bu===this.currentStepIndex&&bv&&bv.playVideo){n.Dom.addClass(bv.getIframe(),"ui-tutor-popup-video-show");bv.playVideo()}else{if(bv){n.Dom.removeClass(bv.getIframe(),"ui-tutor-popup-video-show");if(bv.pauseVideo){bv.pauseVideo()}}}}}},{key:"getCurrentStep",value:function af(){return this.currentStep}},{key:"increaseCurrentIndex",value:function aT(){if(this.currentStepIndex===this.steps.length){return}this.currentStepIndex+=1;this.setCurrentStep(this.steps[this.currentStepIndex])}},{key:"reduceCurrentIndex",value:function aO(){if(this.currentStepIndex===0){return}this.currentStepIndex-=1;this.setCurrentStep(this.steps[this.currentStepIndex])}},{key:"showCollapseBlock",value:function aQ(bv,bu){bu=bu!==false;this.closeStepPopup(null,true);L.showCollapsedBlock(bv,bu)}},{key:"minimize",value:function a7(){this.pauseCurrentVideo();this.fireCurrentStepEvent("onMinimize");this.showCollapseBlock(this.getCurrentStep(),false)}},{key:"repeatStep",value:function a6(){this.followLink()}},{key:"clickStartHandler",value:function aq(){this.followLink()}},{key:"followLink",value:function ao(bv){var bu=this.getCurrentStep();if(bv instanceof l){bu=bv}this.pauseCurrentVideo();this.setActiveStep(bu);L.checkFollowLink(bu,this)}},{key:"setActiveStep",value:function aV(bu){this.fireCurrentStepEvent("onBeforeSetActiveStep");if(this.currentActiveStep instanceof l){this.currentActiveStep.deactivate()}bu.activate();this.currentActiveStep=bu;this.fireCurrentStepEvent("onAfterSetActiveStep")}},{key:"showSuccessState",value:function bh(){var bu=this.getCurrentStep();this.clickOnCompletedBtn=true;bu.isCompleted=true;this.fireCurrentStepEvent("onFinishStep");if(bu.getCompleted()){n.Dom.addClass(this.layout.stepItems[this.currentStepIndex],"ui-tutor-popup-step-item-completed")}n.Dom.addClass(this.getContentBlock(),"ui-tutor-popup-content-block-animate");setTimeout(function(){n.Dom.replace(this.getHelpBlock(),this.getCompletedBLock());this.getFooter().style.display="none";this.getDescription().style.display="none";this.getTitle().style.display="none"}.bind(this),300);setTimeout(function(){n.Dom.addClass(this.getCompletedBLock(),"ui-tutor-popup-completed-animate")}.bind(this),800);setTimeout(function(){n.Dom.replace(this.getCompletedBLock(),this.getHelpBlock());this.getTitle().style.display="block";this.getDescription().style.display="block";this.getFooter().style.display="flex";this.clickOnNextBtn()}.bind(this),1500);setTimeout(function(){n.Dom.removeClass(this.getCompletedBLock(),"ui-tutor-popup-completed-animate");n.Dom.removeClass(this.getContentBlock(),"ui-tutor-popup-content-block-animate");var bv=this.stepPopup.querySelector(".ui-tutor-popup-header-counter-number");bv.innerHTML=n.Loc.getMessage("JS_UI_TUTOR_COUNTER_NUMBER").replace("#NUMBER#",this.steps.indexOf(this.getCurrentStep())+1).replace("#NUMBER_TOTAL#",this.steps.length);this.fireCurrentStepEvent("onAfterShowSuccessState")}.bind(this),1700)}},{key:"fireCurrentStepEvent",value:function X(bv,by,bu){by=by!==false;var bw=this.getCurrentStep();var bx={step:bw,scenario:this};if(bu){bx.extra=bu}if(bw&&by){bw.emit(bv,bx)}this.emit(bv,bx)}},{key:"showFinalState",value:function ay(){this.fireCurrentStepEvent("onFinalState");if(this.layout.stepItems){n.Dom.removeClass(this.layout.stepItems[this.currentStepIndex],"ui-tutor-popup-step-item-current")}n.Dom.append(this.getFinishedBlock(),this.getContentInner());n.Dom.replace(this.getStartBtn(),this.getFinishedNotice());n.Dom.remove(this.getCompletedBtn());n.Dom.remove(this.getSupportLink());n.Dom.remove(this.getNavigation());n.Dom.remove(this.getHelpBlock());n.Dom.remove(this.getRepeatBtn());n.Dom.remove(this.getTitle());n.Dom.remove(this.getDescription());n.Dom.remove(this.getDeferLink());this.isFinished=true;this.fireCurrentStepEvent("onAfterFinalState")}},{key:"hideFinalState",value:function bo(){this.fireCurrentStepEvent("onBeforeHideFinalState");if(this.getCurrentStep().getCompleted()){n.Dom.replace(this.getFinishedNotice(),this.getRepeatBtn())}else{n.Dom.replace(this.getFinishedNotice(),this.getStartBtn())}n.Dom.replace(this.getFinishedBlock(),this.getHelpBlock());if(L.getInstance().feedbackFormId){n.Dom.append(this.getSupportLink(),this.getFooter())}n.Dom.prepend(this.getNavigation(),this.getFooter());n.Dom.prepend(this.getDescription(),this.getContentInner());n.Dom.prepend(this.getTitle(),this.getContentInner());if(this.layout.deferBtn){n.Dom.remove(this.getDeferBtn());n.Dom.prepend(this.getStartBtn(),this.getBtnContainer())}var bu=this.getStepPopup().querySelector(".ui-tutor-popup-header");n.Dom.append(this.getDeferLink(),bu);this.fireCurrentStepEvent("onAfterHideFinalState")}},{key:"getFinishedBlock",value:function at(){if(!this.layout.finishedBlock){this.layout.finishedBlock=n.Tag.render(w(),n.Loc.getMessage("JS_UI_TUTOR_FINAL_CONGRATULATIONS"),n.Loc.getMessage("JS_UI_TUTOR_FINAL_TEXT"))}return this.layout.finishedBlock}},{key:"getFinishedNotice",value:function aF(){if(!this.layout.finishedNotice){this.layout.finishedNotice=n.Tag.render(u(),n.Loc.getMessage("JS_UI_TUTOR_FINAL_NOTICE"))}return this.layout.finishedNotice}},{key:"getNewStepsSection",value:function aL(){if(!this.layout.newStepsSection){this.layout.newStepsSection=n.Tag.render(s(),n.Loc.getMessage("JS_UI_TUTOR_STEP_NEW"))}return this.layout.newStepsSection}},{key:"showNewSteps",value:function aC(){n.Dom.addClass(this.getFinishedBlock(),"ui-tutor-popup-finished-new");this.showPopup(this.getStepPopup());this.showFinalState();n.Dom.append(this.getNewStepsSection(),this.getFinishedBlock());n.Dom.replace(this.getFinishedNotice(),L.getBeginBtn());n.Dom.append(this.getDeferBtn(),this.getBtnContainer());this.setStepCounter();this.initArrows();this.scrollToStep();this.isAddedSteps=true;this.isFinished=false}},{key:"initArrows",value:function a4(){this.stepListWrap=document.querySelector(".ui-tutor-popup-step-list-wrap");this.arrowWrap=document.querySelector(".ui-tutor-popup-arrow-wrap");if(this.stepListWrap&&this.stepListWrap.scrollWidth>this.stepListWrap.offsetWidth){n.Dom.append(this.getPrevArrow(),this.arrowWrap);n.Dom.append(this.getNextArrow(),this.arrowWrap);this.stepListWrap.addEventListener("scroll",this.toggleArrows.bind(this));this.prevArrow.addEventListener("mouseenter",this.scrollToLeft.bind(this));this.prevArrow.addEventListener("mouseleave",this.stopAutoScroll.bind(this));this.nextArrow.addEventListener("mouseenter",this.scrollToRight.bind(this));this.nextArrow.addEventListener("mouseleave",this.stopAutoScroll.bind(this));this.toggleNextArrow();this.getStepBlock().classList.add("ui-tutor-popup-step-list-wide");this.hasArrows=true}}},{key:"getPrevArrow",value:function aJ(){if(!this.prevArrow){this.prevArrow=n.Tag.render(q())}return this.prevArrow}},{key:"getNextArrow",value:function a9(){if(!this.nextArrow){this.nextArrow=n.Tag.render(p())}return this.nextArrow}},{key:"scrollToLeft",value:function bk(){this.arrowTimer=setInterval(function(){this.stepListWrap.scrollLeft-=5}.bind(this),20)}},{key:"scrollToRight",value:function bj(){this.arrowTimer=setInterval(function(){this.stepListWrap.scrollLeft+=5}.bind(this),20)}},{key:"stopAutoScroll",value:function a1(){clearInterval(this.arrowTimer)}},{key:"toggleArrows",value:function bm(){this.togglePrevArrow();this.toggleNextArrow()}},{key:"toggleNextArrow",value:function a8(){if(this.stepListWrap.scrollWidth>this.stepListWrap.offsetWidth&&this.stepListWrap.offsetWidth+this.stepListWrap.scrollLeft<this.stepListWrap.scrollWidth){n.Dom.addClass(this.nextArrow,"ui-tutor-popup-arrow-show")}else{n.Dom.removeClass(this.nextArrow,"ui-tutor-popup-arrow-show")}}},{key:"togglePrevArrow",value:function aI(){if(this.stepListWrap.scrollLeft>0){n.Dom.addClass(this.prevArrow,"ui-tutor-popup-arrow-show")}else{n.Dom.removeClass(this.prevArrow,"ui-tutor-popup-arrow-show")}}},{key:"showAnimation",value:function ad(bu){n.Dom.removeClass(bu,"ui-tutor-popup-hide-complex");n.Dom.removeClass(bu,"ui-tutor-popup-hide");if(this.complexAnimation){n.Dom.addClass(bu,"ui-tutor-popup-show-complex")}else{n.Dom.addClass(bu,"ui-tutor-popup-show")}}},{key:"fadeAnimation",value:function an(bu){n.Dom.removeClass(bu,"ui-tutor-popup-show-complex");n.Dom.removeClass(bu,"ui-tutor-popup-show");if(this.complexAnimation){n.Dom.addClass(bu,"ui-tutor-popup-hide-complex")}else{n.Dom.addClass(bu,"ui-tutor-popup-hide")}}},{key:"scrollToStep",value:function bd(){var bw=null;var bv=null;if(this.stepListWrap){bw=n.Dom.getPosition(this.stepListWrap);bv=n.Dom.getPosition(this.stepListWrap.querySelector('[data-step="'+this.currentStepIndex+'"]'))}var bu=7;if(!n.Type.isNull(bv)&&bv.left+bv.width>bw.left+bw.width){this.stepListWrap.scrollLeft+=bv.left-(bw.left+bw.width)+bv.width+bu}if(!n.Type.isNull(bv)&&bv.left<bw.left){this.stepListWrap.scrollLeft-=bw.left-bv.left+bu}}}],[{key:"getFullEventName",value:function Z(bu){return bu}},{key:"getInstance",value:function aG(){return L.getScenarioInstance()}},{key:"init",value:function aZ(bu){return L.initScenario(bu)}}]);return aH}(n.Event.EventEmitter);J.Scenario=O;J.Manager=L;J.Step=l}((this.BX.UI.Tutor=this.BX.UI.Tutor||{}),BX,BX.UI.Tour,BX));