(function(){var a=BX.namespace("BX.UI.Feedback");var b=[];a.Form=function(c){this.init(c);b.push(this)};a.Form.getList=function(){return b};a.Form.getById=function(c){return b.filter(function(d){return d.id===c})[0]||null};a.Form.prototype={init:function(c){this.id=c.id;this.portal=c.portal;this.presets=c.presets||{};this.form=c.form||{};this.title=c.title||"";if(c.button){this.button=BX(c.button);BX.bind(this.button,"click",this.openPanel.bind(this))}},appendPresets:function(c){for(var d in c){if(!c.hasOwnProperty(d)){continue}this.presets[d]=c[d]}},openPanel:function(){BX.SidePanel.Instance.open("ui:feedback-form-"+this.id,{cacheable:true,contentCallback:function(){var c=new BX.Promise();c.fulfill();return c},animationDuration:200,events:{onLoad:this.onSidePanelLoad.bind(this)},width:600})},onSidePanelLoad:function(e){this.formNode=document.createElement("div");var f=document.createElement("div");f.style='margin-bottom: 25px; font: 26px/26px "OpenSans-Light", Helvetica, Arial, sans-serif;';f.textContent=this.title;var c=document.createElement("div");c.style="padding: 20px; overflow-y: auto;";c.appendChild(f);c.appendChild(this.formNode);var d=e.getSlider();d.layout.content.appendChild(c);setTimeout(function(){d.showLoader()},0);this.loadForm(function(){d.closeLoader()})},loadForm:function(d){var c=this.form;if(!c||!c.id||!c.lang||!c.sec){return}if(c.presets){this.appendPresets(c.presets)}(function(f,l,g,e){f.Bitrix24FormObject=e;f[e]=f[e]||function(){arguments[0].ref=g;(f[e].forms=f[e].forms||[]).push(arguments[0])};if(f[e]["forms"]){return}var j=l.createElement("script");var k=1*new Date();j.async=1;j.src=g+"?"+k;var i=l.getElementsByTagName("script")[0];i.parentNode.insertBefore(j,i)})(top,top.document,this.portal+"/bitrix/js/crm/form_loader.js","b24form");top.b24form({id:c.id,lang:c.lang,sec:c.sec,type:"inline",node:this.formNode,presets:this.presets,handlers:{load:d}})}}})();