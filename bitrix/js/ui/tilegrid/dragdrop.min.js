(function(){BX.namespace("BX.TileGrid");BX.TileGrid.DragDrop=function(a){this.gridTile=a;this.draggableContainer=null;this.droppableItem=null;this.draggableItems=[]};BX.TileGrid.DragDrop.prototype={registerItem:function(a){a.onbxdragstart=BX.proxy(this.onDragStart,this);a.onbxdrag=BX.proxy(this.onDrag,this);a.onbxdragstop=BX.proxy(this.onDragStop,this);a.onbxdraghover=BX.proxy(this.onDragOver,this);a.onbxdraghout=BX.proxy(this.onDragOut,this);jsDD.registerObject(a)},registerDrop:function(a){jsDD.registerDest(a,10)},onDragStart:function(){this.setDraggableItems();this.setDraggableContainer();var e=BX.proxy_context;var d=this.gridTile.getItem(e.dataset.id);if(!d.selected){this.gridTile.resetSelectAllItems();this.draggableItems=[];this.draggableItems.push(d)}var a;var b=this.draggableItems[0].layout.container.offsetWidth;for(var c=0;c<this.draggableItems.length;c++){a=this.draggableItems[c].layout.container.cloneNode(true);a.style.width=b+"px";this.draggableContainer.appendChild(a);this.toggleActiveClass(this.draggableItems[c].layout.container)}BX.onCustomEvent(this.gridTile,"TileGrid.Grid:onItemDragStart",[this]);document.body.appendChild(this.draggableContainer)},onDrag:function(a,b){this.draggableContainer.style.left=a+"px";this.draggableContainer.style.top=b+"px"},onDragOver:function(a){this.handlerDroppableClass();var b=a.dataset.id;this.droppableItem=this.gridTile.getItem(b);this.handlerDroppableClass();BX.onCustomEvent(this.gridTile,"TileGrid.Grid:onItemDragOver",[this])},onDragOut:function(a){this.handlerDroppableClass();this.droppableItem=null;BX.onCustomEvent(this.gridTile,"TileGrid.Grid:onItemDragOut",[this])},handlerDroppableClass:function(){if(!this.droppableItem){return}BX.toggleClass(this.droppableItem.layout.container,"ui-grid-tile-item-droppable")},onDragStop:function(){this.gridTile.resetSelectAllItems();this.moveDraggableItems();this.handlerDroppableClass();for(var a=0;a<this.draggableItems.length;a++){this.toggleActiveClass(this.draggableItems[a].layout.container)}this.draggableContainer.parentNode.removeChild(this.draggableContainer);this.draggableItems=[];this.droppableItem=null;this.draggableContainer=null;BX.onCustomEvent(this.gridTile,"TileGrid.Grid:onItemDragStop",[this])},moveDraggableItems:function(){for(var b=0;b<this.draggableItems.length;b++){if(this.draggableItems[b]===this.droppableItem){return}}if(!this.droppableItem){return}if(this.droppableItem.isDroppable){this.droppableItem.animateNode();for(var a=0;a<this.draggableItems.length;a++){this.gridTile.moveItem(this.draggableItems[a],this.droppableItem)}}},setDraggableItems:function(){for(var a=0;a<this.gridTile.items.length;a++){this.gridTile.items[a].selected?this.draggableItems.push(this.gridTile.items[a]):null}},setDraggableContainer:function(){this.draggableContainer=BX.create("div",{attrs:{className:this.draggableItems.length<=1?"ui-grid-tile-item-draggable-single":"ui-grid-tile-item-draggable"},style:{width:this.draggableItems.length>1?this.draggableItems[0].layout.container.offsetWidth+"px":null,height:this.draggableItems.length>1?this.draggableItems[0].layout.container.offsetHeight+"px":null}})},toggleActiveClass:function(a){a.classList.contains("ui-grid-tile-item-active")?a.classList.remove("ui-grid-tile-item-active"):a.classList.add("ui-grid-tile-item-active")}}})();