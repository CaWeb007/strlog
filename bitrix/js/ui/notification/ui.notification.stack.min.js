(function(){BX.namespace("BX.UI.Notification");BX.UI.Notification.Position={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};BX.UI.Notification.Stack=function(a){a=BX.type.isPlainObject(a)?a:Object.create(null);this.balloons=[];this.queueStack=[];this.id=BX.type.isNotEmptyString(a.id)?a.id:BX.util.getRandomString(8).toLowerCase();this.position=BX.UI.Notification.Stack.getPositionCode(a.position)?a.position:"top-right";this.spacing=20;this.offsetX=25;this.offsetY=25;this.newestOnTop=false;this.balloonType=BX.UI.Notification.Balloon;this.setOptions(a);BX.addCustomEvent(BX.UI.Notification.Event.getFullName("onClose"),this.handleBalloonClose.bind(this))};BX.UI.Notification.Stack.getPositionCode=function(a){for(var b in BX.UI.Notification.Position){if(BX.UI.Notification.Position[b]===a){return b}}return null};BX.UI.Notification.Stack.prototype={adjustPosition:function(a){var b=0;this.getBalloons().forEach(function(c){if(!a||a===c){switch(this.getPosition()){case BX.UI.Notification.Position.TOP_LEFT:c.getContainer().style.left=this.getOffsetX()+"px";c.getContainer().style.top=b+this.getOffsetY()+"px";break;case BX.UI.Notification.Position.TOP_CENTER:c.getContainer().style.left="50%";c.getContainer().style.transform="translateX(-50%)";c.getContainer().style.top=b+this.getOffsetY()+"px";break;case BX.UI.Notification.Position.TOP_RIGHT:c.getContainer().style.right=this.getOffsetX()+"px";c.getContainer().style.top=b+this.getOffsetY()+"px";break;case BX.UI.Notification.Position.BOTTOM_LEFT:c.getContainer().style.left=this.getOffsetX()+"px";c.getContainer().style.bottom=b+this.getOffsetY()+"px";break;case BX.UI.Notification.Position.BOTTOM_CENTER:c.getContainer().style.left="50%";c.getContainer().style.transform="translateX(-50%)";c.getContainer().style.bottom=b+this.getOffsetY()+"px";break;case BX.UI.Notification.Position.BOTTOM_RIGHT:c.getContainer().style.right=this.getOffsetX()+"px";c.getContainer().style.bottom=b+this.getOffsetY()+"px";break}}b+=this.getSpacing()+c.getHeight()},this)},add:function(a){if(this.getBalloons().length>0&&(this.getQueue().length>0||!this.isBalloonFitToViewport(a))){this.queue(a)}else{this.push(a)}},remove:function(a){this.balloons=this.balloons.filter(function(b){return a!==b})},push:function(a){if(!(a instanceof BX.UI.Notification.Balloon)){throw new Error("'balloon' must be an instance of BX.UI.Notification.Balloon.")}if(this.balloons.indexOf(a)===-1){if(this.isNewestOnTop()){this.balloons.splice(0,0,a)}else{this.balloons.push(a)}}},queue:function(a){if(!(a instanceof BX.UI.Notification.Balloon)){throw new Error("'balloon' must be an instance of BX.UI.Notification.Balloon.")}if(this.queueStack.indexOf(a)===-1){a.setState(BX.UI.Notification.State.QUEUED);this.queueStack.push(a)}},checkQueue:function(){var a=this.queueStack.slice();for(var b=0;b<a.length;b++){var c=a[b];if(!this.isBalloonFitToViewport(c)&&this.getBalloons().length>0){break}c.setState(BX.UI.Notification.State.INIT);this.queueStack.shift();this.push(c);c.show()}},getQueue:function(){return this.queueStack},isBalloonFitToViewport:function(c){var a=document.documentElement.clientHeight;var b=this.getSpacing()+c.getHeight();return this.getHeight()+b<=a},handleBalloonClose:function(a){var b=a.getBalloon();if(b.getStack()!==this){return}this.remove(b);this.adjustPosition();this.checkQueue()},setOptions:function(a){a=a||{};this.setSpacing(a.spacing);this.setOffsetX(a.offsetX);this.setOffsetY(a.offsetY);this.setNewestOnTop(a.newestOnTop);this.setBalloonType(a.balloonType)},getId:function(){return this.id},getBalloons:function(){return this.balloons},getPosition:function(){return this.position},getSpacing:function(){return this.spacing},setSpacing:function(a){if(BX.type.isNumber(a)){this.spacing=a}},getOffsetX:function(){return this.offsetX},setOffsetX:function(a){if(BX.type.isNumber(a)){this.offsetX=a}},getOffsetY:function(){return this.offsetY},setOffsetY:function(a){if(BX.type.isNumber(a)){this.offsetY=a}},getHeight:function(){return this.getBalloons().reduce(function(a,b){return a+b.getHeight()+this.getSpacing()}.bind(this),this.getOffsetY())},getBalloonType:function(b){if(BX.type.isFunction(b)){return b}var a=BX.getClass(b);if(BX.type.isFunction(a)){return a}return this.balloonType||BX.UI.Notification.Balloon},setBalloonType:function(b){if(BX.type.isFunction(b)){this.balloonType=b}else{if(BX.type.isNotEmptyString(b)){var a=BX.getClass(b);if(BX.type.isFunction(a)){this.balloonType=a}}}},isNewestOnTop:function(){return this.newestOnTop},setNewestOnTop:function(a){if(BX.type.isBoolean(a)){this.newestOnTop=a}}}})();