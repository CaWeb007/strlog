(function(a){if(BX.Scale.Role){return}BX.Scale.Role=function(d,b,c){this.id=d;this.hostname=b;this.domObj=null;this.showLoadBar=!!BX.Scale.rolesList[this.id].LOADBAR_INFO;this.showMenu=true;this.showMenuClose=false;this.type=null;this.state=null;this.color=BX.Scale.rolesList[this.id].COLOR||"invisible";this.noActions=false;if(c!==undefined){if(c.showMenu===false){this.showMenu=false}if(c.showMenuClose===true){this.showMenuClose=true}if(c.type!==undefined){this.type=c.type}if(c.type=="norole"){this.showLoadBar=false;if(this.color!="invisible"){this.color=false}}if(c.noActions&&c.noActions===true){this.noActions=true}if(c.state){this.state=c.state}}if(this.showLoadBar){this.loadBar=new BX.Scale.LoadBar(b+"_"+d+"_lb")}else{this.loadBar=null}this.actionsIds=this.getAviableActionsList()};BX.Scale.Role.prototype.getMenuObj=function(){var b=BX.create("div",{props:{className:"adm-scale-item-menu"}});b.appendChild(BX.create("span",{props:{className:"adm-scale-item-menu-text"},html:BX.message("SCALE_PANEL_JS_MENU")}));BX.bind(b,"click",BX.proxy(this.menuOpen,this));if(this.showMenuClose){b.appendChild(BX.create("span",{props:{className:"adm-scale-item-close"}}))}return b};BX.Scale.Role.prototype.menuOpen=function(e){e=e||a.event;var b=e.target||e.srcElement,d=[];for(var c in this.actionsIds){var f=BX.Scale.actionsCollection.getObject(c);if(f){d.push({TEXT:f.name,ONCLICK:"BX.Scale.actionsCollection.getObject('"+c+"').start('"+this.hostname+"');"})}}if(!b.OPENER){BX.adminShowMenu(b,d,{active_class:"bx-adm-scale-menu-butt-active"})}else{b.OPENER.SetMenu(d)}return BX.PreventDefault(e)};BX.Scale.Role.prototype.getAviableActionsList=function(){var b={};if(!this.noActions){if(BX.Scale.rolesList[this.id]){var e=BX.Scale.rolesList[this.id],c=this.type||"notype",d;if(e.ROLE_ACTIONS&&e.ROLE_ACTIONS[c]){for(d in e.ROLE_ACTIONS[c]){if(!e.ROLE_ACTIONS[c].hasOwnProperty(d)){continue}if(!b[e.ROLE_ACTIONS[c][d]]&&BX.Scale.actionsCollection.getObject(e.ROLE_ACTIONS[c][d])){b[e.ROLE_ACTIONS[c][d]]=true}}}if(this.state&&e.STATE_ACTIONS&&e.STATE_ACTIONS[this.state]){for(d in e.STATE_ACTIONS[this.state]){if(!e.STATE_ACTIONS[this.state].hasOwnProperty(d)){continue}if(this.id=="mysql"&&this.type=="master"&&e.STATE_ACTIONS[this.state][d]=="MYSQL_STOP"){continue}if(!b[e.STATE_ACTIONS[this.state][d]]&&BX.Scale.actionsCollection.getObject(e.STATE_ACTIONS[this.state][d])){b[e.STATE_ACTIONS[this.state][d]]=true}}}}}if(BX.Scale.isObjEmpty(b)){b=null}return b};BX.Scale.Role.prototype.setLoadBarValue=function(c){var b=false;if(this.loadBar!==null){b=this.loadBar.setValue(c)}return b};BX.Scale.Role.prototype.getDomObj=function(){if(this.color=="invisible"){return null}if(!this.domObj){if(BX.Scale.rolesList[this.id]){this.domObj=document.createElement("div");this.domObj.id=this.hostname+"_"+this.id;BX.addClass(this.domObj,"adm-scale-item-block");var d=document.createElement("div");BX.addClass(d,"adm-scale-item");if(this.color){BX.addClass(d,"adm-scale-"+this.color)}var f=document.createElement("span");BX.addClass(f,"adm-scale-item-alignment");d.appendChild(f);if(this.type&&this.type!="norole"){var c=document.createElement("div");BX.addClass(c,"adm-scale-item-btn");if(BX.Scale.rolesList[this.id].TYPES&&BX.Scale.rolesList[this.id].TYPES[this.type]){c.innerHTML=BX.Scale.rolesList[this.id].TYPES[this.type]}else{c.innerHTML=this.type}d.appendChild(c)}var b=document.createElement("span");BX.addClass(b,"adm-scale-item-name");b.innerHTML=BX.Scale.rolesList[this.id].NAME;d.appendChild(b);if(this.state){d.appendChild(BX.create("span",{html:this.state,props:{className:"adm-scale-item-role-state"}}))}if(this.showMenu===true&&this.actionsIds){var e=this.getMenuObj();if(e){d.appendChild(e)}}this.domObj.appendChild(d);if(this.loadBar!==null){this.domObj.appendChild(this.loadBar.getDomObj())}}else{BX.debug("Error! Role "+this.id+" not defined")}}return this.domObj};BX.Scale.Role.prototype.getMonitoringCategories=function(d){var b={};if(BX.Scale.rolesList[this.id].MONITORING_CATEGORIES){for(var e in BX.Scale.rolesList[this.id].MONITORING_CATEGORIES){if(BX.Scale.monitoringCategories[d][BX.Scale.rolesList[this.id].MONITORING_CATEGORIES[e]]){b[BX.Scale.rolesList[this.id].MONITORING_CATEGORIES[e]]=BX.Scale.monitoringCategories[d][BX.Scale.rolesList[this.id].MONITORING_CATEGORIES[e]]}}}return b}})(window);