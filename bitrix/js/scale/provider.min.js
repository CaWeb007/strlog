(function(a){if(BX.Scale.Provider){return}BX.Scale.Provider={dialogChooseWindow:null,dialogConfigsWindow:null,getList:function(){if(this.dialogChooseWindow!==null){if(this.dialogChooseWindow==="manual"){BX.Scale.Provider.startManual()}else{this.dialogChooseWindow.Show()}return}var c={operation:"get_providers_list"};var b={onsuccess:function(d){if(d&&d.RESULT=="OK"&&d.PROVIDERS_LIST){var f=0;for(var e in d.PROVIDERS_LIST){f++}if(f>0){BX.Scale.Provider.showChooseWindow(d.PROVIDERS_LIST)}else{BX.Scale.Provider.dialogChooseWindow="manual";BX.Scale.Provider.startManual()}}else{BX.Scale.AdminFrame.alert(BX.message("SCALE_PANEL_JS_PROVIDER_LIST_ERROR"),BX.message("SCALE_PANEL_JS_PROVIDER_ERROR"))}},onfailure:function(d,f){BX.debug({type:d,error:f})}};BX.Scale.Communicator.sendRequest(c,b,this,false);return true},startManual:function(){BX.Scale.actionsCollection.getObject("NEW_SERVER_CHAIN").start("",{HOSTNAME:BX.Scale.AdminFrame.getNewServerName()})},showChooseWindow:function(d){var c="<table><tr><td>"+BX.message("SCALE_PANEL_JS_PROVIDER")+':</td><td><select id="provider_choose_select" name="provider_choose_select">';c+='<option value="manual">'+BX.message("SCALE_PANEL_JS_PROVIDER_MANUAL")+"</option>";for(var b in d){c+='<option value="'+b+'">'+b+"</option>"}c+="</select></td></tr></table>";this.dialogChooseWindow=new BX.CDialog({title:BX.message("SCALE_PANEL_JS_PROVIDER_CHOOSE"),content:c,resizable:false,height:300,width:500,buttons:[{title:BX.message("SCALE_PANEL_JS_PROVIDER_BUT_CHOOSE"),id:"admin_frame_choose_button",name:"admin_frame_choose_button",className:"adm-btn-save",action:function(){var e=BX("provider_choose_select").value;this.parentWindow.Close();if(e=="manual"){BX.Scale.Provider.startManual()}else{BX.Scale.Provider.getConfigs(e)}}},BX.CAdminDialog.btnCancel]});this.dialogChooseWindow.adjustSizeEx();this.dialogChooseWindow.Show();return true},getConfigs:function(b){var d={operation:"get_provider_configs",providerId:b};var c={onsuccess:function(e){if(e&&e.RESULT=="OK"&&e.PROVIDER_CONFIGS){BX.Scale.Provider.showConfigsWindow(b,e.PROVIDER_CONFIGS)}else{BX.Scale.AdminFrame.alert(BX.message("SCALE_PANEL_JS_PROVIDER_CONFIGS_ERROR"),BX.message("SCALE_PANEL_JS_PROVIDER_ERROR"))}},onfailure:function(f,g){BX.debug({type:f,error:g})}};BX.Scale.Communicator.sendRequest(d,c,this,false);return true},showConfigsWindow:function(b,g){var f=0,e="",d=[];e='<form id="provider_configs_form"><table class="bx-adm-scale-provider-config-table">';for(var c in g){var h=b+"_config_"+c;e+='<tr><td><input type="radio" name="provider_configs" id="'+h+'" value="'+g[c].id+'" onclick="BX(\'provider_config_choose_but\').disabled=false;"></td><td><label for="'+h+'">'+g[c].descr+"</label></td></tr>";f++}if(f>0){e+="</tr></table></form>";d.push({title:BX.message("SCALE_PANEL_JS_PROVIDER_BUT_CHOOSE"),id:"provider_config_choose_but",name:"provider_config_choose_but",className:"adm-btn-save",action:function(){var k=BX("provider_configs_form"),l="";for(var j=k.elements.length-1;j>=0;j--){if(k.elements[j].checked){l=k.elements[j].value;break}}BX.Scale.Provider.sendOrder(b,l);this.parentWindow.Close()}})}else{e=BX.message("SCALE_PANEL_JS_PROVIDER_NO_CONFIGS")}d.push(BX.CAdminDialog.btnCancel);if(this.dialogConfigsWindow==null){this.dialogConfigsWindow=new BX.CDialog({title:BX.message("SCALE_PANEL_JS_PROVIDER_CONFIG_CHOOSE"),content:e,resizable:false,height:400,width:600,buttons:d})}else{this.dialogConfigsWindow.SetContent(e)}BX("provider_config_choose_but").disabled=true;this.dialogConfigsWindow.adjustSizeEx();this.dialogConfigsWindow.Show();return true},sendOrder:function(b,e){var d={operation:"send_order_to_provider",providerId:b,configId:e};var c={onsuccess:function(f){if(f&&f.RESULT=="OK"&&f.TASK_ID){var g=BX.message("SCALE_PANEL_JS_PROVIDER_ORDER_SUCCESS").replace("##ORDER_ID##",f.TASK_ID);g=g.replace("##PROVIDER_ID##",b);BX.Scale.AdminFrame.alert(g,BX.message("SCALE_PANEL_JS_PROVIDER_ORDER_SUCCESS_TITLE"))}else{BX.Scale.AdminFrame.alert(BX.message("SCALE_PANEL_JS_PROVIDER_ORDER_ERROR"),BX.message("SCALE_PANEL_JS_PROVIDER_ERROR"))}},onfailure:function(f,g){BX.debug({type:f,error:g})}};BX.Scale.Communicator.sendRequest(d,c,this,false);return true}}})(window);