(function(a){function b(c){this.calendar=c;this.util=c.util;this.WEEK_TOP_MIN_HEIGHT=21;this.defaultBg={r:255,g:255,b:255};this.currentBg={r:250,g:250,b:250}}b.prototype={transit:function(e){var g=e.currentView,f=e.newView,d=e.currentView.getName(),c=e.newView.getName();this.currentViewDate=e.currentViewDate;this.newViewDate=e.newViewDate;if(d=="month"&&c=="week"){this.fromMonthToWeek(g,f)}else{if(d=="month"&&c=="day"){this.fromMonthToDay(g,f)}else{if(d=="month"&&c=="list"){this.fromMonthToList(g,f)}else{if(d=="week"&&c=="month"){this.fromWeekToMonth(g,f)}else{if(d=="week"&&c=="day"){this.fromWeekToDay(g,f)}else{if(d=="week"&&c=="list"){this.fromWeekToList(g,f)}else{if(d=="day"&&c=="week"){this.fromDayToWeek(g,f)}else{if(d=="day"&&c=="month"){this.fromDayToMonth(g,f)}else{if(d=="day"&&c=="list"){this.fromDayToList(g,f)}else{if(d=="list"&&c=="month"){this.fromListToMonth(g,f)}else{if(d=="list"&&c=="week"){this.fromListToWeek(g,f)}else{if(d=="list"&&c=="day"){this.fromListToDay(g,f)}}}}}}}}}}}}this.calendar.currentViewName=f.getName();if(f.switchNode){BX.addClass(f.switchNode,"calendar-view-switcher-list-item-active")}if(g.switchNode){BX.removeClass(g.switchNode,"calendar-view-switcher-list-item-active")}},fromMonthToWeek:function(t,l){var q=this,f=255,g=255,c=255,r=234,o=249,d=254,k=100,j=310,i=100;l.viewCont.style.opacity=0;l.show();BX.removeClass(l.grid,"calendar-events-holder-show");BX.removeClass(l.fullDayEventsCont,"calendar-events-holder-show");BX.removeClass(t.gridMonthContainer,"calendar-events-holder-show");this.calendar.viewsCont.style.overflow="hidden";var e=parseInt(l.fullDayEventsCont.style.height)||this.WEEK_TOP_MIN_HEIGHT,h=BX.pos(l.viewCont),n=t.monthRows.length,s=this.util.getDayCode(this.newViewDate),m=Math.ceil((t.dayIndex[s]+1)/t.dayCount)-1;if(!t.monthRows[m]){m=0}var p=t.monthRows[m].querySelectorAll(".calendar-grid-cell-inner");l.viewCont.style.display="block";l.viewCont.style.position="absolute";l.viewCont.style.top=0;l.viewCont.style.left=0;l.viewCont.style.width=h.width+"px";l.viewCont.style.height=h.height+"px";l.viewCont.style.zIndex=100;t.gridWrap.style.overflow="hidden";t.gridWrap.style.height=BX.pos(l.gridWrap).height+"px";l.outerGrid.style.paddingLeft=0;l.fullDayEventsCont.style.height=0;l.titleCont.style.paddingLeft=0;BX.addClass(t.viewCont,"calendar-animate-mod");this.firstStage=new BX.easing({duration:k,start:{red:f,green:g,blue:c},finish:{red:r,green:o,blue:d},step:function(v){t.monthRows[m].style.background="rgb("+v.red+","+v.green+","+v.blue+")";for(var u=0;u<p.length;u++){p[u].style.background="rgb("+v.red+","+v.green+","+v.blue+")"}},complete:function(){setTimeout(function(){BX.addClass(t.viewCont,"calendar-change-animate-month-to-week");BX.removeClass(t.gridMonthContainer,"calendar-events-holder-show");for(var u=0;u<n;u++){if(u!=m){t.monthRows[u].style.height=0;if((u+1)<m){t.monthRows[u].style.borderBottom="none"}}else{t.monthRows[u].style.height=BX.pos(l.outerGrid).height+"px"}}setTimeout(function(){q.secontStage.animate()},50)},100)}});this.secontStage=new BX.easing({duration:j,start:{fadeShow:0,fadeHide:100},finish:{fadeShow:100,fadeHide:0},step:function(u){t.viewCont.style.opacity=u.fadeHide/100;l.viewCont.style.opacity=u.fadeShow/100},complete:BX.delegate(function(){this.thirdStage.animate();BX.addClass(l.grid,"calendar-events-holder-show");BX.addClass(l.fullDayEventsCont,"calendar-events-holder-show")},this)});this.thirdStage=new BX.easing({duration:i,start:{paddingLeft:0,topHolderHeight:0},finish:{paddingLeft:43,topHolderHeight:e},step:function(u){l.outerGrid.style.paddingLeft=u.paddingLeft+"px";l.titleCont.style.paddingLeft=u.paddingLeft+"px";l.fullDayEventsCont.style.height=u.topHolderHeight+"px"},complete:BX.delegate(function(){l.titleCont.style.paddingLeft="";t.gridMonthContainer.style.paddingLeft="";t.monthRows[m].style.background="";BX.removeClass(t.viewCont,"calendar-change-animate-month-to-week");this.adjustViewAnimate(t,l)},this)});this.firstStage.animate()},fromMonthToDay:function(j,i){j.viewCont.style.width=j.viewCont.offsetWidth+"px";i.viewCont.style.opacity=0;i.viewCont.style.zIndex=110;i.show();j.viewCont.style.position="absolute";j.viewCont.style.top=0;j.viewCont.style.left=0;var q=this.util.getDayCode(this.newViewDate);if(j.dayIndex[q]!==undefined&&j.days[j.dayIndex[q]]){var l=j.days[j.dayIndex[q]];var e=255,f=255,n=255,m=234,p=249,o=254,d=300,c=200,h=BX.pos(l.node),k=BX.pos(j.gridWrap),g=document.body.appendChild(BX.create("DIV",{props:{className:"calendar-animate-casper-day"},style:{top:h.top+"px",right:h.right+"px",bottom:h.bottom+"px",left:h.left+"px",height:h.height+"px",width:h.width+"px"}}));this.firstStage=new BX.easing({duration:d,start:{top:h.top,right:h.right,bottom:h.bottom,left:h.left,height:h.height,width:h.width,dayRed:e,dayGreen:f,dayBlue:n},finish:{top:k.top,right:k.right,bottom:k.bottom,left:k.left,height:k.height,width:k.width,dayRed:m,dayGreen:p,dayBlue:o},step:function(r){g.style.top=r.top+"px";g.style.right=r.right+"px";g.style.bottom=r.bottom+"px";g.style.left=r.left+"px";g.style.height=r.height+"px";g.style.width=r.width+"px";g.style.background="rgb("+r.dayRed+","+r.dayGreen+","+r.dayBlue+")"},complete:BX.delegate(function(){this.secondStage.animate();j.viewCont.style.opacity=0},this)});this.secondStage=new BX.easing({duration:c,start:{hide:100,show:0},finish:{hide:0,show:100},step:function(r){i.viewCont.style.opacity=r.show/100;g.style.opacity=r.hide/100},complete:BX.delegate(function(){BX.addClass(this.calendar.mainCont,"calendar-main-container-small-calendar");BX.remove(g);this.adjustViewAnimate(j,i)},this)});this.firstStage.animate()}},fromMonthToList:function(d,c){BX.addClass(this.calendar.mainCont,"calendar-main-container-small-calendar");c.show();this.adjustViewAnimate(d,c)},fromWeekToMonth:function(o,v){var t,s=this,f=255,j=255,c=255,d=234,u=249,h=254,n=100,m=75,l=75;v.viewCont.style.opacity=0;v.show();BX.removeClass(o.grid,"calendar-events-holder-show");BX.removeClass(o.fullDayEventsCont,"calendar-events-holder-show");BX.removeClass(v.gridMonthContainer,"calendar-events-holder-show");this.calendar.viewsCont.style.overflow="hidden";v.viewCont.style.display="block";var r=BX.pos(v.viewCont);v.viewCont.style.position="absolute";v.viewCont.style.top=0;v.viewCont.style.left=0;v.viewCont.style.width=r.width+"px";v.viewCont.style.height=r.height+"px";v.viewCont.style.zIndex=100;var k=this.util.getDayCode(this.currentViewDate),q=Math.ceil((v.dayIndex[k]+1)/v.dayCount)-1,g=o.outerGrid.querySelectorAll(".calendar-grid-cell-inner"),p=v.monthRows.length;if(!v.monthRows[q]){q=0}var e=v.monthRows[q].querySelectorAll(".calendar-grid-cell-inner");BX.addClass(o.viewCont,"calendar-change-animate-week-to-month");for(t=0;t<e.length;t++){e[t].style.background="rgb("+d+","+u+","+h+")"}for(t=0;t<p;t++){v.monthRows[t].style.height=(t!=q)?0:BX.pos(o.outerGrid).height+"px"}BX.addClass(o.viewCont,"calendar-animate-mod");BX.addClass(v.viewCont,"calendar-animate-mod");this.firstStage=new BX.easing({duration:n,start:{topHolderHeight:parseInt(o.fullDayEventsCont.style.height)||0,paddingLeft:43,fadeHide:100,red:f,green:j,blue:c},finish:{topHolderHeight:0,paddingLeft:0,fadeHide:0,red:d,green:u,blue:h},step:function(i){for(t=0;t<g.length;t++){g[t].style.background="rgb("+i.red+","+i.green+","+i.blue+")"}o.timeLinesCont.style.opacity=i.fadeHide/100;o.outerGrid.style.paddingLeft=i.paddingLeft+"px";o.titleCont.style.paddingLeft=i.paddingLeft+"px";o.fullDayEventsCont.style.height=i.topHolderHeight+"px"},complete:function(){setTimeout(function(){v.viewCont.style.opacity=1;o.viewCont.style.opacity=0;s.secondStage.animate()},100)}});this.secondStage=new BX.easing({duration:m,start:{fadeHide:100},finish:{fadeHide:0},step:function(i){o.viewCont.style.opacity=i.fadeHide/100},complete:function(){for(t=0;t<p;t++){v.monthRows[t].style.height=v.rowHeight+"px"}setTimeout(function(){BX.addClass(v.gridMonthContainer,"calendar-events-holder-show");s.thirdStage.animate()},410)}});this.thirdStage=new BX.easing({duration:l,start:{red:d,green:u,blue:h},finish:{red:f,green:j,blue:c},step:function(i){for(t=0;t<e.length;t++){e[t].style.background="rgb("+i.red+","+i.green+","+i.blue+")"}},complete:BX.delegate(function(){o.outerGrid.style.paddingLeft="";o.titleCont.style.paddingLeft="";o.fullDayEventsCont.style.height="";o.viewCont.style.opacity=0;for(t=0;t<g.length;t++){g[t].style.background=""}for(t=0;t<e.length;t++){e[t].style.background=""}BX.removeClass(o.viewCont,"calendar-change-animate-week-to-month");this.adjustViewAnimate(o,v)},this)});this.firstStage.animate()},fromWeekToDay:function(g,l){l.viewCont.style.opacity=0;l.show();l.viewCont.style.display="block";var r=BX.pos(l.viewCont);l.viewCont.style.position="absolute";l.viewCont.style.top="0px";l.viewCont.style.left="0px";l.viewCont.style.width=r.width+"px";l.viewCont.style.height=r.height+"px";l.viewCont.style.zIndex="100";this.calendar.viewsCont.style.overflow="hidden";BX.removeClass(g.grid,"calendar-events-holder-show");BX.removeClass(g.fullDayEventsCont,"calendar-events-holder-show");BX.removeClass(l.grid,"calendar-events-holder-show");BX.removeClass(l.fullDayEventsCont,"calendar-events-holder-show");var i=255,j=255,p=255,n=234,k=249,c=254,q=this.util.getDayCode(this.newViewDate),o=g.days[g.dayIndex[q]],h=75,f=310,m=g.titleCont.children.length;if(!o){o=g.days[this.util.getWeekDayOffset(this.util.getWeekDayByInd(this.newViewDate.getDay()))]}BX.addClass(g.viewCont,"calendar-animate-mod");var e=new BX.easing({duration:h,start:{topHolderHeight:parseInt(g.fullDayEventsCont.style.height)||this.WEEK_TOP_MIN_HEIGHT,red:i,green:j,blue:p},finish:{topHolderHeight:this.WEEK_TOP_MIN_HEIGHT,red:n,green:k,blue:c},step:function(s){o.node.style.background="rgb("+s.red+","+s.green+","+s.blue+")";g.fullDayEventsCont.style.height=s.topHolderHeight+"px";if(g.titleCont.children[o.dayOffset]){g.titleCont.children[o.dayOffset].style.background="rgb("+s.red+","+s.green+","+s.blue+")"}},complete:function(){setTimeout(function(){BX.addClass(g.viewCont,"calendar-change-animate-week-to-day");BX.removeClass(g.gridMonthContainer,"calendar-events-holder-show");for(var s=0;s<m;s++){if(s!=o.dayOffset){g.gridRow.children[s].style.flex=0;g.titleCont.children[s].style.flex=0}}setTimeout(function(){d.animate();BX.addClass(l.grid,"calendar-events-holder-show");BX.addClass(l.fullDayEventsCont,"calendar-events-holder-show")},210)},150)}});var d=new BX.easing({duration:f,start:{fadeShow:0,fadeHide:100},finish:{fadeShow:100,fadeHide:0},step:function(s){g.viewCont.style.opacity=s.fadeHide/100;l.viewCont.style.opacity=s.fadeShow/100},complete:BX.delegate(function(){o.node.style.background="";if(g.titleCont.children[o.dayOffset]){g.titleCont.children[o.dayOffset].style.background=""}BX.addClass(this.calendar.mainCont,"calendar-main-container-small-calendar");this.adjustViewAnimate(g,l)},this)});e.animate()},fromWeekToList:function(c,d){BX.addClass(this.calendar.mainCont,"calendar-main-container-small-calendar");d.show();this.adjustViewAnimate(c,d)},fromDayToMonth:function(g,h){BX.removeClass(this.calendar.mainCont,"calendar-main-container-small-calendar");var n=g.days[0].dayCode,e=255,f=255,k=255,j=234,m=249,l=254,i,d=250,c=300;this.firstStage=BX.delegate(function(){h.viewCont.style.opacity=0;h.viewCont.style.zIndex=110;h.show();h.viewCont.style.width=g.viewCont.offsetWidth+"px";h.viewCont.style.position="absolute";h.viewCont.style.top=0;h.viewCont.style.left=0;var o=h.days[h.dayIndex[n]],q=BX.pos(o.node),p=BX.pos(h.gridWrap),r=document.body.appendChild(BX.create("DIV",{props:{className:"calendar-animate-casper-day"},style:{opacity:0,top:p.top+"px",right:p.right+"px",bottom:p.bottom+"px",left:p.left+"px",height:p.height+"px",width:p.width+"px",background:"#000"}}));this.secondStage=new BX.easing({duration:d,start:{hide:100,show:0,dayRed:e,dayGreen:f,dayBlue:k},finish:{hide:0,show:100,dayRed:j,dayGreen:m,dayBlue:l},step:function(s){g.viewCont.style.opacity=s.hide/100;r.style.opacity=s.show/100;r.style.background="rgb("+s.dayRed+","+s.dayGreen+","+s.dayBlue+")"},complete:BX.delegate(function(){h.viewCont.style.opacity=1;this.thirdStage.animate()},this)});this.thirdStage=new BX.easing({duration:c,start:{top:p.top,right:p.right,bottom:p.bottom,left:p.left,height:p.height,width:p.width,dayRed:j,dayGreen:m,dayBlue:l},finish:{top:q.top,right:q.right,bottom:q.bottom,left:q.left,height:q.height,width:q.width,dayRed:e,dayGreen:f,dayBlue:k},step:function(s){r.style.show=s.top+"px";r.style.top=s.top+"px";r.style.right=s.right+"px";r.style.bottom=s.bottom+"px";r.style.left=s.left+"px";r.style.height=s.height+"px";r.style.width=s.width+"px";r.style.background="rgb("+s.dayRed+","+s.dayGreen+","+s.dayBlue+")"},complete:BX.delegate(function(){BX.remove(r);this.adjustViewAnimate(g,h)},this)});this.secondStage.animate()},this);setTimeout(BX.delegate(this.firstStage,this),300)},fromDayToWeek:function(j,e){BX.removeClass(this.calendar.mainCont,"calendar-main-container-small-calendar");var g=255,h=255,l=255,k=234,i=249,c=254,f=100,d=100;setTimeout(BX.delegate(function(){e.viewCont.style.opacity=0;e.show();e.viewCont.style.display="block";var s=parseInt(e.fullDayEventsCont.style.height)||this.WEEK_TOP_MIN_HEIGHT,q=BX.pos(e.viewCont);e.viewCont.style.position="absolute";e.viewCont.style.top=0;e.viewCont.style.left=0;e.viewCont.style.width=q.width+"px";e.viewCont.style.height=q.height+"px";e.viewCont.style.zIndex=100;e.fullDayEventsCont.style.height=this.WEEK_TOP_MIN_HEIGHT+"px";this.calendar.viewsCont.style.overflow="hidden";BX.removeClass(e.grid,"calendar-events-holder-show");BX.removeClass(e.fullDayEventsCont,"calendar-events-holder-show");BX.removeClass(j.grid,"calendar-events-holder-show");BX.removeClass(j.fullDayEventsCont,"calendar-events-holder-show");var o=this.util.getDayCode(this.currentViewDate),n=e.days[e.dayIndex[o]],t=e.titleCont.children.length;if(!n){o=this.util.getDayCode(this.newViewDate);n=e.days[e.dayIndex[o]]}n.node.style.background="rgb("+k+","+i+","+c+")";if(e.titleCont.children[n.dayOffset]){e.titleCont.children[n.dayOffset].style.background="rgb("+k+","+i+","+c+")"}BX.addClass(j.viewCont,"calendar-change-animate-day-to-week");for(var p=0;p<t;p++){if(p!=n.dayOffset){e.gridRow.children[p].style.flex=0;e.titleCont.children[p].style.flex=0}}var m=new BX.easing({duration:f,start:{topHolderHeight:parseInt(j.fullDayEventsCont.style.height)||this.WEEK_TOP_MIN_HEIGHT,topPadding:10,red:g,green:h,blue:l},finish:{topHolderHeight:this.WEEK_TOP_MIN_HEIGHT,topPadding:0,red:k,green:i,blue:c},step:function(u){j.fullDayEventsCont.style.height=u.topHolderHeight+"px";j.outerGrid.children[0].style.background="rgb("+u.red+","+u.green+","+u.blue+")";j.viewCont.style.paddingTop=u.topPadding+"px"},complete:BX.delegate(function(){BX.removeClass(j.viewCont,"calendar-animate-mod");setTimeout(function(){j.outerGrid.children[0].style.background="";e.viewCont.style.opacity=1;BX.addClass(e.viewCont,"calendar-animate-mod");for(var u=0;u<t;u++){e.gridRow.children[u].style.flex=1;e.titleCont.children[u].style.flex=1}setTimeout(function(){r.animate()},310)},100)},this)});var r=new BX.easing({duration:d,start:{fadeHide:100,topHolderHeight:this.WEEK_TOP_MIN_HEIGHT,red:k,green:i,blue:c},finish:{fadeHide:0,topHolderHeight:s,red:g,green:h,blue:l},step:function(u){j.viewCont.style.opacity=u.fadeHide/100;e.fullDayEventsCont.style.height=u.topHolderHeight+"px";n.node.style.background="rgb("+u.red+","+u.green+","+u.blue+")";if(e.titleCont.children[n.dayOffset]){e.titleCont.children[n.dayOffset].style.background="rgb("+u.red+","+u.green+","+u.blue+")"}},complete:BX.delegate(function(){j.outerGrid.children[0].style.background="";if(e.titleCont.children[n.dayOffset]){e.titleCont.children[n.dayOffset].style.background=""}n.node.style.background="";BX.removeClass(j.viewCont,"calendar-change-animate-day-to-week");BX.addClass(e.grid,"calendar-events-holder-show");BX.addClass(e.fullDayEventsCont,"calendar-events-holder-show");this.adjustViewAnimate(j,e)},this)});m.animate()},this),200)},fromDayToList:function(d,c){c.show();this.adjustViewAnimate(d,c)},fromListToMonth:function(d,f){var e=300,c=350;BX.removeClass(f.gridMonthContainer,"calendar-events-holder-show");BX.removeClass(this.calendar.mainCont,"calendar-main-container-small-calendar");setTimeout(BX.delegate(function(){f.viewCont.style.opacity=0;f.show();var g=BX.pos(f.viewCont);f.viewCont.style.display="block";f.viewCont.style.overflow="hidden";f.viewCont.style.position="absolute";f.viewCont.style.top=0;f.viewCont.style.left=0;f.viewCont.style.width=g.width+"px";f.viewCont.style.height=g.height+"px";f.viewCont.style.zIndex=100;this.calendar.viewsCont.style.overflow="hidden";this.firstStage.animate()},this),e);this.firstStage=new BX.easing({duration:c,start:{fadeShow:0,fadeHide:100},finish:{fadeShow:100,fadeHide:0},step:function(g){d.viewCont.style.opacity=g.fadeHide/100;f.viewCont.style.opacity=g.fadeShow/100},complete:BX.delegate(function(){this.adjustViewAnimate(d,f)},this)})},fromListToWeek:function(e,c){var f=300,d=350;BX.removeClass(c.gridMonthContainer,"calendar-events-holder-show");BX.removeClass(this.calendar.mainCont,"calendar-main-container-small-calendar");setTimeout(BX.delegate(function(){c.viewCont.style.opacity=0;c.show();var g=BX.pos(c.viewCont);c.viewCont.style.display="block";c.viewCont.style.overflow="hidden";c.viewCont.style.position="absolute";c.viewCont.style.top=0;c.viewCont.style.left=0;c.viewCont.style.width=g.width+"px";c.viewCont.style.height=g.height+"px";c.viewCont.style.zIndex=100;this.calendar.viewsCont.style.overflow="hidden";this.firstStage.animate()},this),f);this.firstStage=new BX.easing({duration:d,start:{fadeShow:0,fadeHide:100},finish:{fadeShow:100,fadeHide:0},step:function(g){e.viewCont.style.opacity=g.fadeHide/100;c.viewCont.style.opacity=g.fadeShow/100},complete:BX.delegate(function(){this.adjustViewAnimate(e,c)},this)})},fromListToDay:function(c,d){d.show();this.adjustViewAnimate(c,d)},adjustViewAnimate:function(d,c){this.calendar.viewsCont.style.cssText="";c.viewCont.style.cssText="";d.viewCont.style.cssText="";BX.removeClass(d.viewCont,"calendar-animate-mod");BX.removeClass(c.viewCont,"calendar-animate-mod");d.viewCont.style.display="none";BX.addClass(c.gridMonthContainer,"calendar-events-holder-show");if(c.getName()!=this.calendar.currentViewName){d.hide()}},getRgb:function(){}};if(a.BXEventCalendar){a.BXEventCalendar.ViewTransition=b}else{BX.addCustomEvent(a,"onBXEventCalendarInit",function(){a.BXEventCalendar.ViewTransition=b})}})(window);