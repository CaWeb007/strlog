(function(b){var c=b.BXEventCalendarView;function a(){c.apply(this,arguments);this.name="list";this.filterMode=false;this.title=BX.message("EC_VIEW_LIST");this.hotkey="A";this.contClassName="calendar-list-view";this.loadDaysBefore=30;this.animateAmount=5;this.loadLimitPrevious=5;this.loadLimit=15;this.loadDaysAfter=60;this.SCROLL_DELTA_HEIGHT=200;this.todayCode=this.calendar.util.getDayCode(new Date());this.DOM={};this.preBuild()}a.prototype=Object.create(c.prototype);a.prototype.constructor=a;a.prototype.preBuild=function(){this.viewCont=BX.create("DIV",{props:{className:this.contClassName},style:{display:"none"}});BX.addCustomEvent(this.calendar,"afterSetView",BX.delegate(function(d){if(d.viewName!==this.name&&this.filterMode){this.resetFilterMode()}},this))};a.prototype.build=function(){this.titleCont=this.viewCont.appendChild(BX.create("DIV",{props:{className:"calendar-grid-month-row-days-week"}}));this.streamScrollWrap=this.viewCont.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-container calendar-custom-scroll"},style:{height:this.util.getViewHeight()+"px"},events:{scroll:BX.proxy(this.scrollHandle,this)}}));this.streamContentWrap=this.streamScrollWrap.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-container-content"}}));this.topLoaderBlock=this.streamContentWrap.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-loader-block"}}));this.listWrap=this.streamContentWrap.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-container-list"}}));this.bottomLoaderBlock=this.streamContentWrap.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-loader-block"}}));this.centerLoaderWrap=this.streamScrollWrap.appendChild(BX.create("DIV",{props:{className:"calendar-center-loader-block"}}));this.filterLoaderWrap=this.streamScrollWrap.appendChild(BX.create("DIV",{props:{className:"calendar-search-main"},style:{height:this.util.getViewHeight()+"px",display:"none"}}));this.filterLoaderWrap.appendChild(BX.create("DIV",{props:{className:"calendar-search-empty"},html:'<div class="calendar-search-empty-name">'+BX.message("EC_NO_EVENTS")+"</div>"}))};a.prototype.setTitle=function(){var d=this.calendar.getViewRangeDate();c.prototype.setTitle.apply(this,[BX.date.format("f",d.getTime()/1000)+", #GRAY_START#"+d.getFullYear()+"#GRAY_END#"])};a.prototype.show=function(f){if(!f){f={}}c.prototype.show.apply(this,arguments);this.showNavigationCalendar();BX.remove(this.calendar.additionalInfoOuter);var e=parseInt(this.calendar.util.config.init_year),d=parseInt(this.calendar.util.config.init_month);this.displayedRange={start:new Date(e,d-2,1),end:new Date(e,d+2,1)};this.calendar.setDisplayedViewRange(this.displayedRange);if(f.displayEntries!==false){this.displayEntries()}this.nothingToLoadNext=false;this.nothingToLoadPrevious=false};a.prototype.displayEntries=function(d){d=d||{};this.entries=this.entryController.getList({startDate:this.displayedRange.start,finishDate:this.displayedRange.end,viewRange:this.displayedRange,finishCallback:function(){if(this.entiesRequested===true){this.displayEntries(d)}this.entiesRequested=false}.bind(this)});this.entiesRequested=true;BX.cleanNode(this.listWrap);this.dateGroupIndex={};this.groups=[];this.groupsDayCodes=[];this.groupsIndex={};this.entryListIndex={};if(this.entries===false||!this.entries||!this.entries.length){return this.showEmptyBlock()}else{if(this.noEntriesWrap){this.noEntriesWrap.style.display="none"}}this.streamContentWrap.style.display="";this.entryParts=[];this.centerLoaderWrap.appendChild(BX.adjust(this.calendar.util.getLoader(),{style:{height:"180px"}}));this.attachEntries(this.entries,!!d.animation,function(){this.focusOnDate(d.focusDate||null)}.bind(this),d.focusDate)};a.prototype.displayResult=function(d){this.streamContentWrap.style.display="";if(this.filterLoaderWrap){this.filterLoaderWrap.style.display="none"}BX.addClass(this.streamContentWrap,"calendar-timeline-stream-search-result");BX.cleanNode(this.listWrap);this.dateGroupIndex={};this.entiesRequested=null;this.groups=[];this.groupsDayCodes=[];this.groupsIndex={};this.entryListIndex={};this.resultEntries=d;this.resultEntriesIndex={};d.forEach(function(f,e){this.resultEntriesIndex[f.uid]=e},this);if(d===false||!d||!d.length){return this.showEmptyBlock()}else{if(this.noEntriesWrap){this.noEntriesWrap.style.display="none"}}this.streamContentWrap.style.display="";this.entryParts=[];this.attachEntries(d,"next")};a.prototype.attachEntries=function(i,f,d,g){if(!i&&!i.length){return}var e=this.entries.length-i.length,n=e,m,j,k,h;i.forEach(function(o){o.globalIndex=n++;k=this.calendar.util.getDayCode(o.from);h=this.calendar.util.getDayCode(o.to);j=0;this.entryParts.push({index:j,dayCode:k,from:o.from,entry:o});if(k!==h){m=new Date(o.from.getTime()+this.calendar.util.dayLength);while(m.getTime()<o.to.getTime()){this.entryParts.push({index:++j,dayCode:this.calendar.util.getDayCode(m),from:m,entry:o});m=new Date(m.getTime()+this.calendar.util.dayLength)}o.lastPartIndex=j}},this);var l=false;this.entryParts.sort(function(p,o){if(p.dayCode===o.dayCode){if(p.entry.isTask()!==o.entry.isTask()){if(p.entry.isTask()){return 1}if(o.entry.isTask()){return -1}}if(p.entry.isFullDay()!==o.entry.isFullDay()){if(p.entry.isFullDay()){return -1}if(o.entry.isFullDay()){return 1}}}if(p.index>0||o.index>0){return !l?p.index-o.index:o.index-p.index}return !l?p.entry.from.getTime()-o.entry.from.getTime():o.entry.from.getTime()-p.entry.from.getTime()});this.focusDate=g||new Date();this.today=new Date();this.animationMode=f;this.currentDisplayedEntry=0;this.actuallyAnimatedEntryCount=0;this.displayEntry(this.entryParts[this.currentDisplayedEntry],f,d)};a.prototype.displayEntry=function(h,i,f){i=false;var o;var j=this.calendar.util.getDayCode(this.focusDate);if(h.from.getTime()>this.focusDate.getTime()&&!this.groups[this.groupsIndex[j]]&&!this.filterMode){this.createEntryGroupForDate(this.focusDate,i)}o=this.groups[this.groupsIndex[h.dayCode]];if(!o){this.createEntryGroupForDate(h.from,i);o=this.groups[this.groupsIndex[h.dayCode]]}if(o.emptyWarning){BX.remove(o.emptyWarning)}var k=this.getUniqueId(h);if(this.actuallyAnimatedEntryCount>this.animateAmount){i=false;this.animationMode=false}var n=!this.entryListIndex[k];if(n){this.entryListIndex[k]=true;var g,e,d,m=h.entry;this.entriesIndex[m.uid]=m.globalIndex;if(m.isFullDay()){g=BX.message("EC_ALL_DAY")}else{if(m.isLongWithTime()){if(h.index===0){g=this.calendar.util.formatTime(m.from)}else{if(h.index===m.lastPartIndex){g=BX.message("EC_TILL_TIME").replace("#TIME#",this.calendar.util.formatTime(m.to))}else{g=BX.message("EC_ALL_DAY")}}}else{g=this.calendar.util.formatTime(m.from.getHours(),m.from.getMinutes())+" &ndash; "+this.calendar.util.formatTime(m.to.getHours(),m.to.getMinutes())}}e=o.content.appendChild(BX.create("DIV",{attrs:{"data-bx-calendar-entry":m.uid},props:{className:"calendar-timeline-stream-content-event"+(i?" calendar-timeline-stream-section-event-animate-"+i:"")}}));e.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-content-event-time"},html:'<span class="calendar-timeline-stream-content-event-time-link">'+g+"</span>"}));var l=this.calendar.util.getTextLocation(m.location)||"";if(l){l='<span class="calendar-timeline-stream-content-event-location">('+BX.util.htmlspecialchars(l)+")</span>"}e.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-content-event-name"},html:'<span class="calendar-timeline-stream-content-event-color" style="background-color: '+m.color+'"></span><span class="calendar-timeline-stream-content-event-name-link">'+BX.util.htmlspecialchars(m.name)+"</span>"+l}));d=e.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-content-event-members"}}));if(m.isMeeting()&&m.getAttendees().length>0){this.showAttendees(d,m.getAttendees().filter(function(p){return p.STATUS==="Y"||p.STATUS==="H"}),m.getAttendees().length)}else{if(m.isPersonal()){d.innerHTML=BX.message("EC_EVENT_IS_MINE")}}h.DOM={};if(h.dayCode===j&&BX.type.isFunction(f)){f()}}if(this.currentDisplayedEntry<this.entryParts.length-1){this.currentDisplayedEntry++;if(i&&n){this.actuallyAnimatedEntryCount++;setTimeout(BX.delegate(function(){this.displayEntry(this.entryParts[this.currentDisplayedEntry],i,f)},this),300)}else{if(this.currentDisplayedEntry%30==0){setTimeout(BX.delegate(function(){this.displayEntry(this.entryParts[this.currentDisplayedEntry],i,f)},this),1000)}else{this.displayEntry(this.entryParts[this.currentDisplayedEntry],i,f)}}}else{if(this.currentDisplayedEntry==this.entryParts.length-1&&!this.filterMode){this.animationMode=false;if(!this.groups[this.groupsIndex[this.todayCode]]){this.createEntryGroupForDate(this.today,i)}this.groupsDayCodes.sort();if(BX.type.isFunction(f)){f()}}}};a.prototype.showAttendees=function(e,d,m){var h,g,j=5,l=d.length,k=7;if(l>0){if(l>k){l=j}for(h=0;h<l;h++){g=d[h]||{};e.appendChild(BX.create("IMG",{attrs:{id:"simple_view_popup_"+g.USER_ID,src:g.AVATAR||""},props:{title:g.DISPLAY_NAME,className:"calendar-member"}}));(function(i){setTimeout(function(){BX.tooltip(i,"simple_view_popup_"+i)},100)})(g.USER_ID)}if(l<d.length){var f=e.appendChild(BX.create("SPAN",{props:{className:"calendar-member-more-count"},text:" "+BX.message("EC_ATTENDEES_MORE").replace("#COUNT#",d.length-l),events:{click:BX.delegate(function(){this.showUserListPopup(f,d)},this)}}))}}};a.prototype.showUserListPopup=function(e,d){if(this.userListPopup){this.userListPopup.close()}if(this.popup){this.popup.setAutoHide(false)}if(!d||!d.length){return}this.DOM.userListPopupWrap=BX.create("DIV",{props:{className:"calendar-user-list-popup-block"}});d.forEach(function(f){var g=this.DOM.userListPopupWrap.appendChild(BX.create("DIV",{props:{className:"calendar-slider-sidebar-user-container calendar-slider-sidebar-user-card"}}));g.appendChild(BX.create("DIV",{props:{className:"calendar-slider-sidebar-user-block-avatar"}})).appendChild(BX.create("DIV",{props:{className:"calendar-slider-sidebar-user-block-item"}})).appendChild(BX.create("IMG",{props:{width:34,height:34,src:f.AVATAR}}));g.appendChild(BX.create("DIV",{props:{className:"calendar-slider-sidebar-user-info"}})).appendChild(BX.create("A",{props:{href:f.URL?f.URL:"#",className:"calendar-slider-sidebar-user-info-name"},text:f.DISPLAY_NAME}))},this);this.userListPopup=new BX.PopupWindow(this.calendar.id+"-view-user-list-popup",e,{autoHide:true,closeByEsc:true,offsetTop:0,offsetLeft:0,width:220,resizable:false,lightShadow:true,content:this.DOM.userListPopupWrap,className:"calendar-user-list-popup",zIndex:4000});this.userListPopup.setAngle({offset:36});this.userListPopup.show();BX.addCustomEvent(this.userListPopup,"onPopupClose",BX.delegate(function(){this.popup.setAutoHide(true);this.userListPopup.destroy()},this))};a.prototype.appendDateGroup=function(e,f,i){var o,g,k,q,p,h,n=f.getDate(),j=f.getMonth()+1,l=f.getFullYear();if(!this.dateGroupIndex[l]){q=Infinity;p=l;for(o in this.dateGroupIndex){if(this.dateGroupIndex.hasOwnProperty(o)){if(Math.abs(l-o)<q){q=Math.abs(l-o);p=o}if(q==1){break}}}this.dateGroupIndex[l]={node:BX.create("DIV",{attrs:{"data-bx-calendar-list-year":l}}),monthIndex:{}};if(p==l){this.listWrap.appendChild(this.dateGroupIndex[l].node)}else{if(l-p>0){if(this.dateGroupIndex[p].node.nextSibling){BX.insertAfter(this.dateGroupIndex[l].node,this.dateGroupIndex[p].node)}else{this.listWrap.appendChild(this.dateGroupIndex[l].node)}}else{this.listWrap.insertBefore(this.dateGroupIndex[l].node,this.dateGroupIndex[p].node)}}}if(!this.dateGroupIndex[l].monthIndex[j]){q=Infinity;p=j;for(g in this.dateGroupIndex[l].monthIndex){if(this.dateGroupIndex[l].monthIndex.hasOwnProperty(g)){if(Math.abs(j-g)<q){q=Math.abs(j-g);p=g}if(q==1){break}}}this.dateGroupIndex[l].monthIndex[j]={node:BX.create("DIV",{attrs:{"data-bx-calendar-list-month":j}}),dayIndex:{}};if(p==j){this.dateGroupIndex[l].node.appendChild(this.dateGroupIndex[l].monthIndex[j].node)}else{if(j-p>0){if(this.dateGroupIndex[l].monthIndex[p].node.nextSibling){BX.insertAfter(this.dateGroupIndex[l].monthIndex[j].node,this.dateGroupIndex[l].monthIndex[p].node)}else{this.dateGroupIndex[l].node.appendChild(this.dateGroupIndex[l].monthIndex[j].node)}}else{this.dateGroupIndex[l].monthIndex[p].node.parentNode.insertBefore(this.dateGroupIndex[l].monthIndex[j].node,this.dateGroupIndex[l].monthIndex[p].node)}}}if(!this.dateGroupIndex[l].monthIndex[j].dayIndex[n]){q=Infinity;p=n;h=this.dateGroupIndex[l].monthIndex;for(k in h[j].dayIndex){if(h[j].dayIndex.hasOwnProperty(k)){if(Math.abs(n-k)<q){q=Math.abs(n-k);p=k}if(q==1){break}}}h[j].dayIndex[n]={node:BX.create("DIV",{props:{className:"calendar-timeline-stream-day"},attrs:{"data-bx-calendar-list-day":n}})};if(p==n){h[j].node.appendChild(h[j].dayIndex[n].node)}else{if(n-p>0){if(h[j].dayIndex[p].node.nextSibling){BX.insertAfter(h[j].dayIndex[n].node,h[j].dayIndex[p].node)}else{h[j].node.appendChild(h[j].dayIndex[n].node)}}else{h[j].node.insertBefore(h[j].dayIndex[n].node,h[j].dayIndex[p].node)}}}if(h[j].dayIndex[n].node){h[j].dayIndex[n].node.appendChild(e)}else{}setTimeout(function(){e.style.opacity="1"},0)};a.prototype.hide=function(){c.prototype.hide.apply(this,arguments)};a.prototype.getAdjustedDate=function(e,d){if(!e){e=new Date()}var f=this.calendar.getViewRangeDate(),g=false;if(e&&e.getTime){g=new Date(e.getTime())}return g};a.prototype.adjustViewRangeToDate=function(f,d){if(this.viewCont.style.display==="none"){var h=false;if(f&&f.getTime){h=new Date(f.getTime());h.setHours(0,0,0,0);this.currentDate=h;this.calendar.setViewRangeDate(h)}if(d!==false){this.fadeAnimation(this.getContainer(),100,BX.delegate(function(){this.show();this.getContainer().style.opacity=0;this.showAnimation(this.getContainer(),300)},this))}else{this.show()}}else{var e=this.calendar.util.getDayCode(f);var g=BX.util.array_search(e,this.groupsDayCodes);if(g>=0&&this.groupsDayCodes[g]){this.focusOnDate(this.groupsDayCodes[g],true)}else{if(f.getTime()>=this.displayedRange.start.getTime()&&f.getTime()<=this.displayedRange.end.getTime()){if(!this.groups[this.groupsIndex[e]]){this.createEntryGroupForDate(f,false)}this.groupsDayCodes.sort();this.focusOnDate(f,true)}else{this.displayedRange={start:new Date(f.getTime()-BX.Calendar.Util.getDayLength()*10),end:new Date(f.getTime()+BX.Calendar.Util.getDayLength()*60)};this.calendar.setDisplayedViewRange(this.displayedRange);this.animationMode=false;this.displayEntries({animation:false,focusDate:f});this.nothingToLoadNext=false;this.nothingToLoadPrevious=false}}}return h};a.prototype.increaseViewRangeDate=function(){var d=BX.util.array_search(this.focusedDayCode,this.groupsDayCodes);if(d>=0&&this.groupsDayCodes[d+1]){this.focusOnDate(this.groupsDayCodes[d+1],true)}};a.prototype.decreaseViewRangeDate=function(){var d=BX.util.array_search(this.focusedDayCode,this.groupsDayCodes);if(d>0&&this.groupsDayCodes[d-1]){this.focusOnDate(this.groupsDayCodes[d-1],true)}};a.prototype.createEntryGroupForDate=function(e,f){var d=this.calendar.util.getDayCode(e),h=Math.round(e.getTime()/1000)*1000,g={dayCode:d,wrap:BX.create("DIV",{props:{className:"calendar-timeline-stream-section-wrap"}})};g.titleNode=g.wrap.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-section calendar-timeline-section-date-label"},html:'<div data-bx-calendar-date="'+h+'" class="calendar-timeline-stream-section-content"><div class="'+(d==this.todayCode?"calendar-timeline-stream-today-label":"calendar-timeline-stream-label")+'">'+this.calendar.util.formatDateUsable(e)+"</div></div>"}));g.groupNode=g.wrap.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-section"}}));g.content=g.groupNode.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-stream-section-content"}}));g.emptyWarning=g.content.appendChild(BX.create("DIV",{props:{className:"calendar-timeline-empty-section"},text:BX.message("EC_NO_EVENTS")}));this.groups.push(g);this.groupsIndex[d]=this.groups.length-1;this.groupsDayCodes.push(d);this.appendDateGroup(this.groups[this.groups.length-1].wrap,e,f)};a.prototype.focusOnDate=function(f,d){var e=false;if(BX.type.isDate(f)){e=this.calendar.util.getDayCode(f)}else{if(BX.type.isString(f)){e=f}else{e=this.todayCode}}BX.cleanNode(this.centerLoaderWrap);this.focusedDayCode=e;if(this.groupsIndex&&this.groups[this.groupsIndex[e]]){this.bottomLoaderBlock.style.height=(this.SCROLL_DELTA_HEIGHT+Math.max(0,this.util.getViewHeight()+this.groups[this.groupsIndex[e]].wrap.offsetTop-this.bottomLoaderBlock.offsetTop))+"px";if(d&&this.streamScrollWrap){new BX.easing({duration:300,start:{scrollTop:this.streamScrollWrap.scrollTop},finish:{scrollTop:this.groups[this.groupsIndex[e]].wrap.offsetTop},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:BX.delegate(function(g){this.streamScrollWrap.scrollTop=g.scrollTop},this),complete:BX.delegate(function(){this.streamScrollWrap.scrollTop=this.groups[this.groupsIndex[e]].wrap.offsetTop},this)}).animate()}else{setTimeout(BX.delegate(function(){if(this.streamScrollWrap&&this.groupsIndex[e]!==undefined&&this.groups[this.groupsIndex[e]]){this.streamScrollWrap.scrollTop=this.groups[this.groupsIndex[e]].wrap.offsetTop}},this),200);setTimeout(BX.delegate(function(){if(this.streamScrollWrap&&this.groupsIndex[e]!==undefined&&this.groups[this.groupsIndex[e]]){this.streamScrollWrap.scrollTop=this.groups[this.groupsIndex[e]].wrap.offsetTop}},this),500);setTimeout(BX.delegate(function(){if(this.streamScrollWrap&&this.groupsIndex[e]!==undefined&&this.groups[this.groupsIndex[e]]){this.streamScrollWrap.scrollTop=this.groups[this.groupsIndex[e]].wrap.offsetTop}},this),1000)}}};a.prototype.scrollHandle=function(){if(!this.filterMode){if(this.streamScrollWrap.scrollHeight-this.util.getViewHeight()-this.streamScrollWrap.scrollTop<this.SCROLL_DELTA_HEIGHT&&!this.nothingToLoadNext){this.loadMoreEntries({mode:"next"})}else{if(this.streamScrollWrap.scrollTop<this.SCROLL_DELTA_HEIGHT&&!this.nothingToLoadPrevious){this.loadMoreEntries({mode:"previous"})}}}};a.prototype.loadMoreEntries=function(d){if(this.currentLoadMode||this.filterMode){return}this.currentLoadMode=d.mode;if(d.mode=="next"){this.loader=this.bottomLoaderBlock.appendChild(BX.adjust(this.calendar.util.getLoader(),{style:{height:"180px"}}));this.entryController.getList({loadNext:true,loadLimit:this.loadLimit,startDate:new Date(this.displayedRange.end.getFullYear(),this.displayedRange.end.getMonth(),this.displayedRange.end.getDate()+1),finishCallback:BX.proxy(this.loadMoreCallback,this)})}else{this.loader=this.topLoaderBlock.appendChild(BX.adjust(this.calendar.util.getLoader(),{style:{height:"180px"}}));this.entryController.getList({loadPrevious:true,loadLimit:this.loadLimitPrevious,finishDate:new Date(this.displayedRange.start.getFullYear(),this.displayedRange.start.getMonth(),this.displayedRange.start.getDate()-1),finishCallback:BX.proxy(this.loadMoreCallback,this)})}};a.prototype.loadMoreCallback=function(e){BX.remove(this.loader);this.displayedRange=this.calendar.entryController.getLoadedEntiesLimits();var d=this.entryController.getList({startDate:this.displayedRange.start,finishDate:this.displayedRange.end,finishCallback:BX.proxy(this.loadMoreCallback,this)});if(this.currentLoadMode=="next"&&e.finish){this.nothingToLoadNext=true}if(this.currentLoadMode=="previous"&&e.finish){this.nothingToLoadPrevious=true}if(!this.entries){this.entries=[]}if(d&&d.length){this.entries=this.entries.concat(d);this.attachEntries(d,this.currentLoadMode=="next"?"next":false)}this.currentLoadMode=false};a.prototype.getUniqueId=function(d){return d.entry.uid+"|"+d.dayCode};a.prototype.handleClick=function(f){if(this.isActive()){if(!f){f={}}var d,e;if(f.specialTarget&&(e=f.specialTarget.getAttribute("data-bx-calendar-entry"))){this.handleEntryClick({uid:e,specialTarget:f.specialTarget,target:f.target,e:f.e})}else{if(f.specialTarget&&(d=f.specialTarget.getAttribute("data-bx-calendar-show-all-events"))){}else{if(!this.calendar.util.readOnlyMode()&&this.entryController.canDo(true,"add_event")&&(d=f.specialTarget&&f.specialTarget.getAttribute("data-bx-calendar-week-day"))){this.deselectEntry();this.showCompactEditFormForNewEntry({entry:this.buildTopNewEntryWrap({dayFrom:this.days[this.dayIndex[d]],holder:this.topEntryHolder})})}}}}};a.prototype.showEmptyBlock=function(e){if(BX.Type.isDomNode(this.noEntriesWrap)){BX.Dom.remove(this.noEntriesWrap)}this.noEntriesWrap=this.streamScrollWrap.appendChild(BX.create("DIV",{props:{className:"calendar-search-main"},style:{height:this.util.getViewHeight()+"px"}}));var d=this.noEntriesWrap.appendChild(BX.create("DIV",{props:{className:"calendar-search-empty"},html:'<div class="calendar-search-empty-name">'+BX.message("EC_NO_EVENTS")+"</div>"}));if(!this.calendar.util.readOnlyMode()){this.addButton=d.appendChild(BX.create("SPAN",{props:{className:"calendar-search-empty-link"},text:BX.message("EC_CREATE_EVENT"),events:{click:function(){BX.Calendar.EntryManager.openEditSlider({type:this.calendar.util.type,ownerId:this.calendar.util.ownerId,userId:parseInt(this.calendar.currentUser.id)})}.bind(this)}}))}this.streamContentWrap.style.display="none"};a.prototype.applyFilterMode=function(){this.filterMode=true;this.calendar.viewTitleContainer.style.display="none";this.calendar.navigationWrap.style.display="none";if(this.searchHead){BX.remove(this.searchHead)}this.searchHead=this.calendar.topBlock.appendChild(BX.create("DIV",{props:{className:"calendar-search-head"},html:'<div class="calendar-search-name">'+BX.message("EC_SEARCH_RESULT")+"</div>"}));if(this.resettFilterWrap){BX.remove(this.resettFilterWrap)}this.resettFilterWrap=this.searchHead.appendChild(BX.create("DIV",{props:{className:"calendar-search-cancel"},html:BX.message("EC_SEARCH_RESET_RESULT"),events:{click:BX.proxy(this.resetFilterMode,this)}}));if(this.streamScrollWrap){this.streamContentWrap.style.display="none";this.filterLoaderWrap.style.display=""}};a.prototype.resetFilterMode=function(d){this.filterMode=false;this.resultEntries=[];this.calendar.viewTitleContainer.style.display="";this.calendar.navigationWrap.style.display="";this.setTitle();if(this.searchHead){BX.remove(this.searchHead)}if(this.resettFilterWrap){BX.remove(this.resettFilterWrap)}this.streamContentWrap.style.display="";if(this.filterLoaderWrap){this.filterLoaderWrap.style.display="none"}if(!d||d.resetSearchFilter!==false){this.calendar.search.resetFilter()}if(this.isActive()){this.displayEntries()}};a.prototype.handleEntryClick=function(d){if(this.filterMode&&this.resultEntriesIndex[d.uid]!==undefined){d.entry=this.resultEntries[this.resultEntriesIndex[d.uid]]}c.prototype.handleEntryClick.apply(this,arguments)};if(b.BXEventCalendar){b.BXEventCalendar.CalendarListView=a}else{BX.addCustomEvent(b,"onBXEventCalendarInit",function(){b.BXEventCalendar.CalendarListView=a})}})(window);