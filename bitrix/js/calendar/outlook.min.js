var jsOutlookUtils={encode:function(h){var c,a=h.length,g,e,b="",d=false,f="&\\[]|";for(c=0;c<a;c++){g=h.charAt(c);e=g.charCodeAt(0);if(d&&e<=127){b+="]";d=false}if(!d&&e>127){b+="[";d=true}if(f.indexOf(g)>=0){b+="|"}if((e>=97&&e<=122)||(e>=65&&e<=90)||(e>=48&&e<=57)){b+=g}else{if(e<=15){b+="%0"+e.toString(16).toUpperCase()}else{if(e<=127){b+="%"+e.toString(16).toUpperCase()}else{if(e<=255){b+="00"+e.toString(16).toUpperCase()}else{if(e<=4095){b+="0"+e.toString(16).toUpperCase()}else{b+=e.toString(16).toUpperCase()}}}}}}if(d){b+="]"}return b},Sync:function(g,l,a,n,i,h,c){var k=500,b=20,m=window.location.host;if(!!c){m=m.replace(/:\d+/,"")+":"+c}l=window.location.protocol+"//"+m+l;h=h.replace(/{/g,"%7B").replace(/}/g,"%7D").replace(/-/g,"%2D");var j="stssync://sts/?ver=1.1&type="+g+"&cmd=add-folder&base-url="+jsOutlookUtils.encode(l)+"&list-url="+jsOutlookUtils.encode(a)+"&guid="+h;var f="&site-name="+jsOutlookUtils.encode(n)+"&list-name="+jsOutlookUtils.encode(i);if(j.length+f.length>k&&(n.length>b||i.length>b)){if(n.length>b){n=n.substring(0,b-1)+"..."}if(i.length>b){i=i.substring(0,b-1)+"..."}f="&site-name="+jsOutlookUtils.encode(n)+"&list-name="+jsOutlookUtils.encode(i)}j+=f;try{window.location.href=j}catch(d){}}};